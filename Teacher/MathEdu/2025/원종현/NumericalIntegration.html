<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³ ê¸‰ ìˆ˜ì¹˜ì ë¶„ ì‹¬í™” íƒêµ¬ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.4);
            background: linear-gradient(to right, #fff, #a8edea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.95;
            font-weight: 300;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            min-width: 200px;
            padding: 15px 25px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.6em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .card h3 {
            color: #764ba2;
            margin-top: 20px;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #555;
        }

        select, input[type="range"], input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        input[type="range"] {
            flex: 1;
            height: 8px;
            background: linear-gradient(to right, #667eea, #764ba2);
        }

        .slider-value {
            min-width: 60px;
            background: #667eea;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            text-align: center;
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            margin-top: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .result-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .result-box .label {
            font-size: 0.95em;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .result-box .value {
            font-size: 1.6em;
            font-weight: 700;
            font-family: 'Courier New', monospace;
        }

        .result-box.method-trap { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .result-box.method-simp { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .result-box.method-adapt { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .result-box.method-gauss { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }

        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }

        .formula-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .comparison-table .best {
            background: #d4edda;
            font-weight: 700;
            color: #155724;
        }

        .node-visualization {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .node-container {
            position: relative;
            height: 80px;
            background: white;
            border-radius: 8px;
            margin: 15px 0;
            padding: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .node-line {
            position: absolute;
            top: 50%;
            left: 5%;
            right: 5%;
            height: 2px;
            background: #ccc;
        }

        .node-point {
            position: absolute;
            top: 50%;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .node-point:hover {
            transform: translate(-50%, -50%) scale(1.5);
        }

        .node-label {
            position: absolute;
            top: 70%;
            font-size: 0.8em;
            color: #666;
            transform: translateX(-50%);
        }

        /* ì ì‘ì  íŠ¸ë¦¬ ìŠ¤íƒ€ì¼ ê°œì„  */
        .adaptive-tree {
            font-family: 'Courier New', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            max-height: 500px;
            overflow-y: auto;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .tree-line {
            padding: 3px 0;
            border-left: 2px solid transparent;
            padding-left: 10px;
            margin: 2px 0;
            transition: all 0.3s;
            opacity: 0;
            animation: fadeIn 0.5s forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        .tree-line.accept {
            color: #4ec9b0;
            border-left-color: #4ec9b0;
            background: rgba(78, 201, 176, 0.1);
        }

        .tree-line.subdivide {
            color: #ce9178;
            border-left-color: #ce9178;
            background: rgba(206, 145, 120, 0.1);
        }

        .tree-line.root {
            color: #569cd6;
            font-weight: bold;
            border-left-color: #569cd6;
            background: rgba(86, 156, 214, 0.1);
        }

        .tree-icon {
            display: inline-block;
            width: 20px;
            text-align: center;
            margin-right: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #11998e, #38ef7d);
            width: 0%;
            transition: width 0.3s;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“ ê³ ê¸‰ ìˆ˜ì¹˜ì ë¶„ ì‹¬í™” íƒêµ¬ ì‹œë®¬ë ˆì´í„°</h1>
            <p class="subtitle">ì ì‘ì  êµ¬ì ë²• & ê°€ìš°ìŠ¤ êµ¬ì ë²• ì™„ì „ ë¶„ì„</p>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="showTab('basic')">ğŸ“Š ê¸°ë³¸ ë¹„êµ</button>
            <button class="tab" onclick="showTab('adaptive')">ğŸ”„ ì ì‘ì  êµ¬ì ë²•</button>
            <button class="tab" onclick="showTab('gaussian')">â­ ê°€ìš°ìŠ¤ êµ¬ì ë²•</button>
            <button class="tab" onclick="showTab('comparison')">ğŸ“ˆ ì¢…í•© ë¹„êµ</button>
        </div>

        <!-- ê¸°ë³¸ ë¹„êµ íƒ­ -->
        <div id="basic" class="tab-content active">
            <div class="grid">
                <div class="card">
                    <h2>âš™ï¸ ì œì–´ íŒ¨ë„</h2>
                    <div class="control-group">
                        <label for="funcSelect">ì ë¶„í•  í•¨ìˆ˜</label>
                        <select id="funcSelect" onchange="updateAll()">
                            <option value="sin">f(x) = sin(x) [0, Ï€]</option>
                            <option value="poly">f(x) = xÂ³ - 2xÂ² + 1 [0, 3]</option>
                            <option value="exp">f(x) = e^(-xÂ²) [0, 2]</option>
                            <option value="peak">f(x) = e^(-100(x-0.5)Â²) [0, 1] (ê¸‰ê²©í•œ í”¼í¬)</option>
                            <option value="oscillate">f(x) = sin(10x) [0, 2Ï€]</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label>êµ¬ê°„ ê°œìˆ˜ (n)</label>
                        <div class="slider-container">
                            <input type="range" id="nSlider" min="4" max="64" value="16" step="2" oninput="updateAll()">
                            <span class="slider-value" id="nValue">16</span>
                        </div>
                    </div>

                    <div class="results-grid">
                        <div class="result-box">
                            <div class="label">ì°¸ê°’</div>
                            <div class="value" id="exact">0.000000</div>
                        </div>
                        <div class="result-box method-trap">
                            <div class="label">ì‚¬ë‹¤ë¦¬ê¼´ ì˜¤ì°¨</div>
                            <div class="value" id="trapErr">0.0e+0</div>
                        </div>
                        <div class="result-box method-simp">
                            <div class="label">ì‹¬í”„ìŠ¨ ì˜¤ì°¨</div>
                            <div class="value" id="simpErr">0.0e+0</div>
                        </div>
                    </div>

                    <div class="formula-box">
                        <strong>ì´ë¡ ì  ì˜¤ì°¨:</strong><br>
                        ì‚¬ë‹¤ë¦¬ê¼´: E_T = O(hÂ²) = O(nâ»Â²)<br>
                        ì‹¬í”„ìŠ¨: E_S = O(hâ´) = O(nâ»â´)
                    </div>
                </div>

                <div class="card">
                    <h2>ğŸ“‰ í•¨ìˆ˜ ì‹œê°í™”</h2>
                    <div class="chart-container">
                        <canvas id="funcChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>ğŸ“Š ìˆ˜ë ´ ì†ë„ ë¶„ì„ (Log-Log Plot)</h2>
                <div class="chart-container">
                    <canvas id="convergenceChart"></canvas>
                </div>
            </div>
        </div>

        <!-- ì ì‘ì  êµ¬ì ë²• íƒ­ -->
        <div id="adaptive" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h2>ğŸ”„ ì ì‘ì  ì‹¬í”„ìŠ¨ ì œì–´</h2>
                    <div class="control-group">
                        <label for="adaptFunc">í•¨ìˆ˜ ì„ íƒ</label>
                        <select id="adaptFunc">
                            <option value="peak">ê¸‰ê²©í•œ í”¼í¬: e^(-100(x-0.5)Â²)</option>
                            <option value="oscillate">ì§„ë™: sin(10x)</option>
                            <option value="step">ê³„ë‹¨: 1/(1+e^(-50(x-0.5)))</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label for="tolSlider">í—ˆìš© ì˜¤ì°¨ (Tolerance)</label>
                        <div class="slider-container">
                            <input type="range" id="tolSlider" min="-8" max="-2" value="-4" step="1">
                            <span class="slider-value" id="tolValue">1e-4</span>
                        </div>
                    </div>

                    <button class="btn btn-success" id="adaptBtn" onclick="runAdaptive()">
                        ğŸš€ ì‹¤í–‰ ë° ë¶„ì„
                    </button>

                    <div class="progress-bar" id="progressBar" style="display: none;">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>

                    <div class="results-grid">
                        <div class="result-box method-adapt">
                            <div class="label">í•¨ìˆ˜ í‰ê°€ íšŸìˆ˜</div>
                            <div class="value" id="adaptEvals">0</div>
                        </div>
                        <div class="result-box method-simp">
                            <div class="label">ê· ë“± ì‹¬í”„ìŠ¨ (ë¹„êµ)</div>
                            <div class="value" id="uniformEvals">0</div>
                        </div>
                        <div class="result-box">
                            <div class="label">íš¨ìœ¨ì„± ê°œì„ </div>
                            <div class="value" id="efficiency">0%</div>
                        </div>
                    </div>

                    <h3>ğŸ“‹ ì•Œê³ ë¦¬ì¦˜ ì›ë¦¬</h3>
                    <div class="formula-box">
                        <strong>Richardson ì™¸ì‚½:</strong><br>
                        Îµ = |S_left + S_right - S_whole| / 15<br><br>
                        if Îµ < tolerance: accept<br>
                        else: subdivide recursively
                    </div>
                </div>

                <div class="card">
                    <h2>ğŸŒ³ ì ì‘ì  ë¶„í•  íŠ¸ë¦¬ (ì‹¤ì‹œê°„ ì• ë‹ˆë©”ì´ì…˜)</h2>
                    <div style="background: #f0f0f0; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
                        <strong>ë²”ë¡€:</strong>
                        <span style="color: #4ec9b0; margin-left: 15px;">â— ìˆ˜ë½ (Accept)</span>
                        <span style="color: #ce9178; margin-left: 15px;">â— ì„¸ë¶„í™” (Subdivide)</span>
                    </div>
                    <div class="adaptive-tree" id="adaptiveTree">
                        <div style="text-align: center; color: #888; padding: 50px;">
                            â¬†ï¸ ì•Œê³ ë¦¬ì¦˜ì„ ì‹¤í–‰í•˜ë©´ ì¬ê·€ íŠ¸ë¦¬ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>ğŸ“ ì ì‘ì  ë…¸ë“œ ë¶„í¬</h2>
                <div class="node-visualization">
                    <h4>ê· ë“± ë¶„í•  (n=8)</h4>
                    <div class="node-container" id="uniformNodes"></div>
                    
                    <h4 style="margin-top: 20px;">ì ì‘ì  ë¶„í•  (ë™ì )</h4>
                    <div class="node-container" id="adaptiveNodes"></div>
                    
                    <p style="margin-top: 15px; color: #666;">
                        ğŸ’¡ ê¸‰ê²©í•œ ë³€í™”ê°€ ìˆëŠ” êµ¬ê°„ì— ë…¸ë“œê°€ ë°€ì§‘ë©ë‹ˆë‹¤
                    </p>
                </div>
            </div>
        </div>

        <!-- ê°€ìš°ìŠ¤ êµ¬ì ë²• íƒ­ -->
        <div id="gaussian" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h2>â­ ê°€ìš°ìŠ¤-ë¥´ì¥ë“œë¥´ êµ¬ì ë²•</h2>
                    <div class="control-group">
                        <label for="gaussFunc">í•¨ìˆ˜ ì„ íƒ</label>
                        <select id="gaussFunc" onchange="runGaussian()">
                            <option value="poly3">f(x) = xÂ³ (3ì°¨ ë‹¤í•­ì‹)</option>
                            <option value="poly5">f(x) = xâµ - 2xÂ³ (5ì°¨)</option>
                            <option value="poly7">f(x) = xâ· - 3xâµ + x (7ì°¨)</option>
                            <option value="exp">f(x) = e^x</option>
                            <option value="sin">f(x) = sin(Ï€x)</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label for="gaussOrder">ê°€ìš°ìŠ¤ ì°¨ìˆ˜ (nì  ê³µì‹)</label>
                        <select id="gaussOrder" onchange="runGaussian()">
                            <option value="2">n=2 (3ì°¨ê¹Œì§€ ì •í™•)</option>
                            <option value="3">n=3 (5ì°¨ê¹Œì§€ ì •í™•)</option>
                            <option value="4">n=4 (7ì°¨ê¹Œì§€ ì •í™•)</option>
                            <option value="5">n=5 (9ì°¨ê¹Œì§€ ì •í™•)</option>
                        </select>
                    </div>

                    <button class="btn btn-warning" onclick="runGaussian()">
                        ê°€ìš°ìŠ¤ êµ¬ì  ì‹¤í–‰
                    </button>

                    <h3>ğŸ“Š ë…¸ë“œì™€ ê°€ì¤‘ì¹˜</h3>
                    <table class="comparison-table" id="gaussTable">
                        <thead>
                            <tr>
                                <th>i</th>
                                <th>ë…¸ë“œ x<sub>i</sub></th>
                                <th>ê°€ì¤‘ì¹˜ w<sub>i</sub></th>
                            </tr>
                        </thead>
                        <tbody id="gaussTableBody"></tbody>
                    </table>

                    <div class="formula-box" style="margin-top: 15px;">
                        <strong>ê°€ìš°ìŠ¤ ê³µì‹:</strong><br>
                        âˆ«â‚‹â‚Â¹ f(x)dx â‰ˆ Î£ wáµ¢ f(xáµ¢)<br><br>
                        ë…¸ë“œëŠ” ë¥´ì¥ë“œë¥´ ë‹¤í•­ì‹ Pâ‚™(x)ì˜ ê·¼
                    </div>
                </div>

                <div class="card">
                    <h2>ğŸ¯ ë…¸ë“œ ìœ„ì¹˜ ë¹„êµ</h2>
                    <div class="node-visualization">
                        <h4>ê· ë“± ë¶„í•  (Simpson, n=4)</h4>
                        <div class="node-container" id="simpsonNodes"></div>
                        
                        <h4 style="margin-top: 20px;">ê°€ìš°ìŠ¤ ë…¸ë“œ (n=4)</h4>
                        <div class="node-container" id="gaussNodes"></div>
                        
                        <p style="margin-top: 15px; color: #666;">
                            ğŸ’¡ ê°€ìš°ìŠ¤ ë…¸ë“œëŠ” ì–‘ ëì— ë” ì§‘ì¤‘ë˜ì–´ ìˆìŠµë‹ˆë‹¤ (ë¹„ë“±ê°„ê²©)
                        </p>
                    </div>

                    <div class="results-grid" style="margin-top: 20px;">
                        <div class="result-box">
                            <div class="label">ì°¸ê°’</div>
                            <div class="value" id="gaussExact">0.000000</div>
                        </div>
                        <div class="result-box method-gauss">
                            <div class="label">ê°€ìš°ìŠ¤ ê²°ê³¼</div>
                            <div class="value" id="gaussResult">0.000000</div>
                        </div>
                        <div class="result-box method-gauss">
                            <div class="label">ì ˆëŒ€ ì˜¤ì°¨</div>
                            <div class="value" id="gaussError">0.0e+0</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>ğŸ“ˆ ì •í™•ë„ ë¹„êµ ì°¨íŠ¸ (ëª¨ë“  ë°©ë²• vs ê°€ìš°ìŠ¤)</h2>
                <div style="background: #fffbea; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #fbbf24;">
                    <strong>ğŸ’¡ í•´ì„ ê°€ì´ë“œ:</strong> ë§‰ëŒ€ê°€ ë‚®ì„ìˆ˜ë¡ ì •í™•ë„ê°€ ë†’ìŠµë‹ˆë‹¤. ê°€ìš°ìŠ¤ êµ¬ì ë²•ì´ ê°™ì€ í‰ê°€ íšŸìˆ˜ì—ì„œ ì–¼ë§ˆë‚˜ ìš°ìˆ˜í•œì§€ í™•ì¸í•˜ì„¸ìš”!
                </div>
                <div class="chart-container" style="height: 500px;">
                    <canvas id="gaussCompChart"></canvas>
                </div>
            </div>
        </div>

        <!-- ì¢…í•© ë¹„êµ íƒ­ -->
        <div id="comparison" class="tab-content">
            <div class="card">
                <h2>ğŸ† ëª¨ë“  ë°©ë²• ì¢…í•© ë¹„êµ</h2>
                <div style="background: #e7f3ff; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #3b82f6;">
                    <strong>ğŸ“Œ ë²¤ì¹˜ë§ˆí¬ ì¡°ê±´:</strong> f(x) = sin(x) [0, Ï€], ëª©í‘œ ì˜¤ì°¨: 1e-6
                </div>
                <button class="btn btn-primary" onclick="runComprehensiveTest()">
                    ğŸš€ ì¢…í•© ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰
                </button>

                <table class="comparison-table" id="compTable">
                    <thead>
                        <tr>
                            <th>ë°©ë²•</th>
                            <th>í•¨ìˆ˜ í‰ê°€</th>
                            <th>ê²°ê³¼ê°’</th>
                            <th>ì ˆëŒ€ ì˜¤ì°¨</th>
                            <th>ìƒëŒ€ ì˜¤ì°¨</th>
                            <th>íš¨ìœ¨ì„± ë“±ê¸‰</th>
                        </tr>
                    </thead>
                    <tbody id="compTableBody">
                        <tr>
                            <td colspan="6" style="padding: 40px; text-align: center; color: #888;">
                                â¬†ï¸ "ì¢…í•© ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="grid">
                <div class="card">
                    <h2>ğŸ“Š ì˜¤ì°¨ vs ê³„ì‚° ë¹„ìš© ë¶„ì„</h2>
                    <div style="background: #fef3c7; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #f59e0b;">
                        <strong>ğŸ’¡ í•´ì„ ê°€ì´ë“œ:</strong> ì™¼ìª½ ì•„ë˜ì— ê°€ê¹Œìš¸ìˆ˜ë¡ íš¨ìœ¨ì  (ì ì€ í‰ê°€ë¡œ ë‚®ì€ ì˜¤ì°¨)
                    </div>
                    <div class="chart-container" style="height: 500px;">
                        <canvas id="efficiencyChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h2>ğŸ“ ë°©ë²• ì„ íƒ ê°€ì´ë“œ</h2>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>ìƒí™©</th>
                                <th>ì¶”ì²œ ë°©ë²•</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>í•¨ìˆ˜ê°€ Câ´ ë¯¸ë§Œ</td>
                                <td class="best">ì‚¬ë‹¤ë¦¬ê¼´</td>
                            </tr>
                            <tr>
                                <td>ê· ë“± ë¶„í•  ì„ í˜¸</td>
                                <td class="best">ì‹¬í”„ìŠ¨</td>
                            </tr>
                            <tr>
                                <td>ë¶ˆê· ë“± ë³€í™”</td>
                                <td class="best">ì ì‘ì  ì‹¬í”„ìŠ¨</td>
                            </tr>
                            <tr>
                                <td>ë§¤ìš° ë§¤ë„ëŸ¬ìš´ í•¨ìˆ˜</td>
                                <td class="best">ê°€ìš°ìŠ¤ êµ¬ì </td>
                            </tr>
                            <tr>
                                <td>ìµœì†Œ í‰ê°€ë¡œ ê³ ì •ë°€</td>
                                <td class="best">ê°€ìš°ìŠ¤ êµ¬ì </td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="formula-box" style="margin-top: 20px;">
                        <strong>ê³„ì‚° ë³µì¡ë„:</strong><br>
                        ì‚¬ë‹¤ë¦¬ê¼´: N ~ O(Îµâ»Â¹/Â²)<br>
                        ì‹¬í”„ìŠ¨: N ~ O(Îµâ»Â¹/â´)<br>
                        ê°€ìš°ìŠ¤: ì§€ìˆ˜ì  ê°ì†Œ (ë§¤ë„ëŸ¬ìš´ í•¨ìˆ˜)
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== í•¨ìˆ˜ ì •ì˜ =====
        const functions = {
            sin: { f: x => Math.sin(x), a: 0, b: Math.PI, exact: 2.0, label: 'sin(x)' },
            poly: { f: x => x**3 - 2*x**2 + 1, a: 0, b: 3, exact: 7.75, label: 'xÂ³-2xÂ²+1' },
            exp: { f: x => Math.exp(-x*x), a: 0, b: 2, exact: 0.88208, label: 'e^(-xÂ²)' },
            peak: { f: x => Math.exp(-100*(x-0.5)**2), a: 0, b: 1, exact: 0.177245, label: 'e^(-100(x-0.5)Â²)' },
            oscillate: { f: x => Math.sin(10*x), a: 0, b: 2*Math.PI, exact: 0, label: 'sin(10x)' }
        };

        const adaptiveFunctions = {
            peak: { f: x => Math.exp(-100*(x-0.5)**2), a: 0, b: 1, exact: 0.177245 },
            oscillate: { f: x => Math.sin(10*x), a: 0, b: 2*Math.PI, exact: 0 },
            step: { f: x => 1/(1+Math.exp(-50*(x-0.5))), a: 0, b: 1, exact: 0.5 }
        };

        const gaussianFunctions = {
            poly3: { f: x => x**3, a: -1, b: 1, exact: 0, label: 'xÂ³' },
            poly5: { f: x => x**5 - 2*x**3, a: -1, b: 1, exact: -4/3, label: 'xâµ-2xÂ³' },
            poly7: { f: x => x**7 - 3*x**5 + x, a: -1, b: 1, exact: 0, label: 'xâ·-3xâµ+x' },
            exp: { f: x => Math.exp(x), a: -1, b: 1, exact: Math.E - 1/Math.E, label: 'e^x' },
            sin: { f: x => Math.sin(Math.PI*x), a: -1, b: 1, exact: 0, label: 'sin(Ï€x)' }
        };

        // ê°€ìš°ìŠ¤-ë¥´ì¥ë“œë¥´ ë…¸ë“œì™€ ê°€ì¤‘ì¹˜
        const gaussQuadrature = {
            2: {
                nodes: [-0.5773502691896257, 0.5773502691896257],
                weights: [1.0, 1.0]
            },
            3: {
                nodes: [-0.7745966692414834, 0.0, 0.7745966692414834],
                weights: [0.5555555555555556, 0.8888888888888888, 0.5555555555555556]
            },
            4: {
                nodes: [-0.8611363115940526, -0.3399810435848563, 0.3399810435848563, 0.8611363115940526],
                weights: [0.3478548451374538, 0.6521451548625461, 0.6521451548625461, 0.3478548451374538]
            },
            5: {
                nodes: [-0.9061798459386640, -0.5384693101056831, 0.0, 0.5384693101056831, 0.9061798459386640],
                weights: [0.2369268850561891, 0.4786286704993665, 0.5688888888888889, 0.4786286704993665, 0.2369268850561891]
            }
        };

        let charts = {};

        // ===== ê¸°ë³¸ ì ë¶„ ì•Œê³ ë¦¬ì¦˜ =====
        function trapezoidalRule(f, a, b, n) {
            const h = (b - a) / n;
            let sum = 0.5 * (f(a) + f(b));
            for (let i = 1; i < n; i++) {
                sum += f(a + i * h);
            }
            return { result: sum * h, evals: n + 1 };
        }

        function simpsonRule(f, a, b, n) {
            if (n % 2 === 1) n += 1;
            const h = (b - a) / n;
            let sum = f(a) + f(b);
            for (let i = 1; i < n; i += 2) {
                sum += 4 * f(a + i * h);
            }
            for (let i = 2; i < n - 1; i += 2) {
                sum += 2 * f(a + i * h);
            }
            return { result: sum * h / 3, evals: n + 1 };
        }

        // ===== ì ì‘ì  ì‹¬í”„ìŠ¨ (ì‹¤ì‹œê°„ ì• ë‹ˆë©”ì´ì…˜) =====
        let adaptiveEvalCount = 0;
        let adaptiveTree = [];
        let treeAnimationDelay = 0;

        function adaptiveSimpsonRecursive(f, a, b, tol, S_ab, fa, fb, fc, depth = 0) {
            const c = (a + b) / 2;
            const h = b - a;
            
            const d = (a + c) / 2;
            const e = (c + b) / 2;
            const fd = f(d);
            const fe = f(e);
            adaptiveEvalCount += 2;

            const S_ac = (h/12) * (fa + 4*fd + fc);
            const S_cb = (h/12) * (fc + 4*fe + fb);
            const S_total = S_ac + S_cb;

            const error = Math.abs(S_total - S_ab) / 15;

            const indent = '  '.repeat(depth);
            const interval = `[${a.toFixed(4)}, ${b.toFixed(4)}]`;
            const errorStr = error.toExponential(2);
            
            if (error < tol) {
                adaptiveTree.push({
                    depth: depth,
                    type: 'accept',
                    text: `${indent}âœ“ ${interval} Îµ=${errorStr} ACCEPT`,
                    delay: treeAnimationDelay++
                });
                return S_total + (S_total - S_ab) / 15;
            } else {
                adaptiveTree.push({
                    depth: depth,
                    type: 'subdivide',
                    text: `${indent}âœ— ${interval} Îµ=${errorStr} SUBDIVIDE`,
                    delay: treeAnimationDelay++
                });
                const left = adaptiveSimpsonRecursive(f, a, c, tol/2, S_ac, fa, fd, fc, depth+1);
                const right = adaptiveSimpsonRecursive(f, c, b, tol/2, S_cb, fc, fe, fb, depth+1);
                return left + right;
            }
        }

        function adaptiveSimpson(f, a, b, tol) {
            adaptiveEvalCount = 3;
            adaptiveTree = [];
            treeAnimationDelay = 0;
            
            const c = (a + b) / 2;
            const h = b - a;
            const fa = f(a), fb = f(b), fc = f(c);
            const S_ab = (h/6) * (fa + 4*fc + fb);
            
            adaptiveTree.push({
                depth: 0,
                type: 'root',
                text: `ROOT: [${a.toFixed(4)}, ${b.toFixed(4)}] START`,
                delay: treeAnimationDelay++
            });
            
            const result = adaptiveSimpsonRecursive(f, a, b, tol, S_ab, fa, fb, fc);
            
            return {
                result: result,
                evals: adaptiveEvalCount,
                tree: adaptiveTree
            };
        }

        // íŠ¸ë¦¬ ì• ë‹ˆë©”ì´ì…˜ ë Œë”ë§
        function renderTreeAnimated(tree) {
            const container = document.getElementById('adaptiveTree');
            container.innerHTML = '';
            
            tree.forEach((node, index) => {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = `tree-line ${node.type}`;
                    div.style.animationDelay = '0s';
                    
                    const icon = node.type === 'accept' ? 'âœ“' : 
                                 node.type === 'subdivide' ? 'âœ—' : 'ğŸŒŸ';
                    
                    div.innerHTML = `<span class="tree-icon">${icon}</span>${node.text}`;
                    container.appendChild(div);
                    
                    // ìë™ ìŠ¤í¬ë¡¤
                    container.scrollTop = container.scrollHeight;
                    
                    // ì§„í–‰ ë°” ì—…ë°ì´íŠ¸
                    const progress = ((index + 1) / tree.length) * 100;
                    document.getElementById('progressFill').style.width = progress + '%';
                    
                }, index * 100); // ê° ë…¸ë“œë§ˆë‹¤ 100ms ê°„ê²©
            });
        }

        // ===== ê°€ìš°ìŠ¤ êµ¬ì ë²• =====
        function gaussLegendre(f, a, b, n) {
            const nodes = gaussQuadrature[n].nodes;
            const weights = gaussQuadrature[n].weights;
            
            let sum = 0;
            const scale = (b - a) / 2;
            const shift = (a + b) / 2;
            
            for (let i = 0; i < n; i++) {
                const x = scale * nodes[i] + shift;
                sum += weights[i] * f(x);
            }
            
            return { result: scale * sum, evals: n };
        }

        // ===== UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ =====
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'adaptive') {
                setTimeout(runAdaptive, 100);
            }
            if (tabName === 'gaussian') {
                setTimeout(runGaussian, 100);
            }
            if (tabName === 'comparison') {
                // ì¢…í•© ë¹„êµëŠ” ë²„íŠ¼ í´ë¦­ ì‹œì—ë§Œ ì‹¤í–‰
            }
        }

        function updateAll() {
            const funcKey = document.getElementById('funcSelect').value;
            const n = parseInt(document.getElementById('nSlider').value);
            document.getElementById('nValue').textContent = n;

            const func = functions[funcKey];
            const trap = trapezoidalRule(func.f, func.a, func.b, n);
            const simp = simpsonRule(func.f, func.a, func.b, n);

            const trapErr = Math.abs(func.exact - trap.result);
            const simpErr = Math.abs(func.exact - simp.result);

            document.getElementById('exact').textContent = func.exact.toFixed(6);
            document.getElementById('trapErr').textContent = trapErr.toExponential(2);
            document.getElementById('simpErr').textContent = simpErr.toExponential(2);

            updateFunctionChart(func, n);
            updateConvergenceChart(func);
        }

        function updateFunctionChart(func, n) {
            const ctx = document.getElementById('funcChart').getContext('2d');
            
            const points = 200;
            const curveData = [];
            for (let i = 0; i <= points; i++) {
                const x = func.a + (func.b - func.a) * i / points;
                curveData.push({x: x, y: func.f(x)});
            }

            const h = (func.b - func.a) / n;
            const trapData = [];
            for (let i = 0; i <= n; i++) {
                const x = func.a + i * h;
                trapData.push({x: x, y: func.f(x)});
            }

            if (charts.funcChart) charts.funcChart.destroy();

            charts.funcChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'ì‹¤ì œ í•¨ìˆ˜',
                        data: curveData,
                        borderColor: 'rgb(102, 126, 234)',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        borderWidth: 3
                    }, {
                        label: 'ì‚¬ë‹¤ë¦¬ê¼´ ê·¼ì‚¬',
                        data: trapData,
                        borderColor: 'rgb(245, 87, 108)',
                        backgroundColor: 'rgba(245, 87, 108, 0.2)',
                        fill: false,
                        tension: 0,
                        pointRadius: 5,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { type: 'linear', title: { display: true, text: 'x' } },
                        y: { title: { display: true, text: 'f(x)' } }
                    },
                    plugins: { legend: { position: 'top' } }
                }
            });
        }

        function updateConvergenceChart(func) {
            const ctx = document.getElementById('convergenceChart').getContext('2d');
            const nValues = [4, 8, 16, 32, 64, 128];
            
            const trapErrors = [];
            const simpErrors = [];

            nValues.forEach(n => {
                const trap = trapezoidalRule(func.f, func.a, func.b, n);
                const simp = simpsonRule(func.f, func.a, func.b, n);
                trapErrors.push({x: n, y: Math.abs(func.exact - trap.result)});
                simpErrors.push({x: n, y: Math.abs(func.exact - simp.result)});
            });

            if (charts.convergenceChart) charts.convergenceChart.destroy();

            charts.convergenceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'ì‚¬ë‹¤ë¦¬ê¼´ (ê¸°ìš¸ê¸° â‰ˆ -2)',
                        data: trapErrors,
                        borderColor: 'rgb(245, 87, 108)',
                        borderWidth: 3,
                        pointRadius: 6
                    }, {
                        label: 'ì‹¬í”„ìŠ¨ (ê¸°ìš¸ê¸° â‰ˆ -4)',
                        data: simpErrors,
                        borderColor: 'rgb(79, 172, 254)',
                        borderWidth: 3,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { 
                            type: 'logarithmic', 
                            title: { display: true, text: 'êµ¬ê°„ ê°œìˆ˜ (n)', font: { weight: 'bold' } }
                        },
                        y: { 
                            type: 'logarithmic', 
                            title: { display: true, text: 'ì ˆëŒ€ ì˜¤ì°¨', font: { weight: 'bold' } }
                        }
                    },
                    plugins: { legend: { position: 'top' } }
                }
            });
        }

        async function runAdaptive() {
            const btn = document.getElementById('adaptBtn');
            btn.disabled = true;
            btn.textContent = 'â³ ì‹¤í–‰ ì¤‘...';
            
            const progressBar = document.getElementById('progressBar');
            progressBar.style.display = 'block';
            document.getElementById('progressFill').style.width = '0%';

            const funcKey = document.getElementById('adaptFunc').value;
            const tolPower = parseInt(document.getElementById('tolSlider').value);
            const tol = Math.pow(10, tolPower);
            document.getElementById('tolValue').textContent = `1e${tolPower}`;

            const func = adaptiveFunctions[funcKey];
            
            // ì•½ê°„ì˜ ì§€ì—° í›„ ì‹¤í–‰ (UI ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´)
            setTimeout(() => {
                const adaptive = adaptiveSimpson(func.f, func.a, func.b, tol);
                
                // ê· ë“± ì‹¬í”„ìŠ¨ê³¼ ë¹„êµ
                let uniformN = 8;
                let uniformErr = Infinity;
                while (uniformErr > tol && uniformN < 10000) {
                    const simp = simpsonRule(func.f, func.a, func.b, uniformN);
                    uniformErr = Math.abs(func.exact - simp.result);
                    uniformN += 2;
                }

                document.getElementById('adaptEvals').textContent = adaptive.evals;
                document.getElementById('uniformEvals').textContent = uniformN + 1;
                document.getElementById('efficiency').textContent = 
                    (((uniformN + 1 - adaptive.evals) / (uniformN + 1)) * 100).toFixed(1) + '%';

                // íŠ¸ë¦¬ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
                renderTreeAnimated(adaptive.tree);
                
                // ë…¸ë“œ ë¶„í¬ ì‹œê°í™”
                visualizeAdaptiveNodes(func, uniformN);
                
                // ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ ë²„íŠ¼ í™œì„±í™”
                setTimeout(() => {
                    btn.disabled = false;
                    btn.textContent = 'ğŸš€ ì‹¤í–‰ ë° ë¶„ì„';
                    setTimeout(() => {
                        progressBar.style.display = 'none';
                    }, 500);
                }, adaptive.tree.length * 100 + 500);
            }, 100);
        }

        function visualizeAdaptiveNodes(func, uniformN) {
            // ê· ë“± ë…¸ë“œ
            const uniformContainer = document.getElementById('uniformNodes');
            uniformContainer.innerHTML = '<div class="node-line"></div>';
            
            const h = (func.b - func.a) / uniformN;
            for (let i = 0; i <= uniformN; i++) {
                const x = func.a + i * h;
                const pos = ((x - func.a) / (func.b - func.a)) * 90 + 5;
                const node = document.createElement('div');
                node.className = 'node-point';
                node.style.left = pos + '%';
                node.style.background = 'rgb(79, 172, 254)';
                uniformContainer.appendChild(node);
            }

            // ì ì‘ì  ë…¸ë“œ
            const adaptiveContainer = document.getElementById('adaptiveNodes');
            adaptiveContainer.innerHTML = '<div class="node-line"></div>';
            
            const densityMap = [];
            for (let i = 0; i <= 100; i++) {
                const x = func.a + (func.b - func.a) * i / 100;
                const density = Math.abs(func.f(x));
                densityMap.push(density);
            }
            
            const maxDensity = Math.max(...densityMap);
            let adaptivePoints = [func.a];
            let currentX = func.a;
            
            while (currentX < func.b) {
                const idx = Math.floor((currentX - func.a) / (func.b - func.a) * 100);
                const localDensity = densityMap[idx] / maxDensity;
                const step = (func.b - func.a) / 20 * (1 - 0.8 * localDensity);
                currentX = Math.min(currentX + step, func.b);
                adaptivePoints.push(currentX);
            }

            adaptivePoints.forEach(x => {
                const pos = ((x - func.a) / (func.b - func.a)) * 90 + 5;
                const node = document.createElement('div');
                node.className = 'node-point';
                node.style.left = pos + '%';
                node.style.background = 'rgb(67, 233, 123)';
                adaptiveContainer.appendChild(node);
            });
        }

        function runGaussian() {
            const funcKey = document.getElementById('gaussFunc').value;
            const n = parseInt(document.getElementById('gaussOrder').value);

            const func = gaussianFunctions[funcKey];
            const gauss = gaussLegendre(func.f, func.a, func.b, n);

            document.getElementById('gaussExact').textContent = func.exact.toFixed(8);
            document.getElementById('gaussResult').textContent = gauss.result.toFixed(8);
            document.getElementById('gaussError').textContent = 
                Math.abs(func.exact - gauss.result).toExponential(4);

            // ë…¸ë“œì™€ ê°€ì¤‘ì¹˜ í…Œì´ë¸”
            const tbody = document.getElementById('gaussTableBody');
            tbody.innerHTML = '';
            
            gaussQuadrature[n].nodes.forEach((node, i) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${i+1}</strong></td>
                    <td>${node.toFixed(10)}</td>
                    <td>${gaussQuadrature[n].weights[i].toFixed(10)}</td>
                `;
                tbody.appendChild(tr);
            });

            visualizeGaussianNodes(n);
            updateGaussianComparisonChart(func, n);
        }

        function visualizeGaussianNodes(n) {
            // Simpson ë…¸ë“œ
            const simpsonContainer = document.getElementById('simpsonNodes');
            simpsonContainer.innerHTML = '<div class="node-line"></div>';
            
            for (let i = 0; i <= 4; i++) {
                const pos = i * 22.5 + 5;
                const node = document.createElement('div');
                node.className = 'node-point';
                node.style.left = pos + '%';
                node.style.background = 'rgb(79, 172, 254)';
                simpsonContainer.appendChild(node);
            }

            // Gauss ë…¸ë“œ
            const gaussContainer = document.getElementById('gaussNodes');
            gaussContainer.innerHTML = '<div class="node-line"></div>';
            
            gaussQuadrature[n].nodes.forEach(nodeVal => {
                const pos = ((nodeVal + 1) / 2) * 90 + 5;
                const node = document.createElement('div');
                node.className = 'node-point';
                node.style.left = pos + '%';
                node.style.background = 'rgb(250, 112, 154)';
                
                const label = document.createElement('div');
                label.className = 'node-label';
                label.style.left = pos + '%';
                label.textContent = nodeVal.toFixed(3);
                
                gaussContainer.appendChild(node);
                gaussContainer.appendChild(label);
            });
        }

        function updateGaussianComparisonChart(func, gaussN) {
            const ctx = document.getElementById('gaussCompChart').getContext('2d');
            
            // ë™ì¼í•œ í‰ê°€ íšŸìˆ˜ë¡œ ë¹„êµ
            const evalCount = gaussN;
            
            const trap = trapezoidalRule(func.f, func.a, func.b, evalCount - 1);
            const simp = simpsonRule(func.f, func.a, func.b, evalCount - 1);
            const gauss = gaussLegendre(func.f, func.a, func.b, gaussN);

            const methods = [
                { name: `ì‚¬ë‹¤ë¦¬ê¼´ (${evalCount}ì )`, error: Math.abs(func.exact - trap.result), color: '#f5576c' },
                { name: `ì‹¬í”„ìŠ¨ (${evalCount}ì )`, error: Math.abs(func.exact - simp.result), color: '#4facfe' },
                { name: `ê°€ìš°ìŠ¤ n=2 (2ì )`, error: Math.abs(func.exact - gaussLegendre(func.f, func.a, func.b, 2).result), color: '#fa709a' },
                { name: `ê°€ìš°ìŠ¤ n=3 (3ì )`, error: Math.abs(func.exact - gaussLegendre(func.f, func.a, func.b, 3).result), color: '#fee140' },
                { name: `ê°€ìš°ìŠ¤ n=4 (4ì )`, error: Math.abs(func.exact - gaussLegendre(func.f, func.a, func.b, 4).result), color: '#43e97b' },
                { name: `ê°€ìš°ìŠ¤ n=5 (5ì )`, error: Math.abs(func.exact - gaussLegendre(func.f, func.a, func.b, 5).result), color: '#38f9d7' }
            ];

            if (charts.gaussCompChart) charts.gaussCompChart.destroy();

            charts.gaussCompChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: methods.map(m => m.name),
                    datasets: [{
                        label: 'ì ˆëŒ€ ì˜¤ì°¨ (ë‚®ì„ìˆ˜ë¡ ìš°ìˆ˜)',
                        data: methods.map(m => m.error),
                        backgroundColor: methods.map(m => m.color),
                        borderColor: methods.map(m => m.color),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            type: 'logarithmic',
                            title: { 
                                display: true, 
                                text: 'ì ˆëŒ€ ì˜¤ì°¨ (log scale)', 
                                font: { weight: 'bold', size: 14 }
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toExponential(0);
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'ìˆ˜ì¹˜ ì ë¶„ ë°©ë²•',
                                font: { weight: 'bold', size: 14 }
                            }
                        }
                    },
                    plugins: { 
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: ctx => `ì˜¤ì°¨: ${ctx.parsed.y.toExponential(4)}`
                            }
                        }
                    }
                }
            });
        }

        function runComprehensiveTest() {
            const func = functions.sin;
            const targetTol = 1e-6;

            const methods = [
                { name: 'ì‚¬ë‹¤ë¦¬ê¼´', run: (n) => trapezoidalRule(func.f, func.a, func.b, n) },
                { name: 'ì‹¬í”„ìŠ¨', run: (n) => simpsonRule(func.f, func.a, func.b, n) },
                { name: 'ì ì‘ì  ì‹¬í”„ìŠ¨', run: () => adaptiveSimpson(func.f, func.a, func.b, targetTol) },
                { name: 'ê°€ìš°ìŠ¤ n=3', run: () => gaussLegendre(func.f, func.a, func.b, 3) },
                { name: 'ê°€ìš°ìŠ¤ n=4', run: () => gaussLegendre(func.f, func.a, func.b, 4) }
            ];

            const results = [];

            // ì‚¬ë‹¤ë¦¬ê¼´
            for (let n = 4; n <= 1000; n += 2) {
                const trap = methods[0].run(n);
                if (Math.abs(func.exact - trap.result) < targetTol) {
                    results.push({
                        method: methods[0].name,
                        evals: trap.evals,
                        result: trap.result,
                        error: Math.abs(func.exact - trap.result)
                    });
                    break;
                }
            }

            // ì‹¬í”„ìŠ¨
            for (let n = 4; n <= 1000; n += 2) {
                const simp = methods[1].run(n);
                if (Math.abs(func.exact - simp.result) < targetTol) {
                    results.push({
                        method: methods[1].name,
                        evals: simp.evals,
                        result: simp.result,
                        error: Math.abs(func.exact - simp.result)
                    });
                    break;
                }
            }

            // ë‚˜ë¨¸ì§€ ë°©ë²•ë“¤
            [2, 3, 4].forEach(i => {
                const res = methods[i].run();
                results.push({
                    method: methods[i].name,
                    evals: res.evals,
                    result: res.result,
                    error: Math.abs(func.exact - res.result)
                });
            });

            // í…Œì´ë¸” ì—…ë°ì´íŠ¸
            const tbody = document.getElementById('compTableBody');
            tbody.innerHTML = '';

            results.sort((a, b) => a.error - b.error);

            results.forEach((r, idx) => {
                const tr = document.createElement('tr');
                const grade = idx === 0 ? 'ğŸ¥‡' : idx === 1 ? 'ğŸ¥ˆ' : idx === 2 ? 'ğŸ¥‰' : 'â­';
                const className = idx === 0 ? 'best' : '';
                
                tr.innerHTML = `
                    <td class="${className}"><strong>${r.method}</strong></td>
                    <td>${r.evals}</td>
                    <td>${r.result.toFixed(8)}</td>
                    <td class="${className}">${r.error.toExponential(4)}</td>
                    <td>${(r.error / func.exact * 100).toExponential(2)}%</td>
                    <td style="font-size: 1.5em;">${grade}</td>
                `;
                tbody.appendChild(tr);
            });

            updateEfficiencyChart(results);
        }

        function updateEfficiencyChart(results) {
            const ctx = document.getElementById('efficiencyChart').getContext('2d');

            const colors = ['#f5576c', '#4facfe', '#43e97b', '#fa709a', '#fee140'];

            if (charts.efficiencyChart) charts.efficiencyChart.destroy();

            charts.efficiencyChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: results.map((r, idx) => ({
                        label: r.method,
                        data: [{x: r.evals, y: r.error}],
                        backgroundColor: colors[idx % colors.length],
                        borderColor: colors[idx % colors.length],
                        pointRadius: 15,
                        pointHoverRadius: 20,
                        borderWidth: 3
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { 
                            type: 'logarithmic',
                            title: { 
                                display: true, 
                                text: 'í•¨ìˆ˜ í‰ê°€ íšŸìˆ˜ (log scale)', 
                                font: { weight: 'bold', size: 16 }
                            },
                            ticks: {
                                callback: function(value) {
                                    return value;
                                },
                                font: { size: 12 }
                            }
                        },
                        y: { 
                            type: 'logarithmic',
                            title: { 
                                display: true, 
                                text: 'ì ˆëŒ€ ì˜¤ì°¨ (log scale)', 
                                font: { weight: 'bold', size: 16 }
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toExponential(0);
                                },
                                font: { size: 12 }
                            }
                        }
                    },
                    plugins: { 
                        legend: { 
                            position: 'right',
                            labels: {
                                font: { size: 14, weight: 'bold' },
                                padding: 15
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: ctx => {
                                    return `${ctx.dataset.label}: í‰ê°€ ${ctx.parsed.x}íšŒ, ì˜¤ì°¨ ${ctx.parsed.y.toExponential(4)}`;
                                }
                            },
                            bodyFont: { size: 14 }
                        }
                    }
                }
            });
        }

        // ì´ˆê¸°í™”
        window.onload = () => {
            updateAll();
            document.getElementById('tolSlider').addEventListener('input', function() {
                const tolPower = parseInt(this.value);
                document.getElementById('tolValue').textContent = `1e${tolPower}`;
            });
        };
    </script>
</body>
</html>