<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tractrix Curve íƒêµ¬ ë³´ê³ ì„œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/sun-typeface/d2coding/d2coding.css" rel="stylesheet">
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" crossorigin="anonymous"></script>
    <!-- PrismJS for code highlighting (Light Theme) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>

    <style>
        :root { 
            --accent-color: #16a34a; /* Green */
            --invalid-color: #ef4444;
            --font-sans: 'Noto Sans KR', sans-serif;
            --font-mono: 'D2Coding', monospace;
        }
        body { font-family: var(--font-sans); scroll-behavior: smooth; }
        .step-card { transition: transform 0.3s, box-shadow 0.3s; }
        .step-card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .interactive-canvas { 
            border: 1px solid #e2e8f0; 
            border-radius: 0.5rem; 
            background-color: #f8fafc; 
            cursor: grab; /* ë“œë˜ê·¸ ê°€ëŠ¥ ì»¤ì„œ */
        }
        .interactive-canvas.grabbing {
            cursor: grabbing; /* ë“œë˜ê·¸ ì¤‘ ì»¤ì„œ */
        }
        .tab-button.active { border-color: var(--accent-color); color: var(--accent-color); font-weight: 600; }
        .tab-content { display: none; } .tab-content.active { display: block; }
        .editable-field, .markdown-input {
            width: 100%;
            border: 1px solid #cbd5e1;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
            font-family: var(--font-sans);
            min-height: 120px;
        }
        input.editable-field { min-height: auto; }
        .font-mono { font-family: var(--font-mono) !important; }
        .editable-field:focus, .markdown-input:focus { outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 2px color-mix(in srgb, var(--accent-color) 25%, transparent); }
        .is-invalid { border-color: var(--invalid-color) !important; }
        .is-invalid:focus { box-shadow: 0 0 0 2px color-mix(in srgb, var(--invalid-color) 25%, transparent) !important; }
        .file-upload-label { cursor: pointer; background-color: #f8fafc; color: #475569; padding: 0.5rem 1rem; border-radius: 0.375rem; border: 1px solid #cbd5e1; font-size: 0.875rem; font-weight: 500; transition: all 0.2s; }
        .file-upload-label:hover { background-color: #f1f5f9; border-color: var(--accent-color); }
        .markdown-preview { cursor: text; padding: 1.25rem; background-color: #f8fafc; border-radius: 0.5rem; border: 1px solid transparent; min-height: 120px; transition: background-color 0.2s; }
        .markdown-preview:hover { background-color: #f8fafc; border-color: #e2e8f0; }
        .editable-container .markdown-input { display: none; }
        .editable-container .markdown-preview { display: block; }

        /* Prose/Markdown ìŠ¤íƒ€ì¼ (CausticCurve.htmlì—ì„œ ë³µì‚¬) */
        .prose { color: #374151; max-width: 65ch; font-size: 1rem; line-height: 1.75; }
        .prose p { margin-top: 1.25em; margin-bottom: 1.25em; }
        .prose h1, .prose h2, .prose h3, .prose h4, .prose h5, .prose h6 { color: #111827; font-weight: 600; line-height: 1.25; margin-top: 2em; margin-bottom: 1em; }
        .prose h1 { font-size: 2.25em; } .prose h2 { font-size: 1.5em; } .prose h3 { font-size: 1.25em; }
        .prose a { color: var(--accent-color); text-decoration: underline; } .prose a:hover { color: #15803d; }
        .prose strong, .prose b { color: #111827; font-weight: 600; }
        .prose code { color: #be185d; font-family: var(--font-mono); font-size: 0.875em; padding: 0.2em 0.4em; background-color: #f3f4f6; border-radius: 0.25rem; }
        .prose pre { background-color: #f3f4f6; color: #111827; overflow-x: auto; font-size: 0.875em; line-height: 1.7142857; margin-top: 1.7142857em; margin-bottom: 1.7142857em; border-radius: 0.375rem; padding: 0.8571429em 1.1428571em; }
        .prose pre code { background-color: transparent; border-width: 0; border-radius: 0; padding: 0; color: inherit; font-size: inherit; font-family: var(--font-mono); line-height: inherit; }
        .prose ul, .prose ol { margin-top: 1.25em; margin-bottom: 1.25em; padding-left: 1.625em; }
        .prose ul { list-style-type: disc; } .prose ol { list-style-type: decimal; }
        .prose li { margin-top: 0.5em; margin-bottom: 0.5em; }
        .prose blockquote { font-style: italic; color: #111827; border-left-width: 0.25rem; border-left-color: #e5e7eb; quotes: "\201C""\201D""\2018""\2019"; margin-top: 1.6em; margin-bottom: 1.6em; padding-left: 1em; }
        .prose hr { border-color: #e5e7eb; border-top-width: 1px; margin-top: 3em; margin-bottom: 3em; }
        .prose table { width: 100%; table-layout: auto; text-align: left; margin-top: 2em; margin-bottom: 2em; font-size: 0.875em; line-height: 1.7142857; }
        .prose thead { border-bottom-width: 1px; border-bottom-color: #d1d5db; }
        .prose thead th { color: #111827; font-weight: 600; vertical-align: bottom; padding: 0.5714286em; }
        .prose tbody tr { border-bottom-width: 1px; border-bottom-color: #e5e7eb; }
        .prose tbody td { vertical-align: baseline; padding: 0.5714286em; }
        .prose img { margin-top: 2em; margin-bottom: 2em; }

        /* ì¸ì‡„ ìŠ¤íƒ€ì¼ (CausticCurve.htmlì—ì„œ ë³µì‚¬) */
        @media print {
            @page { size: A4; margin: 10mm 8mm 10mm 8mm; }
            body { background-color: #ffffff !important; margin: 0 !important; padding: 0 !important; }
            .container { max-width: 100% !important; padding-left: 0 !important; padding-right: 0 !important; margin: 0 !important; }
            main.container { padding: 0 !important; }
            .print-hidden { display: none !important; }
            .step-card { page-break-inside: avoid; break-inside: avoid; box-shadow: none !important; border: 1px solid #e2e8f0; margin-bottom: 1.5rem; padding: 1rem !important; }
            .editable-container .markdown-input { display: none !important; }
            .editable-container .markdown-preview { display: block !important; border: none !important; padding: 0 !important; background-color: transparent !important; margin-top: 0 !important; }
            .screenshot-container img { max-width: 100% !important; display: block !important; }
            #student-id, #student-name { display: block !important; border: none !important; padding: 0.5rem !important; background-color: transparent !important; }
            pre { white-space: pre-wrap !important; word-wrap: break-word !important; overflow-wrap: break-word !important; max-width: 100% !important; overflow: visible !important; page-break-inside: avoid; font-size: 9pt !important; line-height: 1.3 !important; padding: 0.5rem !important; margin: 0.5rem 0 !important; }
            pre code { white-space: pre-wrap !important; word-wrap: break-word !important; overflow-wrap: break-word !important; font-size: 9pt !important; }
            code { word-break: break-word !important; overflow-wrap: break-word !important; }
            .prose { max-width: 100% !important; }
            .prose pre { background-color: #f5f5f5 !important; border: 1px solid #ddd !important; }
            .tab-content { padding: 0 !important; }
            .grid { gap: 0.5rem !important; }
            canvas { max-width: 100% !important; height: auto !important; }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Header -->
    <header class="bg-white shadow-md sticky top-0 z-20 print-hidden">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-green-700">Tractrix Curve íƒêµ¬ ë³´ê³ ì„œ</h1>
            <nav class="hidden md:flex space-x-4">
                <a href="#step1" class="text-gray-600 hover:text-green-600">Step 1: ì‹¤í—˜</a>
                <a href="#step2" class="text-gray-600 hover:text-green-600">Step 2: ê°€ì •</a>
                <a href="#step3" class="text-gray-600 hover:text-green-600">Step 3: ì‹œë®¬ë ˆì´ì…˜</a>
                <a href="#step4" class="text-gray-600 hover:text-green-600">Step 4: ìˆ˜ì‹í™”</a>
                <a href="#step5" class="text-gray-600 hover:text-green-600">Step 5: ì‹¬í™” íƒêµ¬</a>
                <a href="#step6" class="text-gray-600 hover:text-green-600">Step 6: ì°¸ê³  ë¬¸í—Œ</a>
            </nav>
            <div class="md:hidden"><button id="mobile-menu-button" class="text-gray-800 focus:outline-none"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg></button></div>
        </div>
        <nav id="mobile-menu" class="md:hidden hidden bg-white px-6 pt-2 pb-4">
            <a href="#step1" class="block py-2">Step 1</a>
            <a href="#step2" class="block py-2">Step 2</a>
            <a href="#step3" class="block py-2">Step 3</a>
            <a href="#step4" class="block py-2">Step 4</a>
            <a href="#step5" class="block py-2">Step 5</a>
            <a href="#step6" class="block py-2">Step 6</a>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-12">
        <section class="bg-white p-6 sm:p-8 rounded-xl shadow-lg mb-8 step-card">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div><label for="student-id" class="font-semibold">ğŸ”¢ í•™ë²ˆ</label><input type="text" id="student-id" placeholder="ì˜ˆ: 30101" class="editable-field mt-1"></div>
                <div><label for="student-name" class="font-semibold">ğŸ† ì´ë¦„</label><input type="text" id="student-name" placeholder="ì˜ˆ: í™ê¸¸ë™" class="editable-field mt-1"></div>
            </div>
        </section>

        <!-- Step 1: Experiment -->
        <section id="step1" class="mb-16">
            <div class="step-card bg-white p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold mb-4 border-b-2 border-green-200 pb-2">Step 1: Tractrix ì‹¤í—˜ ë° ê¶¤ì  ë¶„ì„</h2>
                <p class="mb-6 text-gray-600">
                    ì§€ìš°ê°œì— í„¸ì‹¤ì„ ë¬¶ê³ , í„¸ì‹¤ì˜ ë‹¤ë¥¸ ìª½ ë(ì†)ì„ ì±…ìƒ ìœ„ì—ì„œ ì§ì„ ìœ¼ë¡œ ë‹¹ê²¨ë³´ì„¸ìš”. ì´ë•Œ ì§€ìš°ê°œê°€ ê·¸ë¦¬ëŠ” ê¶¤ì (Tractrix)ì„ ìŠ¤ë§ˆíŠ¸í° ë“±ìœ¼ë¡œ ì´¬ì˜í•˜ê³ , 'Tracker'ì™€ ê°™ì€ ë¬¼ë¦¬ ë¶„ì„ í”„ë¡œê·¸ë¨ìœ¼ë¡œ ê¶¤ì ì„ ë¶„ì„í•´ ë´…ì‹œë‹¤.
                </p>
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Image Upload 1 -->
                    <div>
                        <h3 class="block text-lg font-semibold mb-2">ğŸ“¸ ì‹¤í—˜ ì‚¬ì§„ / ì˜ìƒ ìº¡ì²˜</h3>
                        <div class="mt-4 border rounded-lg p-4 bg-gray-50 min-h-[200px] flex items-center justify-center screenshot-container">
                             <img id="screenshot-preview-1" alt="ì‹¤í—˜ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸°" class="max-w-full max-h-64 rounded-md hidden"><span id="screenshot-placeholder-1" class="text-slate-500">ì‹¤í—˜ ì‚¬ì§„ ì²¨ë¶€</span>
                        </div>
                        <div class="mt-2 image-upload-ui text-center print-hidden"><input type="file" accept="image/*,video/*" onchange="previewMedia(event, 1)" class="hidden" id="screenshot-input-1"><label for="screenshot-input-1" class="file-upload-label">ì´ë¯¸ì§€/ë¹„ë””ì˜¤ ì„ íƒ</label></div>
                    </div>
                    <!-- Image Upload 2 -->
                    <div>
                        <h3 class="block text-lg font-semibold mb-2">ğŸ“ˆ Tracker ê¶¤ì  ë¶„ì„ ê²°ê³¼</h3>
                        <div class="mt-4 border rounded-lg p-4 bg-gray-50 min-h-[200px] flex items-center justify-center screenshot-container">
                             <img id="screenshot-preview-2" alt="ê¶¤ì  ë¶„ì„ ë¯¸ë¦¬ë³´ê¸°" class="max-w-full max-h-64 rounded-md hidden"><span id="screenshot-placeholder-2" class="text-slate-500">ë¶„ì„ ê²°ê³¼ ìº¡ì²˜ ì²¨ë¶€</span>
                        </div>
                        <div class="mt-2 image-upload-ui text-center print-hidden"><input type="file" accept="image/*" onchange="previewMedia(event, 2)" class="hidden" id="screenshot-input-2"><label for="screenshot-input-2" class="file-upload-label">ì´ë¯¸ì§€ ì„ íƒ</label></div>
                    </div>
                </div>
                <!-- Markdown Input -->
                <div class="mt-8">
                    <label for="observations" class="block text-lg font-semibold mb-2">ğŸ“ ì‹¤í—˜ ê²°ê³¼ ê´€ì°° ë° ë¶„ì„</label>
                    <div class="editable-container">
                        <textarea id="observations" class="markdown-input editable-field" placeholder="ì‹¤ì œ ì‹¤í—˜ì—ì„œ ê´€ì°°í•œ ë‚´ìš©ì„ ì„œìˆ í•˜ì„¸ìš”.&#10;&#10;ì˜ˆì‹œ)&#10;- ì†ì„ xì¶•ì„ ë”°ë¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë‹¹ê²¼ì„ ë•Œ, ì§€ìš°ê°œëŠ” ê³¡ì„ ì„ ê·¸ë¦¬ë©° ë”°ë¼ì™”ë‹¤.&#10;- ì§€ìš°ê°œê°€ ê·¸ë¦° ê¶¤ì ì€ xì¶•ì— ì ì  ê°€ê¹Œì›Œì§€ì§€ë§Œ ë§Œë‚˜ì§€ëŠ” ì•ŠëŠ” ê²ƒì²˜ëŸ¼ ë³´ì˜€ë‹¤.&#10;- Tracker í”„ë¡œê·¸ë¨ìœ¼ë¡œ ë¶„ì„í•œ ê¶¤ì ì˜ ëª¨ì–‘ì€..."></textarea>
                        <div class="markdown-preview prose max-w-none"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 2: Hypothesis Setup -->
        <section id="step2" class="mb-16">
            <div class="step-card bg-white p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold mb-4 border-b-2 border-blue-200 pb-2">Step 2: ìˆ˜í•™ì  ëª¨ë¸ë§ì„ ìœ„í•œ ê°€ì •</h2>
                <p class="mb-6 text-gray-600">
                    ì‹¤ì œ ì‹¤í—˜ì€ ë³µì¡í•œ ìš”ì†Œ(ë§ˆì°°, ì¤„ì˜ íƒ„ì„±, ì†ì˜ ë¶ˆê·œì¹™í•œ ì†ë„ ë“±)ê°€ ë§ìŠµë‹ˆë‹¤. ì§€ìš°ê°œì˜ ê¶¤ì ì„ ìˆ˜í•™ì ìœ¼ë¡œ ë‹¨ìˆœí•˜ê²Œ ë¶„ì„í•˜ê¸° ìœ„í•´ ì–´ë–¤ ê°€ì •ì„ ì„¸ìš¸ ìˆ˜ ìˆì„ì§€ ì„œìˆ í•´ ë³´ì„¸ìš”.
                </p>
                <div class="editable-container">
                    <textarea id="assumptions" class="markdown-input editable-field" placeholder="ëª¨ë¸ì„ ë‹¨ìˆœí™”í•˜ê¸° ìœ„í•œ ê°€ì •ì„ ë‚˜ì—´í•´ ë³´ì„¸ìš”.&#10;&#10;ì˜ˆì‹œ)&#10;1.  **(í•„ìˆ˜)** í„¸ì‹¤ì˜ ê¸¸ì´ëŠ” í•­ìƒ $L$ ë¡œ ì¼ì •í•˜ë‹¤.&#10;2.  **(í•„ìˆ˜)** ì§€ìš°ê°œ(ë¬¼ì²´)ëŠ” í•­ìƒ í„¸ì‹¤ì´ ë‹¹ê¸°ëŠ” ë°©í–¥(ì ‘ì„  ë°©í–¥)ìœ¼ë¡œë§Œ ì›€ì§ì¸ë‹¤.&#10;3.  ì†(ë„ëŠ” ì )ì€ ì¼ì •í•œ ì†ë„ë¡œ $y$ì¶•(ë˜ëŠ” $x$ì¶•)ì„ ë”°ë¼ ì›€ì§ì¸ë‹¤.&#10;4.  ì§€ìš°ê°œì™€ ë°”ë‹¥ ì‚¬ì´ì˜ ë§ˆì°°, ê³µê¸° ì €í•­ ë“± ëª¨ë“  ì €í•­ë ¥ì€ ë¬´ì‹œí•œë‹¤.&#10;5.  ì§€ìš°ê°œì™€ í„¸ì‹¤ì˜ ì§ˆëŸ‰ì€ ë¬´ì‹œí•œë‹¤."></textarea>
                    <div class="markdown-preview prose max-w-none"></div>
                </div>
            </div>
        </section>

        <!-- Step 3: Simulation Creation -->
        <section id="step3" class="mb-16">
            <div class="step-card bg-white p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold mb-4 border-b-2 border-purple-200 pb-2">Step 3: Tractrix ìš´ë™ ì‹œë®¬ë ˆì´ì…˜</h2>
                <p class="mb-6 text-gray-600">
                    Step 2ì—ì„œ ì„¸ìš´ ê°€ì •ì„ ë°”íƒ•ìœ¼ë¡œ Tractrix ìš´ë™ì„ ì‹œë®¬ë ˆì´ì…˜í•´ ë´…ì‹œë‹¤. ì•„ë˜ëŠ” JavaScriptë¡œ êµ¬í˜„ëœ ì¸í„°ë™í‹°ë¸Œ ì‹œë®¬ë ˆì´ì…˜ ì˜ˆì‹œì…ë‹ˆë‹¤.
                </p>
                <!-- Interactive Canvas -->
                <div class="flex flex-col lg:flex-row items-center gap-8">
                    <div class="w-full lg:w-2/3">
                        <canvas id="tractrixCanvas" width="500" height="600" class="interactive-canvas mx-auto"></canvas>
                    </div>
                    <div class="w-full lg:w-1/3 space-y-4">
                        <div class="flex items-center">
                            <label for="l-slider" class="min-w-[100px] font-medium">ì¤„ ê¸¸ì´ (L):</label>
                            <input type="range" id="l-slider" min="50" max="150" value="100" class="w-full h-2 bg-gray-200 rounded-lg cursor-pointer">
                            <span id="l-value" class="ml-4 font-semibold w-16 text-center">100</span>
                        </div>
                        <div class="flex items-center">
                            <label for="t-slider" class="min-w-[100px] font-medium">ì§„í–‰ ê°ë„ (t):</label>
                            <input type="range" id="t-slider" min="5" max="175" value="90" class="w-full h-2 bg-gray-200 rounded-lg cursor-pointer">
                            <span id="t-value" class="ml-4 font-semibold w-16 text-center">90Â°</span>
                        </div>
                        <div class="bg-gray-100 p-4 rounded-lg">
                            <h4 class="font-semibold text-lg mb-2">ì‹œë®¬ë ˆì´ì…˜ ì„¤ëª…</h4>
                            <p>â–ªï¸ <span class="text-red-500 font-bold">ë¶‰ì€ ì </span>: ë‹¹ê²¨ì§€ëŠ” ë¬¼ì²´ (ì§€ìš°ê°œ)</p>
                            <p>â–ªï¸ <span class="text-blue-500 font-bold">íŒŒë€ ì </span>: ë„ëŠ” ì  (ì†)</p>
                            <p>â–ªï¸ ë„ëŠ” ì (ì†)ì„ $y$ì¶•ì„ ë”°ë¼ **ë“œë˜ê·¸**í•´ ë³´ì„¸ìš”.</p>
                            <p>â–ªï¸ ë¬¼ì²´(ì§€ìš°ê°œ)ì˜ ê¶¤ì ì´ <span class="text-green-600">ë…¹ìƒ‰ ì„ </span>ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</p>
                        </div>
                    </div>
                </div>
                <!-- Code Tabs -->
                <div class="mt-12 pt-8 border-t print-hidden">
                    <h3 class="text-xl font-semibold mb-4">ì°¸ê³ : ë‹¤ì–‘í•œ ë„êµ¬ë³„ ì œì‘ ê³¼ì •</h3>
                    <div class="mb-4 border-b border-gray-200"><nav class="-mb-px flex space-x-8"><button class="tab-button active whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" data-tab="geogebra">GeoGebra</button><button class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="python">Python</button><button class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="matlab">MATLAB</button></nav></div>
                    <div>
                        <div id="geogebra" class="tab-content active">
                            <h4 class="text-lg font-semibold mb-2">GeoGebra (ë§¤ê°œë³€ìˆ˜ ê³¡ì„ )</h4>
                            <ol class="list-decimal list-inside space-y-2 text-sm">
                                <li>ìŠ¬ë¼ì´ë” ìƒì„±: <code>L = 1</code> (ì¤„ì˜ ê¸¸ì´)</li>
                                <li>ìŠ¬ë¼ì´ë” ìƒì„±: <code>t_max = 10</code> (tì˜ ìµœëŒ€ê°’)</li>
                                <li>ë§¤ê°œë³€ìˆ˜ ê³¡ì„  ì…ë ¥: <code>Curve(L(cos(t) + log(tan(t/2))), L sin(t), t, 0.01, t_max)</code></li>
                                <li>(yì¶•ì„ ë”°ë¼ ë‹¹ê¸¸ ê²½ìš°) <code>Curve(L sin(t), L(cos(t) + log(tan(t/2))), t, 0.01, t_max)</code></li>
                            </ol>
                        </div>
                        <div id="python" class="tab-content"><h4 class="text-lg font-semibold mb-2">Python (Matplotlib)</h4><pre><code class="language-python text-sm">import numpy as np
import matplotlib.pyplot as plt

L = 1.0  # ì¤„ì˜ ê¸¸ì´
t = np.linspace(0.01, np.pi - 0.01, 500) # t ë²”ìœ„ (0, pi)

# Tractrix ë§¤ê°œë³€ìˆ˜ ë°©ì •ì‹ (xì¶•ì„ ë”°ë¼ ë‹¹ê¸°ëŠ” ê²½ìš°)
# x = L * (np.log(np.tan(t / 2)) + np.cos(t))
# y = L * np.sin(t)

# yì¶•ì„ ë”°ë¼ ë‹¹ê¸°ëŠ” ê²½ìš° (xì™€ y êµì²´)
x_tractrix = L * np.sin(t)
y_tractrix = L * (np.log(np.tan(t / 2)) + np.cos(t))

plt.figure(figsize=(8, 8))
plt.plot(x_tractrix, y_tractrix, 'g-', label='Tractrix (Object)')
plt.plot(np.zeros_like(y_tractrix), y_tractrix, 'b--', label='Puller Path (y-axis)') # ë„ëŠ” ì ì˜ ê²½ë¡œ

# íŠ¹ì • tê°’ì—ì„œì˜ ì¤„(ì ‘ì„ ) í‘œì‹œ (ì˜ˆ: t = pi/2)
t_val = np.pi / 2
obj_x = L * np.sin(t_val)
obj_y = L * (np.log(np.tan(t_val / 2)) + np.cos(t_val))
puller_y = L * np.log(np.tan(t_val / 2)) # ë„ëŠ” ì ì˜ yì¢Œí‘œ
plt.plot([obj_x, 0], [obj_y, puller_y], 'r-o', label=f'String (t={t_val:.2f})')

plt.title('Tractrix Simulation')
plt.xlabel('x')
plt.ylabel('y')
plt.legend()
plt.grid(True)
plt.axis('equal')
plt.show()</code></pre></div>
                         <div id="matlab" class="tab-content"><h4 class="text-lg font-semibold mb-2">MATLAB</h4><pre><code class="language-matlab text-sm">L = 1.0; % ì¤„ì˜ ê¸¸ì´
t = linspace(0.01, pi - 0.01, 500); % t ë²”ìœ„ (0, pi)

% yì¶•ì„ ë”°ë¼ ë‹¹ê¸°ëŠ” ê²½ìš°
x_tractrix = L .* sin(t);
y_tractrix = L .* (log(tan(t / 2)) + cos(t));

figure;
plot(x_tractrix, y_tractrix, 'g-', 'LineWidth', 2);
hold on;

% ë„ëŠ” ì ì˜ ê²½ë¡œ (yì¶•)
plot(zeros(size(y_tractrix)), y_tractrix, 'b--');

% íŠ¹ì • tê°’ì—ì„œì˜ ì¤„(ì ‘ì„ ) í‘œì‹œ (ì˜ˆ: t = pi/2)
t_val = pi / 2;
obj_x = L * sin(t_val);
obj_y = L * (log(tan(t_val / 2)) + cos(t_val));
puller_y = L * log(tan(t_val / 2)); % ë„ëŠ” ì ì˜ yì¢Œí‘œ
plot([obj_x, 0], [obj_y, puller_y], 'r-o', 'MarkerFaceColor', 'r');

title('Tractrix Simulation');
xlabel('x');
ylabel('y');
legend('Tractrix (Object)', 'Puller Path (y-axis)', 'String');
grid on;
axis equal;
hold off;</code></pre></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 4: Formulation -->
        <section id="step4" class="mb-16">
            <div class="step-card bg-white p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold mb-4 border-b-2 border-yellow-200 pb-2">Step 4: Tractrix ê³¡ì„  ìˆ˜ì‹í™”</h2>
                <p class="mb-6 text-gray-600">
                    Step 2ì˜ ê°€ì •ì„ ë°”íƒ•ìœ¼ë¡œ Tractrix ê³¡ì„ ì„ ë‚˜íƒ€ë‚´ëŠ” ë°©ì •ì‹ì„ ìœ ë„í•´ ë³´ì„¸ìš”.
                    ë¬¼ì²´(ì§€ìš°ê°œ)ê°€ ì  $P(x, y)$ì— ìˆê³ , ë„ëŠ” ì (ì†)ì´ $y$ì¶• ìœ„ì˜ ì  $T(0, t_y)$ì— ìˆë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤.
                </p>
                <!-- Key Formulas -->
                <div class="bg-gray-100 p-6 rounded-lg mb-8">
                    <h4 class="font-semibold text-lg mb-2">Tractrixì˜ ì£¼ìš” ì†ì„± ë° ë°©ì •ì‹</h4>
                    <p class="mb-2">
                        1.  **ì •ì˜:** ë¬¼ì²´ $P(x, y)$ì—ì„œ ê·¸ì€ ì ‘ì„ ì´ $y$ì¶•ê³¼ ë§Œë‚˜ëŠ” ì  $T(0, t_y)$ê¹Œì§€ì˜ ê±°ë¦¬($PT$)ê°€ í•­ìƒ ì¤„ì˜ ê¸¸ì´ $L$ë¡œ ì¼ì •í•©ë‹ˆë‹¤.
                    </p>
                    <p class="mb-2">
                        2.  **ì ‘ì„ :** $P(x, y)$ì—ì„œì˜ ì ‘ì„ ì˜ ê¸°ìš¸ê¸°ëŠ” $\frac{dy}{dx}$ì…ë‹ˆë‹¤. ì ‘ì„ ì˜ ë°©ì •ì‹ì€ $Y - y = \frac{dy}{dx}(X - x)$ì…ë‹ˆë‹¤.
                    </p>
                    <p class="mb-2">
                        3.  **$y$ì ˆí¸ ($T$):** $X=0$ì„ ëŒ€ì…í•˜ë©´ $t_y = y - x \frac{dy}{dx}$ ì…ë‹ˆë‹¤.
                    </p>
                    <p class="mb-2">
                        4.  **ê±°ë¦¬ ê³µì‹:** $PT = \sqrt{(x - 0)^2 + (y - t_y)^2} = L$
                    </p>
                    <p class="mb-2">
                        5.  **ë¯¸ë¶„ ë°©ì •ì‹:** ìœ„ ì‹ë“¤ì„ ì—°ë¦½í•˜ë©´ $x^2 + \left(x \frac{dy}{dx}\right)^2 = L^2$ ë˜ëŠ” $\frac{dy}{dx} = \pm \frac{\sqrt{L^2 - x^2}}{x}$ ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <p class="font-semibold mt-4">
                        â–ªï¸ <strong>ë§¤ê°œë³€ìˆ˜ ë°©ì •ì‹ (Parametric Equations)</strong> ( $t$ëŠ” $y$ì¶•ê³¼ ì¤„ì´ ì´ë£¨ëŠ” ê°)
                    </p>
                    <p class="ml-4">$x(t) = L \sin(t)$</p>
                    <p class="ml-4">$y(t) = L \left( \cos(t) + \ln\left(\tan\left(\frac{t}{2}\right)\right) \right)$</p>
                </div>
                <!-- Markdown Input for Derivation -->
                <label for="derivation" class="block text-lg font-semibold mb-2">ğŸ” ìˆ˜ì‹ ìœ ë„ ê³¼ì •</label>
                <div class="editable-container">
                    <textarea id="derivation" class="markdown-input editable-field" placeholder="Tractrixì˜ ë¯¸ë¶„ ë°©ì •ì‹ ë˜ëŠ” ë§¤ê°œë³€ìˆ˜ ë°©ì •ì‹ì„ ìœ ë„í•˜ëŠ” ê³¼ì •ì„ ì„œìˆ í•˜ì„¸ìš”.&#10;&#10;ì˜ˆì‹œ)&#10;ì  $P(x,y)$ì—ì„œ ì ‘ì„ ì˜ ë°©ì •ì‹ì€ $Y - y = y'(X - x)$ ì´ë‹¤.&#10;ì´ ì ‘ì„ ì´ $y$ì¶•ê³¼ ë§Œë‚˜ëŠ” ì  $T$ì˜ ì¢Œí‘œëŠ” $X=0$ì„ ëŒ€ì…í•˜ì—¬ $T(0, y - xy')$ ì´ë‹¤.&#10;ë‘ ì  $P$ì™€ $T$ ì‚¬ì´ì˜ ê±°ë¦¬ê°€ $L$ë¡œ ì¼ì •í•˜ë¯€ë¡œ,&#10;$\sqrt{(x-0)^2 + (y - (y-xy'))^2} = L$&#10;..."></textarea>
                    <div class="markdown-preview prose max-w-none"></div>
                </div>
            </div>
        </section>

        <!-- Step 5: Advanced Inquiry -->
        <section id="step5" class="mb-16">
            <div class="step-card bg-white p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold mb-4 border-b-2 border-red-200 pb-2">Step 5: ì‹¬í™” íƒêµ¬</h2>
                <p class="mb-6 text-gray-600">
                    ê¸°ë³¸ì ì¸ Tractrix ëª¨ë¸ì„ í™•ì¥í•˜ì—¬ ìƒˆë¡œìš´ íƒêµ¬ë¥¼ ì§„í–‰í•´ ë³´ì„¸ìš”. (ì˜ˆ: ë„ëŠ” ì ì´ ì›ì„ ë”°ë¼ ì›€ì§ì´ëŠ” ê²½ìš°(Circular Tractrix), ë§ˆì°°ë ¥ì„ ê³ ë ¤í•˜ëŠ” ê²½ìš°, ì¤„ì´ íƒ„ì„±ì„ ê°–ëŠ” ê²½ìš° ë“±)
                    íƒêµ¬ ê³¼ì •ì€ <span class="font-semibold">[ì‹¤í—˜(ê´€ì°°) â†’ ê°€ì • â†’ ì‹œë®¬ë ˆì´ì…˜ â†’ ìˆ˜ì‹í™” â†’ ê²°ë¡  â†’ í›„ì† ì—°êµ¬]</span>ì˜ ë‹¨ê³„ë¥¼ ë”°ë¦…ë‹ˆë‹¤.
                </p>
                <div class="space-y-8">
                    <div><label for="inquiry-title" class="block text-lg font-semibold mb-2">1. ì‹¬í™” íƒêµ¬ ì£¼ì œ</label><input type="text" id="inquiry-title" class="editable-field" placeholder="ì˜ˆ: ë„ëŠ” ì ì´ ì› ê¶¤ë„ë¥¼ ëŒ ë•Œì˜ Tractrix (Circular Tractrix) ë¶„ì„"></div>
                    <div><label for="inquiry-question" class="block text-lg font-semibold mb-2">2. íƒêµ¬ ì§ˆë¬¸ ë° ë™ê¸°</label><div class="editable-container"><textarea id="inquiry-question" class="markdown-input editable-field" placeholder="ì˜ˆ: ì†ì´ ì§ì„ ì´ ì•„ë‹Œ ì›ì„ ë”°ë¼ ì›€ì§ì¼ ë•Œ ì§€ìš°ê°œì˜ ê¶¤ì ì€ ì–´ë– í• ê¹Œ? (Circular Tractrix)&#10;ë§Œì•½ ì¤„ì´ ìŠ¤í”„ë§ì²˜ëŸ¼ íƒ„ì„±ì´ ìˆë‹¤ë©´ ê¶¤ì ì€ ì–´ë–»ê²Œ ë³€í• ê¹Œ?&#10;ë°”ë‹¥ì˜ ë§ˆì°° ê³„ìˆ˜ê°€ ìœ„ì¹˜ë§ˆë‹¤ ë‹¬ë¼ì§„ë‹¤ë©´?"></textarea><div class="markdown-preview prose max-w-none"></div></div></div>
                    <div><label for="inquiry-hypothesis" class="block text-lg font-semibold mb-2">3. ê°€ì • ì„¸ìš°ê¸°</label><div class="editable-container"><textarea id="inquiry-hypothesis" class="markdown-input editable-field" placeholder="ì‹¬í™” íƒêµ¬ë¥¼ ìœ„í•œ ìƒˆë¡œìš´ ê°€ì •ì´ë‚˜ ìˆ˜ì •ëœ ê°€ì •ì„ ì„œìˆ í•˜ì„¸ìš”."></textarea><div class="markdown-preview prose max-w-none"></div></div></div>
                    <div><label for="inquiry-simulation" class="block text-lg font-semibold mb-2">4. ì‹œë®¬ë ˆì´ì…˜ ì œì‘ ë° ìˆ˜ì‹í™”</label><div class="editable-container"><textarea id="inquiry-simulation" class="markdown-input editable-field" placeholder="ìƒˆë¡œìš´ ëª¨ë¸ì„ ì‹œë®¬ë ˆì´ì…˜í•˜ëŠ” ì½”ë“œ(Python, Geogebra ë“±)ë‚˜ ìˆ˜ì‹ ìœ ë„ ê³¼ì •ì„ ì‘ì„±í•˜ì„¸ìš”. (í•„ìš”ì‹œ ì•„ë˜ ê²°ê³¼ë¬¼ ë€ì— ìº¡ì²˜ ì²¨ë¶€)"></textarea><div class="markdown-preview prose max-w-none"></div></div></div>
                    <div>
                        <h3 class="block text-lg font-semibold mb-2">5. íƒêµ¬ ê²°ê³¼ë¬¼ (ì‹œë®¬ë ˆì´ì…˜ ìº¡ì²˜ ë“±)</h3>
                        <div class="grid md:grid-cols-2 gap-6 bg-gray-50 p-4 rounded-lg">
                            <div>
                                <h4 class="font-medium mb-2 text-center">ì‚¬ì§„ ë˜ëŠ” ìº¡ì²˜ ìë£Œ</h4>
                                <div class="border rounded-lg p-2 bg-white min-h-[150px] flex items-center justify-center screenshot-container"><img id="screenshot-preview-3" alt="ê²°ê³¼ë¬¼ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸°" class="max-w-full max-h-64 rounded-md hidden"><span id="screenshot-placeholder-3" class="text-slate-500">ê²°ê³¼ë¬¼ ì‚¬ì§„ ì²¨ë¶€</span></div>
                                <div class="mt-2 image-upload-ui text-center print-hidden"><input type="file" accept="image/*" onchange="previewMedia(event, 3)" class="hidden" id="screenshot-input-3"><label for="screenshot-input-3" class="file-upload-label">ì´ë¯¸ì§€ ì„ íƒ</label></div>
                            </div>
                            <div>
                                <h4 class="font-medium mb-2 text-center">ì½”ë“œ ë˜ëŠ” GeoGebra ë§í¬</h4>
                                <div class="editable-container">
                                    <textarea id="inquiry-code" class="markdown-input editable-field font-mono text-sm" placeholder="ê²°ê³¼ë¬¼ì— í•´ë‹¹í•˜ëŠ” ì½”ë“œë‚˜ ë§í¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”."></textarea>
                                    <div class="markdown-preview prose max-w-none"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div><label for="inquiry-conclusion" class="block text-lg font-semibold mb-2">6. ê²°ë¡  ë° ê³ ì°°</label><div class="editable-container"><textarea id="inquiry-conclusion" class="markdown-input editable-field" placeholder="íƒêµ¬ ê²°ê³¼ì™€ ê·¸ë¡œë¶€í„° ì–»ì€ ê²°ë¡ ì„ ì‘ì„±í•˜ì„¸ìš”. ì´ˆê¸° ê°€ì„¤ê³¼ ë¹„êµí•˜ì—¬ ë¶„ì„í•˜ê³ , íƒêµ¬ì˜ ì˜ì˜ì™€ í•œê³„ì ì„ ì„œìˆ í•˜ì„¸ìš”."></textarea><div class="markdown-preview prose max-w-none"></div></div></div>
                    <div><label for="inquiry-future" class="block text-lg font-semibold mb-2">7. í›„ì† ì—°êµ¬ ì œì•ˆ</label><div class="editable-container"><textarea id="inquiry-future" class="markdown-input editable-field" placeholder="ì´ íƒêµ¬ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë” ì§„í–‰í•´ë³´ê³  ì‹¶ì€ í›„ì† ì—°êµ¬ë‚˜ ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ ì œì•ˆí•˜ì„¸ìš”."></textarea><div class="markdown-preview prose max-w-none"></div></div></div>
                </div>
            </div>
        </section>

        <!-- Step 6: References -->
        <section id="step6" class="mb-16">
            <div class="step-card bg-white p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold mb-4 border-b-2 border-gray-300 pb-2">Step 6: ì°¸ê³  ë¬¸í—Œ</h2>
                <p class="mb-6 text-gray-600">
                    ë³´ê³ ì„œ ì‘ì„± ë° íƒêµ¬ ê³¼ì •ì—ì„œ ì°¸ê³ í•œ ëª¨ë“  ìë£Œ(ë…¼ë¬¸, ì±…, ì›¹ì‚¬ì´íŠ¸, PDF íŒŒì¼ ë“±)ì˜ ì¶œì²˜ë¥¼ APA ì–‘ì‹ ë˜ëŠ” í•™ê³„ í‘œì¤€ ì–‘ì‹ì— ë§ê²Œ ê¸°ì…í•˜ì„¸ìš”.
                </p>
                <div class="editable-container">
                    <textarea id="references" class="markdown-input editable-field" placeholder="ì˜ˆì‹œ)&#10;* Sharp, J. (1997). The Circular Tractrix and Trudrix. Mathematics in School, 26(1), 10â€“13. http://www.jstor.org/stable/30211783&#10;* Weisstein, Eric W. "Tractrix." From MathWorld--A Wolfram Web Resource. https://mathworld.wolfram.com/Tractrix.html"></textarea>
                    <div class="markdown-preview prose max-w-none"></div>
                </div>
            </div>
        </section>
        
        <footer class="text-center mt-12 print-hidden">
            <div id="validation-message" class="text-red-600 font-semibold mb-4 h-6"></div>
            <button onclick="saveAsPdf()" class="bg-green-600 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-green-700 transition-colors shadow-lg">
                ë³´ê³ ì„œ PDFë¡œ ì €ì¥
            </button>
        </footer>
    </main>
    
    <!-- Autosave Status Indicator -->
    <div id="autosave-status" class="print-hidden fixed bottom-6 right-6 flex items-center bg-slate-800 text-white py-2 px-4 rounded-lg shadow-lg opacity-0 transition-opacity duration-500 z-50">
        <svg id="autosave-icon-saving" class="animate-spin h-5 w-5 mr-3 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        <svg id="autosave-icon-saved" class="h-5 w-5 mr-3 hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
        </svg>
        <span id="autosave-text"></span>
    </div>

    <script>
        const converter = new showdown.Converter({
            ghCodeBlocks: true,
            simpleLineBreaks: true,
            literalMidWordUnderscores: true,
            disableForced4SpacesIndentedSublists: true,
            excludeTrailingPunctuationFromURLs: true
        });
        showdown.setOption('literalMidWordAsterisks', true);

        let saveTimer = null;
        let statusTimer = null;

        // --- AUTOSAVE STATUS UI ---
        function showSaveStatus(state) {
            const statusEl = document.getElementById('autosave-status');
            if (!statusEl) return;
            const textEl = document.getElementById('autosave-text');
            const iconSaving = document.getElementById('autosave-icon-saving');
            const iconSaved = document.getElementById('autosave-icon-saved');

            clearTimeout(statusTimer);
            statusEl.classList.remove('opacity-0');

            if (state === 'saving') {
                textEl.textContent = 'ì €ì¥ ì¤‘...';
                iconSaving.classList.remove('hidden');
                iconSaved.classList.add('hidden');
            } else if (state === 'saved') {
                textEl.textContent = 'ëª¨ë“  ë³€ê²½ì‚¬í•­ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.';
                iconSaving.classList.add('hidden');
                iconSaved.classList.remove('hidden');
                statusTimer = setTimeout(() => {
                    statusEl.classList.add('opacity-0');
                }, 2000); // 2ì´ˆ í›„ ìˆ¨ê¹€
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // KaTeX ìŠ¤í¬ë¦½íŠ¸ê°€ ë¡œë“œëœ í›„ ì˜ì¡´ì„± ìˆëŠ” í•¨ìˆ˜ë“¤ ì‹¤í–‰
            const katexScript = document.querySelector('script[src*="katex.min.js"]');
            const initPage = () => {
                loadContent();
                renderAllMath();
                document.querySelectorAll('.markdown-input').forEach(el => updatePreview(el));
                setupEventListeners();
                setupTractrixSimulation();
            };
            if (window.katex) {
                initPage();
            } else {
                katexScript.onload = initPage;
            }
        });


        function updatePreview(element) {
            const container = element.closest('.editable-container');
            if (!container) return;
            const preview = container.querySelector('.markdown-preview');
            if (!preview) return;

            let markdownText = element.value;
            if (element.id === 'simulation-code' || element.id === 'inquiry-code') {
                const lang = element.value.trim().startsWith('http') ? '' : 'python';
                markdownText = "```" + lang + "\n" + element.value + "\n```";
            }

            // ë³€í™˜ ì „ ì „ì²˜ë¦¬: * í•˜ë‚˜ë¥¼ ì„ì‹œë¡œ ë³´í˜¸
            markdownText = markdownText.replace(/\*([^\*]+)\*/g, 'âš¡ASTERISKâš¡$1âš¡ASTERISKâš¡');

            const placeholder = '<p class="text-slate-400">ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...</p>';
            let html = markdownText ? converter.makeHtml(markdownText) : placeholder;

            // ë³€í™˜ í›„ í›„ì²˜ë¦¬: ì„ì‹œ ë³´í˜¸ ê¸°í˜¸ë¥¼ ë‹¤ì‹œ * ë¡œ ë³µì›
            html = html.replace(/âš¡ASTERISKâš¡/g, '*');

            preview.innerHTML = html;
            renderAllMathInElement(preview);
            if (window.Prism) { Prism.highlightAllUnder(preview); }
        }

        function previewMedia(event, id) {
            const preview = document.getElementById(`screenshot-preview-${id}`);
            const placeholder = document.getElementById(`screenshot-placeholder-${id}`);
            const file = event.target.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const base64Data = e.target.result;
                    
                    // TODO: ë¹„ë””ì˜¤ íŒŒì¼ì¸ ê²½ìš° <video> íƒœê·¸ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ìˆìœ¼ë‚˜,
                    // PDF ì €ì¥ ê¸°ëŠ¥ì„ ê³ ë ¤í•  ë•Œ ì •ì  ì´ë¯¸ì§€(ìº¡ì²˜)ë¥¼ ê¶Œì¥í•˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” <img>ë¡œ í†µì¼í•©ë‹ˆë‹¤.
                    // if (file.type.startsWith('video/')) { ... }
                    
                    preview.src = base64Data;
                    preview.classList.remove('hidden');
                    placeholder.classList.add('hidden');
                    
                    showSaveStatus('saving');
                    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ìš©ëŸ‰ í•œê³„(ì•½ 5MB)ë¡œ ì¸í•´ í° ì´ë¯¸ì§€/ì˜ìƒì€ ì €ì¥ì´ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    try {
                        localStorage.setItem(`screenshot-preview-${id}`, base64Data);
                    } catch (e) {
                        console.error("LocalStorage ì €ì¥ ì‹¤íŒ¨: ", e);
                        alert("íŒŒì¼ì´ ë„ˆë¬´ í½ë‹ˆë‹¤. 1MB ì´í•˜ì˜ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.");
                        preview.src = "";
                        preview.classList.add('hidden');
                        placeholder.classList.remove('hidden');
                    }
                    showSaveStatus('saved');
                }
                reader.readAsDataURL(file);
            }
        }

        function renderAllMath() { if (window.renderMathInElement) { renderMathInElement(document.body, { delimiters: [ {left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}, {left: '\\(', right: '\\)', display: false}, {left: '\\[', right: '\\]', display: true} ] }); } }
        function renderAllMathInElement(el) { if (window.renderMathInElement) { renderMathInElement(el, { delimiters: [ {left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}, {left: '\\(', right: '\\)', display: false}, {left: '\\[', right: '\\]', display: true} ] }); } }

        function saveContent(element) { if (element.id) { localStorage.setItem(element.id, element.value); } }

        function loadContent() {
            document.querySelectorAll('.editable-field').forEach(field => {
                const savedValue = localStorage.getItem(field.id);
                if (savedValue) { field.value = savedValue; }
            });
            // 3ê°œì˜ ì´ë¯¸ì§€ ìŠ¬ë¡¯ ë¡œë“œ
            for (let i = 1; i <= 3; i++) {
                const savedImage = localStorage.getItem(`screenshot-preview-${i}`);
                if (savedImage) {
                    const preview = document.getElementById(`screenshot-preview-${i}`);
                    const placeholder = document.getElementById(`screenshot-placeholder-${i}`);
                    if(preview && placeholder) {
                        preview.src = savedImage;
                        preview.classList.remove('hidden');
                        placeholder.classList.add('hidden');
                    }
                }
            }
        }
        
        function autoResizeTextarea(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = (textarea.scrollHeight) + 'px';
        }

        function setupEventListeners() {
            // í´ë¦­ ì‹œ í¸ì§‘ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
            document.querySelectorAll('.editable-container').forEach(container => {
                const preview = container.querySelector('.markdown-preview');
                const editor = container.querySelector('textarea.markdown-input');

                if (preview && editor) {
                    preview.addEventListener('click', () => {
                        preview.style.display = 'none';
                        editor.style.display = 'block';
                        editor.focus();
                        autoResizeTextarea(editor);
                    });

                    editor.addEventListener('blur', () => {
                        editor.style.display = 'none';
                        preview.style.display = 'block';
                        updatePreview(editor); // blur ì‹œì ì— ìµœì¢… ë Œë”ë§
                    });

                    editor.addEventListener('input', () => {
                        autoResizeTextarea(editor);
                        // ì‹¤ì‹œê°„ ì €ì¥ì„ ìœ„í•´ input ì´ë²¤íŠ¸ ì‚¬ìš©
                        clearTimeout(saveTimer);
                        showSaveStatus('saving');
                        saveTimer = setTimeout(() => {
                            saveContent(editor);
                            showSaveStatus('saved');
                        }, 1200);
                    });
                }
            });

            // input.editable-field ìë™ ì €ì¥
            document.querySelectorAll('input.editable-field').forEach(field => {
                field.addEventListener('input', () => {
                    clearTimeout(saveTimer);
                    showSaveStatus('saving');
                    saveTimer = setTimeout(() => {
                        saveContent(field);
                        showSaveStatus('saved');
                    }, 1200);
                });
            });

            // ëª¨ë°”ì¼ ë©”ë‰´
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            if (mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
                document.querySelectorAll('#mobile-menu a').forEach(link => link.addEventListener('click', () => mobileMenu.classList.add('hidden')));
            }

            // Tractrix ì‹œë®¬ë ˆì´ì…˜ì€ initPage()ì—ì„œ ì´ë¯¸ í˜¸ì¶œë¨

            // íƒ­ ë²„íŠ¼
            document.querySelectorAll('.tab-button').forEach(tab => {
                tab.addEventListener('click', () => {
                    // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
                    tab.parentElement.querySelectorAll('.tab-button').forEach(t => t.classList.remove('active'));
                    // ëª¨ë“  íƒ­ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
                    tab.closest('.border-b').nextElementSibling.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // í´ë¦­ëœ íƒ­ í™œì„±í™”
                    tab.classList.add('active');
                    const tabContent = document.getElementById(tab.dataset.tab);
                    if (tabContent) {
                        tabContent.classList.add('active');
                        // íƒ­ ì „í™˜ ì‹œ ì½”ë“œ í•˜ì´ë¼ì´íŒ… ì¬ì‹¤í–‰
                        if (window.Prism) { Prism.highlightAllUnder(tabContent); }
                    }
                });
            });
        }
        
        function validateForm() {
            let isValid = true;
            const validationMessage = document.getElementById('validation-message');
            
            // í•„ìˆ˜ ì…ë ¥ í•„ë“œ (í•™ë²ˆ, ì´ë¦„)
            ['student-id', 'student-name'].forEach(id => {
                const field = document.getElementById(id);
                field.classList.remove('is-invalid');
                if (field.value.trim() === '') {
                    field.classList.add('is-invalid');
                    isValid = false;
                }
            });
            
            // í•„ìˆ˜ ì´ë¯¸ì§€ (Step 1ì˜ ì²« ë²ˆì§¸ ì´ë¯¸ì§€)
            const imgPreview = document.getElementById(`screenshot-preview-1`);
            const imgContainer = imgPreview.parentElement;
            imgContainer.classList.remove('is-invalid');
            if (imgPreview.classList.contains('hidden')) {
                imgContainer.style.borderColor = 'var(--invalid-color)'; // Tailwind í´ë˜ìŠ¤ ëŒ€ì‹  ì§ì ‘ ìŠ¤íƒ€ì¼ë§
                isValid = false;
            } else {
                 imgContainer.style.borderColor = 'transparent';
            }

            validationMessage.textContent = isValid ? '' : 'í•™ë²ˆ, ì´ë¦„, Step 1ì˜ ì‹¤í—˜ ì‚¬ì§„ì„ ëª¨ë‘ ì²¨ë¶€í•´ì•¼ í•©ë‹ˆë‹¤.';
            if (!isValid) { 
                window.scrollTo({ top: 0, behavior: 'smooth' }); 
            }
            return isValid;
        }

        function saveAsPdf() {
            if (!validateForm()) return;

            // PDF ì €ì¥ ì „ ëª¨ë“  í¸ì§‘ì°½ì„ ë¯¸ë¦¬ë³´ê¸°ë¡œ ì „í™˜
            document.querySelectorAll('.editable-container').forEach(container => {
                const preview = container.querySelector('.markdown-preview');
                const editor = container.querySelector('textarea.markdown-input');
                if (preview && editor) {
                    editor.style.display = 'none';
                    preview.style.display = 'block';
                    updatePreview(editor); // ìµœì¢… ë Œë”ë§ í™•ì¸
                }
            });
            
            // ëª¨ë“  ìˆ˜ì‹/ì½”ë“œ ì¬ë Œë”ë§
            renderAllMath();
            if (window.Prism) { Prism.highlightAll(); }


            // íŒŒì¼ëª… ì„¤ì • (í•™ë²ˆ_ì´ë¦„ í¬í•¨)
            const prevTitle = document.title;
            const studentId = document.getElementById('student-id')?.value.trim() || 'í•™ë²ˆ';
            const studentName = document.getElementById('student-name')?.value.trim() || 'ì´ë¦„';
            document.title = `Tractrixë³´ê³ ì„œ_${studentId}_${studentName}`;

            const cleanup = () => {
                // í¸ì§‘ ëª¨ë“œë¡œ ë³µì›
                document.querySelectorAll('.editable-container').forEach(container => {
                     const preview = container.querySelector('.markdown-preview');
                     const editor = container.querySelector('textarea.markdown-input');
                     if (preview && editor) {
                        // í¸ì§‘ ì¤‘ì´ë˜ ìƒíƒœë¡œ ë³µì›í•˜ì§€ ì•Šê³ , ê¸°ë³¸ 'ë¯¸ë¦¬ë³´ê¸°' ìƒíƒœë¡œ ë‘¡ë‹ˆë‹¤.
                        // editor.style.display = 'block'; // í´ë¦­ ì‹œ í™œì„±í™”ë˜ë¯€ë¡œ ë‹¤ì‹œ ìˆ¨ê¹€
                        // preview.style.display = 'none';
                     }
                });
                document.title = prevTitle;
                window.removeEventListener('afterprint', cleanup);
            };
            window.addEventListener('afterprint', cleanup);

            window.print();
        }

        // --- Tractrix Simulation ---
        // ì™„ì „íˆ ìƒˆë¡œ ì‘ì„±í•œ ì‹œë®¬ë ˆì´ì…˜

        let sim = {
            canvas: null,
            ctx: null,
            L: 100,              // ì¤„ì˜ ê¸¸ì´
            pullerY: 0,          // ë„ëŠ” ì ì˜ Y ìœ„ì¹˜ (yì¶• ìƒì˜ ìœ„ì¹˜)
            isDragging: false,
            path: []             // ê¶¤ì  ì €ì¥
        };

        function setupTractrixSimulation() {
            // ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
            sim.canvas = document.getElementById('tractrixCanvas');
            const lSlider = document.getElementById('l-slider');
            const tSlider = document.getElementById('t-slider');
            const lValue = document.getElementById('l-value');
            const tValue = document.getElementById('t-value');

            if (!sim.canvas || !lSlider || !tSlider) {
                console.error('Tractrix: Required elements not found', {canvas: !!sim.canvas, lSlider: !!lSlider, tSlider: !!tSlider});
                return;
            }

            sim.ctx = sim.canvas.getContext('2d');
            if (!sim.ctx) {
                console.error('Tractrix: Failed to get 2D context');
                return;
            }

            console.log('Tractrix: Canvas size:', sim.canvas.width, 'x', sim.canvas.height);

            // ì´ˆê¸°ê°’ ì„¤ì •
            sim.L = parseFloat(lSlider.value);
            const t_deg = parseFloat(tSlider.value);
            const t_rad = t_deg * Math.PI / 180;
            sim.pullerY = sim.L * Math.log(Math.tan(t_rad / 2));

            console.log('Tractrix: Initial values - L:', sim.L, 't:', t_deg, 'pullerY:', sim.pullerY);

            lValue.textContent = sim.L;
            tValue.textContent = t_deg.toFixed(0) + 'Â°';

            // L ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸
            lSlider.addEventListener('input', (e) => {
                sim.L = parseFloat(e.target.value);
                lValue.textContent = sim.L;
                sim.path = []; // ê²½ë¡œ ì´ˆê¸°í™”
                draw();
            });

            // t ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸ (pullerY ì¡°ì •)
            tSlider.addEventListener('input', (e) => {
                if (sim.isDragging) return;

                const t_deg = parseFloat(e.target.value);
                const t_rad = t_deg * Math.PI / 180;

                // të¡œë¶€í„° pullerY ê³„ì‚°
                // pullerì˜ yì¢Œí‘œ = L * ln(tan(t/2))
                sim.pullerY = sim.L * Math.log(Math.tan(t_rad / 2));

                tValue.textContent = t_deg.toFixed(0) + 'Â°';
                sim.path = []; // ê²½ë¡œ ì´ˆê¸°í™”
                draw();
            });

            // ë§ˆìš°ìŠ¤ ë“œë˜ê·¸ ì´ë²¤íŠ¸
            sim.canvas.addEventListener('mousedown', onMouseDown);
            sim.canvas.addEventListener('mousemove', onMouseMove);
            sim.canvas.addEventListener('mouseup', onMouseUp);
            sim.canvas.addEventListener('mouseleave', onMouseUp);

            // í„°ì¹˜ ì´ë²¤íŠ¸
            sim.canvas.addEventListener('touchstart', onTouchStart, {passive: false});
            sim.canvas.addEventListener('touchmove', onTouchMove, {passive: false});
            sim.canvas.addEventListener('touchend', onMouseUp);

            // ì´ˆê¸° ê·¸ë¦¬ê¸°
            console.log('Tractrix: Initial draw');
            draw();
        }

        function getCanvasCoords(evt) {
            const rect = sim.canvas.getBoundingClientRect();
            let clientX, clientY;

            if (evt.touches && evt.touches.length > 0) {
                clientX = evt.touches[0].clientX;
                clientY = evt.touches[0].clientY;
            } else {
                clientX = evt.clientX;
                clientY = evt.clientY;
            }

            return {
                x: clientX - rect.left,
                y: clientY - rect.top
            };
        }

        function onMouseDown(evt) {
            const pos = getCanvasCoords(evt);
            const centerX = sim.canvas.width / 2;
            const centerY = sim.canvas.height / 2;

            // yì¶• ìƒì˜ ë„ëŠ” ì  ìœ„ì¹˜ (ìº”ë²„ìŠ¤ ì¢Œí‘œ)
            const pullerCanvasY = centerY - sim.pullerY;

            // í´ë¦­ì´ ë„ëŠ” ì  ê·¼ì²˜ì¸ì§€ í™•ì¸ (20px ë°˜ê²½)
            const dist = Math.sqrt(Math.pow(pos.x - centerX, 2) + Math.pow(pos.y - pullerCanvasY, 2));

            if (dist < 20) {
                sim.isDragging = true;
                sim.canvas.classList.add('grabbing');
                sim.path = []; // ìƒˆë¡œìš´ ë“œë˜ê·¸ ì‹œì‘ ì‹œ ê²½ë¡œ ì´ˆê¸°í™”
            }
        }

        function onTouchStart(evt) {
            evt.preventDefault();
            onMouseDown(evt);
        }

        function onMouseMove(evt) {
            if (!sim.isDragging) return;

            const pos = getCanvasCoords(evt);
            const centerY = sim.canvas.height / 2;

            // ë§ˆìš°ìŠ¤ Yì¢Œí‘œë¥¼ ìˆ˜í•™ì  Yì¢Œí‘œë¡œ ë³€í™˜
            sim.pullerY = centerY - pos.y;

            // pullerYë¡œë¶€í„° t ê³„ì‚°
            let t_rad = 2 * Math.atan(Math.exp(sim.pullerY / sim.L));
            t_rad = Math.max(0.1, Math.min(Math.PI - 0.1, t_rad));

            // t ìŠ¬ë¼ì´ë” ì—…ë°ì´íŠ¸
            const t_deg = t_rad * 180 / Math.PI;
            document.getElementById('t-slider').value = t_deg;
            document.getElementById('t-value').textContent = t_deg.toFixed(0) + 'Â°';

            // ê¶¤ì ì— í˜„ì¬ ë¬¼ì²´ ìœ„ì¹˜ ì¶”ê°€
            const obj = calculateObjectPos(sim.pullerY, sim.L);
            sim.path.push(obj);

            // ê²½ë¡œê°€ ë„ˆë¬´ ê¸¸ë©´ ì•ë¶€ë¶„ ì œê±°
            if (sim.path.length > 1000) {
                sim.path.shift();
            }

            draw();
        }

        function onTouchMove(evt) {
            evt.preventDefault();
            onMouseMove(evt);
        }

        function onMouseUp() {
            sim.isDragging = false;
            sim.canvas.classList.remove('grabbing');
        }

        // pullerYë¡œë¶€í„° ë¬¼ì²´ì˜ ìœ„ì¹˜ ê³„ì‚°
        function calculateObjectPos(pullerY, L) {
            // t = 2 * atan(exp(pullerY / L))
            const t = 2 * Math.atan(Math.exp(pullerY / L));

            // ë¬¼ì²´ì˜ ìˆ˜í•™ì  ì¢Œí‘œ
            // x = L * sin(t)
            // y = L * (cos(t) + ln(tan(t/2))) = L * cos(t) + pullerY
            const x = L * Math.sin(t);
            const y = L * Math.cos(t) + pullerY;

            return { x, y };
        }

        function draw() {
            if (!sim.ctx || !sim.canvas) {
                console.error('Draw: Canvas or context not initialized');
                return;
            }

            const ctx = sim.ctx;
            const w = sim.canvas.width;
            const h = sim.canvas.height;
            const centerX = w / 2;
            const centerY = h / 2;

            // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
            ctx.clearRect(0, 0, w, h);

            // 1. ì¶• ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#d1d5db';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, h); // yì¶•
            ctx.moveTo(0, centerY);
            ctx.lineTo(w, centerY); // xì¶•
            ctx.stroke();

            // 2. í˜„ì¬ ìƒíƒœ ê³„ì‚°
            const obj = calculateObjectPos(sim.pullerY, sim.L);

            // ìˆ˜í•™ ì¢Œí‘œë¥¼ ìº”ë²„ìŠ¤ ì¢Œí‘œë¡œ ë³€í™˜
            const pullerCanvasX = centerX;
            const pullerCanvasY = centerY - sim.pullerY;
            const objCanvasX = centerX + obj.x;
            const objCanvasY = centerY - obj.y;

            // 3. ì €ì¥ëœ ê¶¤ì  ê·¸ë¦¬ê¸° (ë…¹ìƒ‰)
            if (sim.path.length > 1) {
                ctx.strokeStyle = 'rgba(22, 163, 74, 0.8)';
                ctx.lineWidth = 3;
                ctx.beginPath();

                // ì˜¤ë¥¸ìª½ ê¶¤ì 
                for (let i = 0; i < sim.path.length; i++) {
                    const px = centerX + sim.path[i].x;
                    const py = centerY - sim.path[i].y;
                    if (i === 0) ctx.moveTo(px, py);
                    else ctx.lineTo(px, py);
                }
                ctx.stroke();

                // ì™¼ìª½ ëŒ€ì¹­ ê¶¤ì 
                ctx.beginPath();
                for (let i = 0; i < sim.path.length; i++) {
                    const px = centerX - sim.path[i].x;
                    const py = centerY - sim.path[i].y;
                    if (i === 0) ctx.moveTo(px, py);
                    else ctx.lineTo(px, py);
                }
                ctx.stroke();
            }

            // 4. ì¤„ ê·¸ë¦¬ê¸° (ë¹¨ê°„ìƒ‰)
            ctx.strokeStyle = '#ef4444';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(pullerCanvasX, pullerCanvasY);
            ctx.lineTo(objCanvasX, objCanvasY);
            ctx.stroke();

            // ëŒ€ì¹­ ì¤„
            ctx.beginPath();
            ctx.moveTo(pullerCanvasX, pullerCanvasY);
            ctx.lineTo(centerX - obj.x, objCanvasY);
            ctx.stroke();

            // 5. ë„ëŠ” ì  ê·¸ë¦¬ê¸° (íŒŒë€ìƒ‰)
            ctx.fillStyle = '#3b82f6';
            ctx.beginPath();
            ctx.arc(pullerCanvasX, pullerCanvasY, 8, 0, 2 * Math.PI);
            ctx.fill();

            // 6. ë¬¼ì²´ ê·¸ë¦¬ê¸° (ë¹¨ê°„ìƒ‰)
            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.arc(objCanvasX, objCanvasY, 6, 0, 2 * Math.PI);
            ctx.fill();

            // ëŒ€ì¹­ ë¬¼ì²´
            ctx.fillStyle = 'rgba(239, 68, 68, 0.5)';
            ctx.beginPath();
            ctx.arc(centerX - obj.x, objCanvasY, 6, 0, 2 * Math.PI);
            ctx.fill();
        }

    </script>
</body>
</html>

