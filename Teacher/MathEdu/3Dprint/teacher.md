# [교사용 자료] 미분·적분으로 최적화하는 3D 프린터(=CNC)의 궤적: 직선의 한계를 넘어

> **수업 핵심 한 줄**: “곡선(연속)을 기계(이산)가 따라가려면, 오차·속도·가속도·저크(=가속도의 변화율)를 **수학적으로 제한**해야 한다.”

---

## 0. 교사 메모: 이 수업이 ‘진짜’인 이유(공학적 사실관계)

* **CAM의 곡선 → 수많은 G01 직선**으로 쪼개면, 허용오차를 줄이기 위해 선분 수가 급증하고 **G-code 파일이 커져** 전송·처리 병목이 생깁니다. 처리 속도가 따라가지 못하면 기계가 “시작-정지”를 반복하며(논문 표현: *machine gun fashion*) 경로 오차가 커집니다. 또한 선분 사이에서 **속도 방향이 불연속**이라 진동이 커집니다. 
* 대안은 **NURBS 보간(G06.2 등)**: 직선 끝점 대신 **제어점·가중치·매듭**을 전달해, 제어기가 **실시간으로 다음 점을 계산**합니다. 
* 실시간 보간의 수학적 뼈대: **(2차) 테일러 전개로 매개변수 (u) 업데이트**, 그리고 **현 오차(chord error) 제한을 위한 속도 저감 규칙**.  

---

## 1. 수업 목표(교사용)

### 지식/이해

1. 곡선을 직선으로 근사할 때 생기는 **현 오차**를 기하+근사로 유도한다.
2. 매개변수 곡선에서 **속도 (V=\frac{ds}{dt})** 와 **(u) 업데이트**를 연쇄법칙으로 연결한다.
3. **곡률반경 (\rho)** 가 작을수록(급커브일수록) 허용속도가 줄어드는 이유를 수식으로 설명한다.

### 과정/기능

* 실험(아날로그) → 모델링(추상화) → 시뮬레이션(GeoGebra/Python) → 조건 맞춤 → 검증(실험 vs 시뮬) → 수식화 → 추가질문.

### 태도/가치

* “정밀도”는 무조건 최대가 아니라 **비용(계산/데이터)과의 최적화**임을 체감.

---

## 2. 준비물/환경(저비용 & 쇼츠 감성 버전)

### 오프라인(1차시)

* 모눈종이(A4), 자, 컴퍼스(또는 원형 물체), 펜, 스톱워치
* (선택) 스마트폰 가속도 센서 앱(무료) + 펜에 테이프로 고정(“손목 진동” 계측 쇼츠용)

### 온라인(2~4차시)

* GeoGebra(웹) 또는 Python(Colab 가능)
* (선택) 3D 프린터가 있으면 최고지만, **없어도 수업 성립**(종이/시뮬로 충분)

---

## 3. 차시별 지도안(교사용 상세)

---

# 1차시 (50’) 실험 & 관찰: “직선으로 곡선을 흉내 내면 왜 덜컹거릴까?”

## A. 도입(8’)

* 질문: “CAD의 매끈한 원이 CAM에선 왜 ‘각진 다각형’이 될까?”
* 핵심 사실 소개: 직선 근사(G01)는 공차를 만족시키려면 선분 수가 커져 **데이터 폭증** → 처리 병목 → 진동/품질 저하. 

## B. 실험(20’) “인간 CNC 실험”

* 반지름 (R=5\text{ cm}) 원을 만들고,

  * **Case A**: 6점(정육각형) 연결
  * **Case B**: 36점(정36각형) 연결
* 규칙: “꼭짓점에서 멈추지 말고 일정 속도로 그리기”
* (선택) 스마트폰을 펜에 붙여 **가속도 로그** 수집(쇼츠 포인트: “정36각형이 더 흔들린다?”)

## C. 관찰 기록(10’)

* 관찰1: 원과 다각형 사이 최대 간격(현 오차)이 어디서 가장 큰가? (각 선분의 중점)
* 관찰2: 꼭짓점 부근에서 손이 ‘튄다’ → 속도 벡터 방향이 급변
* 교사 코멘트(물리): 속도 방향이 급변하면 (\Delta t \to 0)에서 (\vec a=\frac{\Delta \vec v}{\Delta t})가 커지고, 그 변화율(저크)이 커진다.

## D. 정리(12’)

* 다음 시간 예고: “곡선을 ‘점 잔뜩’이 아니라, **제어점 몇 개로** 정의할 수 있다(NURBS).”

---

# 2차시 (50’) 단순화 & 시뮬레이션: “곡선을 압축해서 보내자—NURBS”

## A. 도입(5’)

* “사진(비트맵) vs 벡터(수식)” 은유로 진입.

## B. 핵심 개념(15’) NURBS 정의(필수 수식)

* NURBS 곡선(차수 (p))은 제어점 (P_i), 가중치 (w_i), 기저함수 (N_{i,p}(u))로
  [
  C(u)=\frac{\sum_{i=0}^{n}N_{i,p}(u)w_iP_i}{\sum_{i=0}^{n}N_{i,p}(u)w_i},\quad a\le u\le b
  ]
* 그리고 (N_{i,p})는 매듭벡터 위에서 재귀적으로 정의됩니다. 
* **교사 포인트**: “제어점 1개 움직이면 전체가 아니라 ‘근처’만 변하는 국소성”이 데이터 압축의 핵심.

## C. GeoGebra 활동(25’)

### 활동 2-1: “직선 근사 오차가 (1/n^2)로 줄어드는가?”

* 원을 그리고 (n)개 점을 찍어 다각형 생성
* (n)을 10, 20, 40…로 바꾸며 **최대 현 오차** 기록
* (교사용 팁) 학생들이 로그-로그 그래프(선형회귀)를 하면 “기울기 (-2)”가 나오는지 확인 가능 → 통계 연결.

### 활동 2-2: “가중치 (w_i)가 커지면 곡선이 끌려온다”

* 제어점 드래그 + 특정 점 가중치만 증가(가능한 환경에서)
* 관찰 기록: 곡선이 제어점 쪽으로 ‘흡인’되는 정도

## D. 정리(5’)

* “다음 시간엔 ‘오차’를 적분/근사로 공식화한다.”

---

# 3차시 (50’) 조건 비교 & 수식화 1: “현 오차를 ‘증명’하자”

## A. 도입(5’)

* 1차시에서 관찰한 “원-다각형 사이 최대 간격”을 **정의**: 현 오차(chord error).

## B. **현 오차의 엄밀 유도**(20’) — 교사용 판서 흐름 포함

### (1) 정확식(기하)

곡률반경 (R)인 원호를 길이 (L)인 현으로 근사할 때, 현의 중점에서의 최대 오차 (e)는
[
e = R-\sqrt{R^2-\left(\frac{L}{2}\right)^2}
=R\left(1-\sqrt{1-\frac{L^2}{4R^2}}\right).
]

### (2) 근사(미적분/급수)

(x=\frac{L^2}{4R^2}\ll1)에서
[
\sqrt{1-x}=1-\frac{x}{2}-\frac{x^2}{8}+O(x^3)
]
이므로
[
e = R\Big(\frac{x}{2}+\frac{x^2}{8}+O(x^3)\Big)
= \frac{L^2}{8R}+\frac{L^4}{128R^3}+O!\left(\frac{L^6}{R^5}\right).
]
따라서 1차 근사로
[
\boxed{e\approx \frac{L^2}{8R}}.
]

* **오차항 해석(교사용 한 줄)**: (L)이 작을수록 근사가 급격히 정확해지고, 남는 오차는 (O(L^4)).

### (3) 공학 변수 연결

한 보간 주기 (T) 동안 속력 (V_s)로 이동하면 (L\approx V_sT).
즉
[
\boxed{e \approx \frac{(V_sT)^2}{8R}}.
]
이 결과는 NURBS 실시간 보간 논문에서 동일한 형태로 정리됩니다. 

## C. 곡선 길이(적분) 연결(15’)

* “직선 잔뜩 이어붙이기”는 곡선 길이를 구분구적법으로 근사하는 것과 동일:
  [
  S=\lim_{n\to\infty}\sum_{k=1}^n\sqrt{(\Delta x_k)^2+(\Delta y_k)^2}
  =\int_a^b\sqrt{\left(\frac{dx}{du}\right)^2+\left(\frac{dy}{du}\right)^2},du.
  ]
* **수업 포인트**: 수학은 (n\to\infty)로 보내지만, 공학은 공차에서 멈춘다(최적화).

## D. 정리(10’)

* 다음 시간: “그럼 (u)를 어떻게 업데이트해서 ‘다음 점’을 실시간으로 찍나?”

---

# 4차시 (50’) 수식화 2 & 확장: “테일러 전개로 다음 좌표 예측 + 저크 제한”

## A. 도입(5’)

* “제어기는 매 (T)초마다 다음 점을 계산해야 한다.”

## B. **실시간 (u) 업데이트의 유도(핵심 증명)**(25’)

### (1) 속도와 연쇄법칙

곡선 (C(u))에서 속력 (V_s=\frac{ds}{dt}).
미분기하에서
[
\frac{ds}{du}=|C'(u)|
\Rightarrow
V_s=\frac{ds}{dt}=\frac{ds}{du}\frac{du}{dt}=|C'(u)|\frac{du}{dt}.
]
따라서
[
\boxed{\frac{du}{dt}=\frac{V_s}{|C'(u)|}}
]
는 논문 식으로도 제시됩니다. 

### (2) 2차 테일러 전개

[
u_{k+1}=u_k + T\frac{du}{dt}+\frac{T^2}{2}\frac{d^2u}{dt^2}+\varepsilon.
]
논문은 (\frac{du}{dt}), (\frac{d^2u}{dt^2})를 (C'(u),C''(u))로 정리해 **2차 업데이트 공식**을 제공합니다. 

> **교사 운영 팁(난이도 조절)**
>
> * 기본반: 1차(오일러 형태) (u_{k+1}\approx u_k+T\frac{V_s}{|C'(u_k)|})까지만.
> * 심화반: 2차 항까지 포함(논문 식 (10))을 그대로 구현해 비교.

### (3) 곡률반경(급커브 판정)

곡률반경은(3D 일반형)
[
\boxed{\rho=\frac{|C'(u)|^3}{|C'(u)\times C''(u)|}}
]
로 계산되며 논문에 제시됩니다. 

## C. **현 오차 제한 → 속도 제한 법칙**(10’)

현 오차 근사 (e\approx\frac{(V_sT)^2}{8\rho})에 대해 (e\le e_{\max})면
[
\boxed{V_s\le \frac{1}{T}\sqrt{8\rho,e_{\max}}}.
]
논문은 동일 아이디어로 “(\rho)가 임계값보다 작으면 속도 저감” 규칙을 제안합니다. 

## D. 저크 제한과 S-curve(10’) — 미적분으로 ‘부드러운 기계’ 만들기

* 저크 (J=\frac{da}{dt}).
* **저크를 일정하게** 두면(구간별 상수)
  [
  a(t)=a_0+Jt,\quad
  v(t)=v_0+a_0t+\frac12Jt^2,\quad
  s(t)=s_0+v_0t+\frac12a_0t^2+\frac16Jt^3.
  ]
* Hui 논문은 look-ahead 기반 **S-shaped 가감속**을 채택하고, “가속도와 저크를 적분해 각 구간의 속도식을 얻는다”고 명시합니다. 

---

## 4. (별첨) 교사용 “증명/풀이” 패키지

### 별첨 A: 현 오차 근사에서 **오차항까지** 보여주기(수업 깊이 상승용)

* 위에서 이미
  [
  e=\frac{L^2}{8R}+\frac{L^4}{128R^3}+O(L^6/R^5)
  ]
  까지 얻었으므로,
* 학생 질문 대응:

  * “왜 (n)을 2배로 늘리면 오차가 4배 줄어드나요?”
    원에서 한 변 길이 (L\sim \frac{2\pi R}{n}) 이므로 (e\sim \frac{L^2}{8R}\sim \frac{1}{n^2}).

### 별첨 B: “속도 불연속 → 가속도 폭증”을 수식으로 정리(짧고 강력)

* 꼭짓점에서 속도 벡터 방향이 (\Delta \theta)만큼 바뀌면, 속력 (V) 일정일 때
  [
  |\Delta \vec v| = 2V\sin\left(\frac{\Delta\theta}{2}\right).
  ]
  보간시간이 매우 작으면 (|\vec a|\approx \frac{|\Delta\vec v|}{\Delta t})가 커지고, 저크 제한 필요성이 자연스럽게 등장.

---

## 5. 평가 설계(교사용 루브릭)

| 요소       | 상                                 | 중         | 하             |
| -------- | --------------------------------- | --------- | ------------- |
| 수학적 모델링  | 현 오차를 정확식→근사식→오차항까지 해석            | 근사식 유도까지  | 식을 외우거나 단편 적용 |
| 시뮬레이션 검증 | 데이터(측정/시뮬)로 (1/n^2) 경향 확인, 근거 제시  | 경향 관찰     | 실행만 하고 해석 없음  |
| 공학적 의사결정 | (e_{\max},T,\rho)로 속도 제한을 설계하고 설명 | 속도 제한식 사용 | 변수 의미 혼동      |
| 의사소통     | 그래프·식·언어가 일관                      | 부분적 명확    | 단편 나열         |

---

## 6. 예상 오개념 & 교정 멘트(교사용)

1. **“점이 많으면 무조건 좋다”**
   → “정확도는 올라가지만 데이터·처리 시간도 같이 올라간다. 공학은 최적화 문제다.” 
2. **“NURBS는 그냥 예쁜 곡선 그리기”**
   → “핵심은 ‘곡선 압축 표현’과 ‘실시간 보간 가능성’이다.” 
3. **“곡률반경은 기하에서만”**
   → “곡률반경은 **속도 제한식**의 핵심 변수다.” 

---

## 7. 확장 탐구(세미나/보고서 주제)

1. **1차 vs 2차 테일러 보간 비교**: 같은 (T)에서 위치 오차가 얼마나 줄어드는가? (논문 식 (10) 구현) 
2. **통계 연결**: 손그림(또는 센서)에서 “꼭짓점 가속도 피크”의 분포(평균/분산) 비교
3. **최적 공차 설계**: (e_{\max})를 반으로 줄이면 가공시간(평균 속도)이 얼마나 늘어나는가?

---

## 8. 참고(수업 근거 문헌: 업로드 자료 기반)

* Quang & Long, *A Method of Real-Time NURBS Interpolation with Confined Chord Error for CNC Systems* — NURBS 정의, 2차 테일러 기반 (u) 업데이트, 현 오차 및 제한식.   
* Hui et al., *Study on the Algorithm for Real-time Interpolation of NURBS Curve and Simulation* — look-ahead S-curve 가감속(저크 제한 관점) 설명. 
* Kanna, *Optimized NURBS Curve Based G-Code Part Program for CNC Systems* (Thesis) — 직선 근사(G01)의 데이터 폭증/속도 불연속/진동 문제 맥락. 
