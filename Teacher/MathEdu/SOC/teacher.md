# 수업 지도안(상세): 쌀/모래 눈사태(Granular Avalanche)로 “자기조직화 임계성(SOC)” 맛보기  
*(실험 → 관찰 → 단순화(추상화) → 시뮬레이션 제작 → 조건 맞추기 → 비교 → 수식화 → 추가질문)*

> 핵심 아이디어: “아주 단순한 규칙 + 느린 구동(slow driving)”만으로 **눈사태 크기 분포가 멱법칙(power law)**처럼 나타날 수 있다.  
> 참고 모델(시뮬레이션 쪽): Amaral & Lauritsen의 1차원 쌀-더미 모델은 눈사태 크기/지속시간 분포에 대해 스케일링 형태를 제시한다. :contentReference[oaicite:0]{index=0}  
> (실험적 맥락을 담은 Nature 논문 PDF도 제공됨. 다만 이 파일은 본문이 이미지 위주라 텍스트 인용이 제한적임.) :contentReference[oaicite:1]{index=1}

---

## 0. 수업 목표(학습 성취)
학생은 다음을 할 수 있다.

1. **관찰 데이터 → 확률분포(상대도수/확률밀도)로 변환**하고, 적절히 정규화할 수 있다.  
2. 눈사태 크기 분포가 멱법칙 \(P(s)\propto s^{-\tau}\) 형태인지 **로그-로그 그래프**로 진단하고, 지수 \(\tau\)를 추정(회귀/구간화)할 수 있다.
3. “복잡한 현상”을 **단순 규칙(추상화)**으로 바꾸고, 그 규칙을 코드로 구현해 **시뮬레이션 데이터**를 만든다.
4. 실험 조건(길이 \(L\), 마찰/입자 형태 등)을 시뮬레이션 파라미터와 연결하고, **실험 vs 시뮬레이션을 분포 수준에서 비교**한다.
5. (심화) 스케일링 가정 \(P(s,L)\sim s^{-\tau}f(s/L^\nu)\)를 이해하고, \(L\) 변화에 따른 컷오프/붕괴(collapse)를 시도한다. :contentReference[oaicite:2]{index=2}

---

## 1. 준비물(저비용/고등학교 친화)
- 투명 플라스틱 파일철/아크릴판 2장 + 간격재(두꺼운 종이/젓가락/스페이서)  
  - “얇은 2D 채널”을 만들기 위함(폭을 좁혀야 관찰이 쉬움)
- 쌀(가능하면 길쭉한 쌀 + 동글동글한 쌀 비교 가능하면 최고)  
- A4 용지/검은 배경지(영상 대비)  
- 스마트폰 1대(상단 고정 촬영) + 삼각대(또는 책 더미로 고정)
- 받침 컵/통(오픈 경계에서 떨어지는 쌀 받기)
- (가능하면) 0.01g 단위 디지털 저울 1대(없으면 “떨어진 쌀 개수”를 영상에서 샘플링)

---

## 2. 전체 차시 구성(권장 4차시, 50분×4)

### 1차시: 실험-관찰(현상 수집)
- 목표: “눈사태 이벤트”를 정의하고 데이터로 기록한다.
- 산출물: 눈사태 크기 시계열 \(\{s_k\}\) 또는 방출 질량 \(\{m_k\}\), 동영상 원본.

### 2차시: 단순화(추상화) + 확률분포 만들기
- 목표: 관찰을 수학적 객체(확률변수, 분포)로 올린다.
- 산출물: 히스토그램(정규화), 로그-로그 플롯, 멱법칙 후보 구간 찾기.

### 3차시: 시뮬레이션 제작(아마랄–로리첸 모델 기반)
- 목표: 1D 규칙 기반 모델을 구현하고 데이터 생성.
- 산출물: 시뮬레이션 \(\{s_k\},\{T_k\},\{m_k\}\) 분포, 지수 추정.

### 4차시: 조건 맞추기 → 비교 → 수식화 → 추가질문
- 목표: 실험과 시뮬레이션의 “같음/다름”을 분포 관점에서 말할 수 있게 한다.
- 산출물: 비교 보고서(분포, 지수, 컷오프), 개선 아이디어, 후속 연구 질문.

---

## 3. (1차시) 실험 설계: “얇은 쌀 더미 + 오픈 경계 방출”
### 3.1 실험 세팅(2D 채널 만들기)
1. 투명판 2장을 평행하게 세우고 간격재로 폭을 **쌀 한두 알 정도 두께**로 맞춘다.  
2. 왼쪽 끝은 막고(벽), 오른쪽 끝은 열어 둔다(오픈 경계).  
3. 스마트폰을 위에서 고정 촬영(흔들림 최소화).

> 왜 2D 채널?  
> 3D 더미는 내부에서 무슨 일이 일어나는지 잘 안 보인다. 얇게 만들면 “표면 + 흐름”이 이벤트 단위로 잡힌다.

### 3.2 “눈사태 이벤트” 정의(학생 합의로 명확히!)
아래 중 하나를 택해 **측정 가능한 확률변수**로 만든다.

- **정의 A(강추, 가장 쉬움): 방출량 \(m\)**  
  오픈 경계로 떨어져 나온 쌀의 **질량(g)** 또는 **개수(알 수)**  
  - 장점: 측정이 싸고 단순, 이벤트가 명확  
  - 단점: “내부 재배치(안 떨어졌지만 크게 움직임)”는 놓칠 수 있음  
- **정의 B(영상 기반): 표면 변화량 \(A\)**  
  프레임 차분으로 “움직인 픽셀 수” 또는 “변화 면적”을 이벤트 크기로 둠  
  - 장점: 내부 재배치 일부 포착 가능  
  - 단점: 영상 처리 난이도 상승

수업에서는 **정의 A로 가고**, 시간이 남는 팀은 정의 B로 심화.

### 3.3 데이터 수집 프로토콜(표준화가 생명)
- 1회 실험:  
  - “한 번에 일정량(예: 티스푼 1/4)”을 **항상 같은 위치**(좌측 상단)에서 떨어뜨림  
  - 한 번 붓고 → 멈춤 → 눈사태 끝날 때까지 기다림(“느린 구동” 유지)
- 이벤트 기록:  
  - 저울을 쓸 경우: 이벤트마다 누적 질량 변화 \(\Delta M\)를 기록해 \(m_k=\Delta M\)  
  - 저울이 없을 경우: 영상에서 “떨어진 쌀 알갱이 수”를 10개 이벤트마다 샘플링(근사)

---

## 4. (2차시) 관찰 → 확률분포(통계)로 올리기
### 4.1 확률변수와 표본
- 표본: \(\{m_1,m_2,\dots,m_N\}\) (또는 \(\{s_k\}\))
- 확률변수 \(M\): “무작위로 고른 눈사태 1개의 방출량”

### 4.2 히스토그램을 “확률분포함수”로 만들기(정규화)
- 구간 \([b_i,b_{i+1})\)로 나누고, 해당 구간에 들어간 개수를 \(n_i\)라 하면  
  - **상대도수**: \(\hat P_i = n_i/N\)  
  - **확률밀도 근사**: \(\hat p(m)\approx \dfrac{n_i}{N\,(b_{i+1}-b_i)}\)

> 멱법칙은 꼬리(tail)를 보려면 “선형 bin”이 불리하다.  
> **로그 bin(예: \(b_i=b_0 a^i\))**을 쓰면 꼬리에서 표본이 덜 비어 보인다.

### 4.3 로그-로그 플롯과 멱법칙 판별(고등학교 수준)
멱법칙 후보:  
\[
p(m)\propto m^{-\alpha}
\quad\Rightarrow\quad
\log p(m)= -\alpha\log m + C
\]
- 로그-로그에서 직선이면 “멱법칙 후보”
- 직선 구간(스케일 구간)을 정하고, 그 구간에서 최소제곱 직선회귀로 \(\alpha\) 추정

### 4.4 미적분 연결 포인트(짧고 강하게)
- 연속형에서 정규화: \(\int_{m_{\min}}^{m_{\max}} p(m)\,dm=1\)  
- 평균이 존재하려면: \(\mathbb E[M]=\int m p(m)\,dm\)가 수렴해야 함  
  - 꼬리가 너무 두꺼우면(지수가 작으면) 평균/분산이 발산하는 “괴상한” 세계가 열린다.  
  - 이게 통계물리에서 재밌는 지점.

---

## 5. (3차시) 단순화(추상화) → 시뮬레이션 제작  
여기서는 Amaral–Lauritsen 1D 모델을 “수업용 버전”으로 쓴다.

### 5.1 모델의 핵심 구조(말로)
- 길이 \(L\)짜리 1차원 격자에 높이 \(h(i)\)를 둔다.
- 항상 \(i=1\)에 곡물을 하나 추가(느린 구동). :contentReference[oaicite:3]{index=3}
- 기울기(국소 경사) \(\Delta h(i)=h(i)-h(i+1)\)가 기준을 넘으면 오른쪽으로 이동(붕괴/완화). :contentReference[oaicite:4]{index=4}
- 중요한 점: 완화 규칙에 **확률 \(p\)**가 들어가 “마찰/메타안정 상태”를 흉내낸다. :contentReference[oaicite:5]{index=5}  
  - \(\Delta h(i)>S_1\)이면 확률 \(p\)로 이동  
  - \(\Delta h(i)>S_2\)이면 무조건 이동(중력에 의해 더는 버팀 불가) :contentReference[oaicite:6]{index=6}  
- 맨 끝 \(i=L\)에서 오른쪽으로 나가면 “방출 이벤트”로 계수한다(실험의 \(m\)과 대응). :contentReference[oaicite:7]{index=7}  

### 5.2 시뮬레이션에서 측정할 변수(실험과 맞추기)
- 눈사태 크기 \(s\): 한 번의 추가 이후 일어난 “이동(탑플링) 횟수”  
- 지속시간 \(T\): 완화가 멈출 때까지의 스텝 수  
- 방출량 \(m\): 경계를 넘어 시스템 밖으로 나간 입자 수

이 모델은 눈사태 크기 분포가  
\[
P(s,L)\sim s^{-\tau}\, f\!\left(\frac{s}{L^\nu}\right)
\]
형태로 스케일링함을 보고한다. :contentReference[oaicite:8]{index=8}  
또 지속시간 분포도 유사한 스케일링을 갖는다. :contentReference[oaicite:9]{index=9}

### 5.3 수업용 의사코드(학생용)
```text
입력: L, S1, S2, p, 총 투입 횟수 Ndrop
초기: h[1..L]=0

반복 drop=1..Ndrop:
  h[1] += 1
  active = {1}  # 또는 경사 변화가 생길 수 있는 주변도 포함

  s=0; T=0; m=0
  while active가 비어있지 않음:
    T += 1
    next_active = 빈집합
    for i in active:
      if i==L: 오른쪽 이웃 높이는 0으로 취급(오픈 경계)
      slope = h[i] - h[i+1]
      if slope > S2: topple
      else if slope > S1: 확률 p로 topple
      else: no-op
      if topple:
        h[i] -= 1
        if i==L: m += 1
        else: h[i+1] += 1
        s += 1
        next_active에 i-1, i, i+1 추가(범위 내)
    active = next_active

  기록: (s, T, m)

---

# 1. 수업 개요

## 1.1 주제

* **쌀 눈사태의 크기 분포는 왜 “정규분포”가 아니라 “멱법칙(power law)”처럼 보일까?**
* **유한 크기(실험 장치 길이 L)**가 분포의 꼬리를 어떻게 자를까? (finite-size cutoff)
* 실험을 **1차원 격자 모델**로 추상화하고, 분포를 **시뮬레이션으로 재현**한 뒤 비교

## 1.2 핵심 개념

* 확률변수/확률밀도함수(PDF), 누적분포/생존함수(CCDF)
* 로그-로그 플롯, 로그 변환
* **멱법칙 분포**와 정규화 상수
* 유한크기 스케일링:
  [
  P(s,L)\sim s^{-\tau} f!\left(\frac{s}{L^\nu}\right)
  ]
  (Amaral–Lauritsen 1D 쌀더미 모델에서 눈사태 크기 (s) 분포가 이런 형태를 따른다고 제시) 
* 보존(질량수지)로부터 나오는 스케일링 관계식(증명 가능)

## 1.3 차시(예시: 4차시)

1. 실험 장치 제작 + 예비 관찰
2. 데이터 수집(영상/질량) + 분포 그리기(PDF/CCDF)
3. 모델 추상화 + 시뮬레이션 구현
4. 지수 추정(MLE) + 데이터 붕괴(data collapse) + 비교/토론

---

# 2. 실험(Experiment)

## 2.1 준비물(저비용)

* 투명 아크릴판/유리판 2장(또는 PET 투명판) + 간격 유지 스페이서(두께 5~10mm 정도)
* 테이프/클립/나사로 고정(“얇은 2D 경사 통로” 만들기)
* 쌀(길쭉한 쌀이 유리), 또는 모래
* 스마트폰(60fps면 충분), 삼각대(없으면 책 탑)
* 받침 통(쌀이 떨어져 나오는 끝에 놓기)
* **주방 저울(0.1g 단위면 충분)**: 눈사태마다 “밖으로 빠져나간 양”을 질량으로 측정 가능

> 포인트: **“한 번에 한 톨(또는 아주 소량)을 천천히 추가”**해야 SOC 조건(천천히 구동, 빠른 이완)에 가까워집니다. Amaral 모델도 “새 곡식을 넣기 전에 눈사태가 끝나도록” 가정합니다. 

## 2.2 장치 구성

* 두 판 사이 간격을 좁게 만들어 **쌀이 사실상 2D 단면에서만 움직이게** 합니다.
* 왼쪽은 “벽”, 오른쪽은 “열린 경계(open boundary)”로 두어 오른쪽 끝에서 곡식이 떨어져 나가게.

(논문 모델도 왼쪽 벽 + 오른쪽 열린 경계 구조를 씁니다.) 

## 2.3 실험 절차(핵심 루프)

1. 장치를 일정 각도로 고정(예: 20°~35° 사이에서 탐색)
2. 왼쪽 가까운 지점에 **한 톨씩(또는 일정한 아주 작은 양씩)** 떨어뜨림
3. 매번 “추가 → 눈사태가 완전히 멈출 때까지 기다림”
4. 각 이벤트(한 번 추가로 유발된 이완)를 1개의 눈사태로 정의
5. 매 눈사태마다 크기 측정(아래 중 하나 또는 병행)

## 2.4 눈사태 크기 (S) 정의(실험에서 가능한 정의 2종)

* **(A) 방출량 기반:** 열린 경계로 밖으로 떨어져 나온 쌀 질량 (\Delta m)
  → (S_m=\Delta m/m_{\text{grain}}) (평균 쌀 1톨 질량으로 환산)
* **(B) 영상 기반:** 프레임 차분으로 “움직인 픽셀 수” 적분
  → (S_v=\sum_t A(t)) (시간별 움직임 면적의 합)

> Amaral 논문에선 눈사태 크기를 여러 방식(전복 횟수 (s), 지속시간 (T), 방출 사건 크기 (m))으로 정의합니다. 
> 우리 수업에선 **(A) 방출량**이 가장 싸고 안정적입니다(영상 처리 난이도↓).

---

# 3. 관찰(Observation)

## 3.1 바로 보이는 현상(정성)

* 대다수는 작은 “사르르”
* 가끔 크게 “우르르”
* 큰 사건은 드물지만 완전히 사라지지 않음(“꼬리”)

## 3.2 데이터 기록 템플릿

각 눈사태 (i=1,\dots,N)에 대해

* 입력: 추가한 쌀(항상 1톨 또는 동일 질량)
* 출력: 방출량 (S_i) (질량/개수/픽셀 등)
* (선택) 지속시간 (T_i)

## 3.3 1차 분석: 히스토그램(PDF)보다 CCDF 권장

멱법칙은 히스토그램 bin 선택에 민감합니다. 그래서 수업에선 **생존함수(CCDF)**를 같이 쓰면 좋아요:

* PDF가 (p(s)\propto s^{-\tau})면,
* CCDF는
  [
  P(S\ge s)=\int_s^\infty p(u),du \propto s^{-(\tau-1)}
  ]
  (증명은 뒤 “수식화”에)

---

# 4. 단순화/추상화(Abstraction)

이제 “쌀알 개별 운동”의 복잡함(마찰, 모양, 걸림)을 버리고, **최소 규칙**만 남깁니다.

## 4.1 1차원 격자(높이 (h(i))) 모델

* 위치 (i=1,2,\dots,L) (길이 (L))
* 각 칸에 쌀 높이 (h(i))가 쌓임
* 국소 기울기(슬로프)
  [
  \Delta h(i)=h(i)-h(i+1)
  ]
* **임계 기울기 두 개** (S_1<S_2)

  * (\Delta h(i)>S_1)이면 “미끄러질 수도/안 미끄러질 수도”
  * (\Delta h(i)>S_2)이면 “무조건 미끄러짐”

이 규칙이 Amaral 모델의 핵심입니다. 

## 4.2 확률 규칙(마찰의 추상화)

* (\Delta h(i)>S_1)이면 확률 (p)로 한 알이 (i\to i+1) 이동
* (\Delta h(i)>S_2)이면 확률 1로 이동(강제)
* (i=L)에서 이동하면 시스템 밖으로 방출(open boundary)

이때 (p)는 “마찰/걸림으로 인해 **안정한 배치가 우연히 형성될 확률**”로 해석됩니다. 

---

# 5. 시뮬레이션 제작(Simulation)

## 5.1 알고리즘(의사코드)

```text
입력: L, S1, S2, p, 총 투입 횟수 N
초기: h[i]=0 (i=1..L)

for n in 1..N:
  h[1] += 1             # deposition at i=1
  avalanche_size = 0
  discharge = 0
  T = 0
  active_set = {1}      # 단순화: 매 스텝마다 전체를 검사해도 됨(고등학교 수업용)

  while exists i with Δh(i) > S1:
    T += 1
    for i=1..L:
      if Δh(i) > S2:
        move(i)
      else if Δh(i) > S1 and rand() < p:
        move(i)

    # move(i): h[i]-=1, h[i+1]+=1 (i<L), i==L이면 discharge+=1
    # move 1회마다 avalanche_size += 1

  기록: s[n]=avalanche_size, m[n]=discharge, T[n]=T
```

> Amaral 논문은 “active column”만 추적하지만(효율↑) 수업은 단순 구현으로 충분합니다. 

## 5.2 파라미터 추천(논문 예시값)

* (S_1=1, S_2=4, p=0.6)이 논문 그림 설명에 등장합니다. 
  수업에선 (p)만 바꿔도 현상이 눈에 띄게 달라져서 탐구 포인트가 됩니다.

---

# 6. 실제 실험 조건 맞추기 + 비교(Validation)

## 6.1 “실험 (L)”을 정하는 방법

* 장치 길이를 자로 재어 **실제 길이(예: 60cm)**로 두고,
* 시뮬레이션의 (L)은 “격자 칸 수”라서 단위가 다름
  → 매핑: 한 칸 길이를 (\ell)로 두고 (L_{\text{phys}}\approx L\ell)

실제로는 (\ell)을 “평균 쌀 길이” 정도로 잡아도 되고, 더 간단히 **(L)을 30/60/120 같이 여러 값으로 시뮬레이션**하고 실험 장치 길이도 2~3종으로 바꿔 **스케일링 경향**을 비교하면 됩니다.

## 6.2 비교해야 할 것(최소 3개)

1. **분포 모양**: CCDF의 log-log 직선성(멱법칙 징후)
2. **꼬리의 컷오프**: (L)이 커지면 큰 눈사태가 더 가능해지는지
3. **스케일링 붕괴(data collapse)**: 적절한 (\tau,\nu)로 곡선들이 포개지는지

Amaral 모델은 눈사태 크기 분포가
[
P(s,L)\sim s^{-t} f_s!\left(\frac{s}{L^n}\right)
]
꼴이라고 제시합니다. 

---

# 7. 수식화 + “증명”(Math & Proof)

아래는 수업에서 **칠판/학습지로 전개 가능한 핵심 증명들**입니다.

---

## 7.1 (정리 1) 멱법칙 PDF의 정규화 상수

### 가정

[
p(s)=C s^{-\tau}\quad (s\in[s_{\min},s_{\max}]),;\tau>1
]

### 목표

( \int_{s_{\min}}^{s_{\max}} p(s),ds=1)로부터 (C) 구하기

### 증명

[
1=\int_{s_{\min}}^{s_{\max}} Cs^{-\tau},ds
=C\left[\frac{s^{1-\tau}}{1-\tau}\right]*{s*{\min}}^{s_{\max}}
=C\frac{s_{\max}^{1-\tau}-s_{\min}^{1-\tau}}{1-\tau}
]
따라서
[
C=\frac{\tau-1}{s_{\min}^{1-\tau}-s_{\max}^{1-\tau}}
]
특히 (s_{\max}\gg s_{\min})이면 (s_{\max}^{1-\tau}\approx 0)라서
[
C\approx (\tau-1)s_{\min}^{\tau-1}
]
(고등 미적분 “거듭제곱 적분”으로 끝)

---

## 7.2 (정리 2) CCDF는 지수가 1만큼 줄어든다

### 가정

(p(s)=Cs^{-\tau}) ((\tau>1))

### 목표

[
P(S\ge s)=\int_s^{s_{\max}} p(u),du \propto s^{-(\tau-1)}
]

### 증명

[
P(S\ge s)=\int_s^{s_{\max}} Cu^{-\tau},du
=C\left[\frac{u^{1-\tau}}{1-\tau}\right]*{s}^{s*{\max}}
=\frac{C}{\tau-1}\left(s^{1-\tau}-s_{\max}^{1-\tau}\right)
]
(s\ll s_{\max})인 구간에서는 (s_{\max}^{1-\tau})가 거의 상수이므로 지배항은 (s^{1-\tau}).
즉,
[
P(S\ge s)\propto s^{-(\tau-1)}.
]
따라서 log-log에서 CCDF의 기울기를 (-\alpha)로 재면 (\tau=\alpha+1).

---

## 7.3 (정리 3) 유한크기 스케일링에서 평균값의 스케일(핵심)

### 가정(Amaral 형태)

[
P(s,L)=A, s^{-\tau} f!\left(\frac{s}{L^\nu}\right)
]
여기서 (f(x))는 (x\gg 1)에서 급격히 감소(컷오프 역할).

(논문 표기: (t=\tau,;n=\nu)) 

### 목표

[
\langle s\rangle \propto L^{\nu(2-\tau)}
]

### 증명

[
\langle s\rangle=\int_0^\infty s,P(s,L),ds
\approx \int s\cdot A s^{-\tau} f!\left(\frac{s}{L^\nu}\right),ds
= A\int s^{1-\tau} f!\left(\frac{s}{L^\nu}\right),ds
]
치환 (x=\frac{s}{L^\nu}\Rightarrow s=L^\nu x,; ds=L^\nu dx):
[
\langle s\rangle
= A\int (L^\nu x)^{1-\tau} f(x), L^\nu dx
= A L^{\nu(2-\tau)} \int x^{1-\tau} f(x),dx
]
적분 (\int x^{1-\tau}f(x),dx)는 (L)에 무관한 상수(스케일링 가정의 핵심).
따라서
[
\boxed{\langle s\rangle \propto L^{\nu(2-\tau)} }.
]

---

## 7.4 (정리 4) (\langle s\rangle = L)이면 (\tau=2-\frac1\nu)

Amaral 논문은 “임계상태에서 평균 전복 횟수 (\langle s\rangle = L)”를 사용해
[
\tau=2-\frac1\nu
]
를 얻는다고 명시합니다. 

### (A) 보존/수지로 (\langle s\rangle=L) 이해하기(수업용 ‘증명 스케치’)

* 한 번의 toppling(전복)은 “쌀 1톨이 오른쪽으로 1칸 이동”입니다. 
* 매 단계(매 눈사태)는 **왼쪽 (i=1)** 에 1톨을 추가합니다. 
* 정상상태(steady state)에서는 장기적으로 “들어온 양 = 나간 양”이므로, 평균적으로 추가된 1톨은 결국 열린 경계로 빠져나가야 합니다. (질량 보존)
* (i=1)에서 (i=L) 바깥으로 나가려면 “오른쪽으로 대략 (L)칸” 이동이 필요합니다.
* 각 이동 1번이 전복 1번이므로, **추가된 1톨당 평균 전복 횟수 (\sim L)**.
* “추가 1번 = 눈사태 1번”이므로 **눈사태 크기(전복 수) 평균도 (\langle s\rangle\sim L)**.

(엄밀한 확률론 증명까지는 아니지만, 고등학교 수업 목표엔 충분히 강력한 논증입니다.)

### (B) 이제 진짜 계산으로 (\tau)–(\nu) 관계식 증명

정리 3에서
[
\langle s\rangle \propto L^{\nu(2-\tau)}
]
인데, (\langle s\rangle \propto L^1)이면 지수 비교로
[
\nu(2-\tau)=1 \quad\Rightarrow\quad
\boxed{\tau=2-\frac{1}{\nu}}
]
이게 논문 식(2)입니다. 

---

## 7.5 (정리 5) 멱지수 (\tau)의 최대우도추정(MLE) 유도(미적분 활용)

현장에서 가장 교육적으로 “깔끔한 미적분”은 이겁니다.

### 가정(연속형 근사)

(s_i\ge s_{\min})인 데이터 (n)개가 있고,
[
p(s|\tau)= (\tau-1)s_{\min}^{\tau-1}, s^{-\tau} \quad (s\ge s_{\min})
]
(정리 1에서 (s_{\max}\to\infty) 근사)

### 로그우도

[
\mathcal{L}(\tau)=\prod_{i=1}^n p(s_i|\tau)
]
[
\ln \mathcal{L}(\tau)=\sum_{i=1}^n \left[\ln(\tau-1)+(\tau-1)\ln s_{\min}-\tau\ln s_i\right]
]
정리하면
[
\ln \mathcal{L}(\tau)
=n\ln(\tau-1)+n(\tau-1)\ln s_{\min}-\tau\sum_{i=1}^n \ln s_i
]

### 미분해서 0으로

[
\frac{d}{d\tau}\ln\mathcal{L}
=\frac{n}{\tau-1}+n\ln s_{\min}-\sum_{i=1}^n \ln s_i
]
0으로 두면
[
\frac{n}{\tau-1}
=\sum_{i=1}^n \ln s_i - n\ln s_{\min}
=\sum_{i=1}^n \ln\left(\frac{s_i}{s_{\min}}\right)
]
따라서
[
\boxed{\hat{\tau}
=1+\frac{n}{\sum_{i=1}^n \ln\left(\frac{s_i}{s_{\min}}\right)}}
]

> 수업 포인트: “미분해서 최댓값 찾기”가 **실제 연구에서 지수 추정에 그대로 쓰인다**는 감동 포인트.

---

# 8. 데이터 붕괴(Data Collapse) 실습(수학적 구현 과제)

Amaral 스케일링 형태  를 따른다면,
[
P(s,L)=s^{-\tau} f!\left(\frac{s}{L^\nu}\right)
]
이므로 양변에 (s^\tau)를 곱하면
[
s^\tau P(s,L) = f!\left(\frac{s}{L^\nu}\right)
]
즉,

* x축을 (x=s/L^\nu)
* y축을 (y=s^\tau P(s,L))

로 바꾸면 (L)이 달라도 한 곡선으로 **포개져야** 합니다.

### 수업 과제

1. (L)을 3개 이상으로 시뮬레이션하여 (P(s,L))를 얻기
2. ((\tau,\nu)) 후보를 여러 개 시험
3. “가장 잘 포개지는” ((\tau,\nu))를 선택
4. 정리 4의 관계 (\tau=2-\frac1\nu)도 함께 검증 

---

# 9. 심화 토론(논문과의 ‘정반합’ 포인트)

## 9.1 합(모델의 성취)

* 단순 확률 규칙만으로도 SOC형 분포와 스케일링이 나온다 
* 보존법칙으로 지수 관계식을 묶어낼 수 있다 

## 9.2 반(현실과의 어긋남)

Amaral 논문은 **자기 모델의 에너지 지수(약 1.53)가 실험(약 2)과 다르다**고 언급하며, 같은 보편성 계(universality class)가 아닐 수 있음을 말합니다. 
→ “현실은 관성/마찰/비국소 효과가 섞여 모델보다 더 복잡하다”

## 9.3 합(수업의 결론 질문)

* “어떤 단순화는 본질을 살리고, 어떤 단순화는 본질을 버린다.”
* 그 경계가 어디인지 **실험–시뮬레이션 비교**로 찾는 게 과학이다.

---

# 10. 추가 질문 리스트(수업 마무리용)

1. (p)를 바꾸면 (\tau,\nu)가 바뀌나? (보편성 vs 비보편성)
2. (S_1,S_2)의 간격이 커지면(“메타안정 구간” 확대) 큰 사건 빈도는? 
3. “쌀 모양(길쭉/둥글)”을 바꾸면 왜 SOC가 깨질까? (관성 임계 크기 (L_c) 논의) 
4. 히스토그램 대신 CCDF를 쓰면 왜 더 안정적인가? (정리 2 재확인)
5. 데이터가 “멱법칙처럼 보임”을 넘어, 어떤 통계 검정(KS test 등)으로 비교할 수 있을까?

---

원하시면, 다음 중 하나를 바로 더 붙여서 완성도를 “연구보고서급”으로 올릴 수 있어요(질문 없이 진행 가능합니다).

* **(A)** 위 시뮬레이션을 실제로 돌리는 **파이썬 코드(수업용/학생용 2버전)** + 로그빈/CCDF/MLE/붕괴까지 한 번에
* **(B)** “방출 질량 (\Delta m)” 데이터를 기준으로, **실험 설계(표본 수, (s_{\min}) 선택법, 오차 전파)**를 더 엄밀히
* **(C)** Amaral 논문에서 추가로 나오는 **지속시간 (T)**, **방출사건 (m)** 분포 스케일링(식 (4), (5))  까지 포함해 4변수 비교 프로젝트로 확장
