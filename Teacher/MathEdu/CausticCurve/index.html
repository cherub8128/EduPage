<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Caustic Curve 탐구 보고서</title>

    <!-- Modern Design System -->
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="stylesheet" href="../css/components/report.css" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/naen-nae/d2coding/d2coding-subset.css">

    <!-- Libs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <style>
        .vis-container {
            background: white;
            border: 1px solid var(--border-light);
            border-radius: var(--radius-lg);
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        canvas {
            max-width: 100%;
            height: auto;
        }
    </style>
</head>

<body>

    <!-- Back Button -->
    <a href="../index.html" class="m-back-btn" aria-label="Back">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
    </a>

    <div class="container pt-lg pb-lg">

        <!-- Header -->
        <header class="modern-header flex justify-between items-end flex-wrap gap-4">
            <div>
                <div class="mb-2">
                    <span class="m-badge" style="background:var(--grad-primary); color:white;">One-Page Report</span>
                </div>
                <h1>Caustic Curve 탐구</h1>
                <p>커피잔 속의 기하학: 반사 광선과 포락선</p>
            </div>
            <div class="flex gap-2 print-hidden">
                <a href="Presentation.html" class="m-btn secondary small text-decoration-none flex items-center">
                    <span>📺 발표 모드</span>
                </a>
                <button id="export-md" class="m-btn secondary small">
                    <span>📝 MD 저장</span>
                </button>
                <button id="export-html" class="m-btn secondary small">
                    <span>🌐 HTML 저장</span>
                </button>
                <button id="export-pdf" class="m-btn primary small">
                    <span>📄 PDF 저장</span>
                </button>
            </div>
        </header>

        <main class="flex flex-col gap-6">

            <!-- Student Info -->
            <section class="m-card">
                <div class="m-grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div>
                        <label for="student-id" class="font-bold text-sm block mb-1">학번</label>
                        <input id="student-id" class="m-input savable" placeholder="예: 30212">
                    </div>
                    <div>
                        <label for="student-name" class="font-bold text-sm block mb-1">이름</label>
                        <input id="student-name" class="m-input savable" placeholder="예: 홍길동">
                    </div>
                </div>
            </section>

            <!-- Navigation -->
            <nav class="flex flex-wrap gap-2 print-hidden">
                <a href="#step1" class="m-badge hover:bg-gray-200 cursor-pointer text-decoration-none">Step 1: 관찰</a>
                <a href="#step2" class="m-badge hover:bg-gray-200 cursor-pointer text-decoration-none">Step 2: 모델링</a>
                <a href="#step3" class="m-badge hover:bg-gray-200 cursor-pointer text-decoration-none">Step 3: 분석</a>
                <a href="#step4" class="m-badge hover:bg-gray-200 cursor-pointer text-decoration-none">Step 4: 심화</a>
            </nav>

            <!-- Step 1: Observation -->
            <section id="step1" class="m-card">
                <h2 class="text-xl font-bold mb-4">Step 1: 현상 관찰 & 문제 발견</h2>

                <div class="m-grid" style="grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem;">
                    <div>
                        <strong class="block mb-2 text-sm text-neutral-600">관찰 예시</strong>
                        <img src="images/cup0.jpg" alt="Example" class="rounded-lg border w-full object-cover h-48">
                    </div>
                    <div>
                        <strong class="block mb-2 text-sm text-neutral-600">나의 관찰 사진</strong>
                        <div id="gallery-drop" class="dropzone p-4">
                            관찰 사진을 추가하세요.
                        </div>
                        <div class="flex gap-2 mt-2">
                            <input id="gallery-input" type="file" accept="image/*" multiple class="hidden">
                            <button id="gallery-add" class="m-btn small secondary"
                                onclick="document.getElementById('gallery-input').click()">+ 추가</button>
                            <button id="gallery-clear" class="m-btn small secondary"
                                onclick="if(confirm('삭제?')) document.getElementById('gallery').innerHTML=''">초기화</button>
                        </div>
                        <div id="gallery" class="gallery-grid"></div>
                    </div>
                </div>

                <div class="mt-4">
                    <label class="font-bold text-sm block mb-2">관찰 내용 기록</label>
                    <div class="editable-container">
                        <textarea id="observations" class="savable markdown-input"
                            placeholder="- 빛이 만드는 무늬는 하트 모양과 비슷하다.&#10;- 뾰족한 부분(cusp)이 생긴다."></textarea>
                        <div class="markdown-preview"></div>
                    </div>
                </div>
            </section>

            <!-- Step 2: Modeling (Reflection) -->
            <section id="step2" class="m-card">
                <h2 class="text-xl font-bold mb-4">Step 2: 반사 광선 모델링</h2>

                <div class="m-grid" style="grid-template-columns: 1fr 1fr; gap: 2rem;">
                    <div class="vis-container">
                        <canvas id="reflectionCanvas" width="400" height="400"></canvas>
                    </div>
                    <div class="flex flex-col gap-4 justify-center">
                        <div>
                            <label class="font-bold text-sm block mb-1">반사점 각도 (\(\theta\))</label>
                            <div class="flex items-center gap-2">
                                <input id="theta-slider" type="range" min="0" max="180" value="135"
                                    class="w-full savable">
                                <span id="theta-value" class="w-12 text-center font-mono text-sm">45°</span>
                            </div>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg text-sm text-neutral-700">
                            <p>▪️ <strong>반사점 P:</strong> \( P(\cos\theta, \sin\theta) \)</p>
                            <p>▪️ <strong>반사각:</strong> 입사각 = 반사각</p>
                        </div>
                    </div>
                </div>

                <div class="mt-6">
                    <label class="font-bold text-sm block mb-2">증명: 반사 광선 방정식 유도</label>
                    <div class="editable-container">
                        <textarea id="proof-writing" class="savable markdown-input"
                            placeholder="반사 법칙을 이용하여 광선의 방정식을 유도해보세요."></textarea>
                        <div class="markdown-preview"></div>
                    </div>
                </div>
            </section>

            <!-- Step 3: Epicycloid -->
            <section id="step3" class="m-card">
                <h2 class="text-xl font-bold mb-4">Step 3: 에피사이클로이드와 포락선</h2>

                <div class="m-grid" style="grid-template-columns: 1fr 1fr; gap: 2rem;">
                    <div class="vis-container">
                        <canvas id="epicycloidCanvas" width="400" height="400"></canvas>
                    </div>
                    <div class="flex flex-col gap-4">
                        <div>
                            <label class="font-bold text-sm block mb-1">뾰족점 개수 (k)</label>
                            <div class="flex items-center gap-2">
                                <input id="k-slider" type="range" min="1" max="10" value="2" step="1"
                                    class="w-full savable">
                                <span id="k-value" class="w-8 text-center font-mono">2</span>
                            </div>
                        </div>
                        <div>
                            <label class="font-bold text-sm block mb-1">크기 (r)</label>
                            <div class="flex items-center gap-2">
                                <input id="size-slider" type="range" min="10" max="50" value="25" step="1"
                                    class="w-full savable">
                                <span id="size-value" class="w-8 text-center font-mono">25</span>
                            </div>
                        </div>
                        <div>
                            <label class="font-bold text-sm block mb-1">생성 각도 (t)</label>
                            <div class="flex items-center gap-2">
                                <input id="epicycloid-slider" type="range" min="0" max="360" value="360"
                                    class="w-full savable">
                                <span id="epicycloid-value" class="w-12 text-center font-mono">360°</span>
                            </div>
                        </div>

                        <div class="p-3 bg-blue-50 text-blue-900 rounded-lg text-sm">
                            <strong>Hint:</strong> 커피잔의 빛 무늬는 \(k=2\)인 에피사이클로이드(Nephroid)입니다.
                        </div>
                    </div>
                </div>
            </section>

            <!-- Step 4: Deep Dive -->
            <section id="step4" class="m-card">
                <h2 class="text-xl font-bold mb-4">Step 4: 심화 탐구 보고서</h2>

                <div class="space-y-4">
                    <div>
                        <label class="font-bold text-sm block mb-1">탐구 주제</label>
                        <input id="inquiry-title" class="m-input savable" placeholder="예: 포물선 거울에서의 포락선">
                    </div>
                    <div>
                        <label class="font-bold text-sm block mb-1">탐구 내용 및 시뮬레이션 코드</label>
                        <div class="editable-container">
                            <textarea id="inquiry-code" class="savable markdown-input font-mono text-sm"
                                placeholder="Python/GeoGebra 코드나 링크를 여기에 작성하세요."></textarea>
                            <div class="markdown-preview"></div>
                        </div>
                    </div>
                    <div>
                        <label class="font-bold text-sm block mb-1">결과 자료 (스크린샷)</label>
                        <div id="results-gallery-drop" class="dropzone p-4">결과 이미지를 추가하세요.</div>
                        <div class="flex gap-2 mt-2">
                            <input id="results-gallery-input" type="file" accept="image/*" multiple class="hidden">
                            <button id="results-gallery-add" class="m-btn small secondary"
                                onclick="document.getElementById('results-gallery-input').click()">+ 추가</button>
                            <button id="results-gallery-clear" class="m-btn small secondary"
                                onclick="if(confirm('삭제?')) document.getElementById('results-gallery').innerHTML=''">초기화</button>
                        </div>
                        <div id="results-gallery" class="gallery-grid"></div>
                    </div>

                    <div>
                        <label class="font-bold text-sm block mb-1">결론</label>
                        <div class="editable-container">
                            <textarea id="inquiry-conclusion" class="savable markdown-input"
                                placeholder="결론 및 제언"></textarea>
                            <div class="markdown-preview"></div>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <footer class="mt-8 text-center text-sm text-muted print-hidden">
            <div id="autosave-status" class="flex items-center justify-center gap-2 opacity-0 transition-opacity">
                <span id="autosave-icon-saving" class="hidden">💾 저장 중...</span>
                <span id="autosave-icon-saved" class="text-green-600 hidden">✅ 저장됨</span>
                <span id="autosave-text"></span>
            </div>
            <p class="mt-4">MathEdu Project 2025.</p>
        </footer>

    </div>

    <!-- Logic -->
    <script type="module" src="script.js"></script>

</body>

</html>