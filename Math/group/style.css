:root {
    /* Modern Dark Theme Palette */
    --bg-color: #1a1b1e; /* 거의 검은색 배경 */
    --panel-bg-color: #242529; /* 패널 배경 */
    --panel-bg-light: #2d2f34; /* 밝은 패널 배경 (테이블 헤더 등) */
    --text-color: #e1e1e6; /* 기본 텍스트 */
    --text-secondary-color: #a9a9b3; /* 보조 텍스트 */
    --primary-color: #00a8e8; /* 주요 색상 (청록색 계열) */
    --primary-hover-color: #00bfff; /* 호버 시 색상 */
    --border-color: #3a3c42; /* 테두리 색상 */
    --shadow-color: rgba(0, 0, 0, 0.2);
    --highlight-bg: rgba(0, 168, 232, 0.15); /* 필터 하이라이트 배경 */
    --highlight-border: rgba(0, 168, 232, 0.5); /* 필터 하이라이트 테두리 */
}

body {
    font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    margin: 0;
    padding: 2rem;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    box-sizing: border-box;
}

.container {
    width: 100%;
    max-width: 1600px;
    background: linear-gradient(145deg, var(--panel-bg-light), var(--panel-bg-color));
    border-radius: 10px;
    box-shadow: 0 10px 40px var(--shadow-color);
    overflow: hidden;
    border: 1px solid var(--border-color);
}

header {
    background-color: var(--panel-bg-color);
    color: var(--text-color);
    padding: 20px;
    text-align: center;
    border-bottom: 1px solid var(--border-color);
}

header h1 {
    margin: 0;
    color: var(--text-color);
    font-weight: 600;
    letter-spacing: 1px;
}

main {
    padding: 30px;
}

.controls {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 20px;
    align-items: center;
}

.control-group {
    display: flex;
    align-items: center;
    gap: 8px;
}

.control-group label {
    font-weight: 500;
    color: var(--text-secondary-color);
}

select, button {
    background-color: var(--panel-bg-light);
    color: var(--text-secondary-color);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    padding: 10px 14px;
    font-size: 15px;
    font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    cursor: pointer;
    transition: all 0.2s ease;
}

button {
    background-color: var(--primary-color);
    color: white;
    border: 1px solid var(--primary-color);
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

button:hover {
    background-color: var(--primary-hover-color);
    border-color: var(--primary-hover-color);
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0, 168, 232, 0.2);
}

select:focus, button:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(3, 49, 140, 0.2);
}

/* --- 결과 및 패널 --- */
.output-box {
    background-color: var(--panel-bg-light);
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 1.5rem;
    border: 1px solid var(--border-color);
    font-size: 15px;
    font-family: inherit; /* body의 폰트를 명확하게 상속받도록 수정 */
}

.hidden {
    display: none !important;
}

.content-panel {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
}

.panel {
    background-color: transparent;
    border-radius: 8px;
    padding: 20px;
    border: 1px solid var(--border-color);
}

/* 범례 패널 스타일 */
#abbreviations-panel {
    grid-column: 2 / 3; /* 그래프 패널 아래에 위치 */
    margin-top: 1.5rem;
    background: var(--panel-bg-color);
}

#abbreviations-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 10px;
    font-size: 14px;
}

#abbreviations-list div {
    background-color: var(--panel-bg-light);
    padding: 8px 12px;
    border-radius: 4px;
    color: var(--text-secondary-color);
    word-break: break-all;
}

/* 테이블 컨테이너를 flex로 설정하여 내부 요소 크기 제어 */
#table-container {
    display: flex;
    flex-direction: column;
    background: var(--panel-bg-color);
    overflow: hidden;
}

h2 {
    margin-top: 0;
    font-weight: 500;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 10px;
    margin-bottom: 20px;
}

.table-controls {
    margin-bottom: 15px;
}

#table-filter {
    width: 100%;
    padding: 10px 14px;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 14px;
    box-sizing: border-box;
    font-family: inherit;
}

input#table-filter {
    background-color: var(--panel-bg-light);
    color: var(--text-secondary-color);
}

/* --- 새로운 케일리 테이블 스타일 --- */

/* 전체 테이블 래퍼 */
#cayley-table-wrapper {
    position: relative; /* 자식 요소의 position 기준 */
    flex-grow: 1; /* #table-container 내에서 남은 공간을 모두 차지하도록 */
    overflow: hidden; /* 내부 스크롤 컨테이너가 래퍼를 넘지 않도록 */
}

/* 데이터 테이블을 감싸는 스크롤 컨테이너 */
.cayley-data-table-container {
    overflow: auto;
    height: 100%; /* 래퍼의 전체 높이를 사용 */
    border: 1px solid var(--border-color);
    border-radius: 6px;
}

/* 데이터 테이블 */
.cayley-data-table {
    border-collapse: collapse;
    font-size: 13px;
    white-space: nowrap;
    table-layout: fixed; /* 셀 너비 고정을 위해 필요 */
}

/* 모든 테이블의 th, td 공통 스타일 */
.cayley-data-table th, .cayley-data-table td {
    border: 1px solid var(--border-color);
    padding: 0; /* 패딩을 제거하고 flex로 중앙 정렬 */
    width: 60px; /* min-width 대신 width를 사용하여 너비 고정 */
    min-width: 60px; /* 최소 너비 보장 */
    height: 40px; /* 모든 셀의 높이를 고정 */
    text-align: center;
    box-sizing: border-box;
    /* KaTeX 렌더링 및 텍스트를 셀 중앙에 위치시키기 위한 flex 속성 추가 */
    display: inline-flex;
    justify-content: center;
    align-items: center;
    transition: background-color 0.2s ease;
}

/* 필터링으로 하이라이트된 셀 */
.cayley-data-table td.highlight {
    background-color: var(--highlight-bg) !important;
}

/* 헤더 테이블의 첫 번째 셀(코너)의 span 스타일 */
.cayley-data-table thead th:first-child span {
    font-size: 1.2em; /* • 문자를 다른 텍스트와 비슷하게 보이도록 크기 조정 */
    line-height: 1;
}

/* 헤더 테이블의 th (가로 헤더) */
.cayley-data-table thead th {
    background-color: var(--panel-bg-light);
    font-weight: 500;
    position: sticky; /* 세로 스크롤 시 상단에 고정 */
    top: 0;
    z-index: 2; /* 좌측 헤더보다 위에 오도록 */
}

/* 좌상단 코너 셀 (가로 및 세로 스크롤 모두에 고정) */
.cayley-data-table thead th:first-child {
    left: 0;
    z-index: 3; /* 다른 모든 헤더 위에 오도록 가장 높은 z-index 부여 */
}

/* 데이터 테이블의 th (세로 헤더) */
.cayley-data-table tbody th {
    background-color: var(--panel-bg-light);
    font-weight: 500;
    position: sticky; /* 가로 스크롤 시 좌측에 고정 */
    left: 0;
    z-index: 1;
}

/* 데이터 테이블 행 호버 효과 */
.cayley-data-table tbody tr:hover {
    background-color: var(--panel-bg-light);
}
.cayley-data-table tbody tr:hover th {
    background-color: var(--panel-bg-light); /* 호버 시에도 sticky 배경색 유지 */
}

/* 데이터 테이블 짝수 행 배경색 */
.cayley-data-table tbody tr:nth-child(even) {
    background-color: var(--panel-bg-color);
}
.cayley-data-table tbody tr:nth-child(even) th {
    background-color: var(--panel-bg-color); /* 짝수 행에도 sticky 배경색 적용 */
}
 
/* 스크롤바 디자인 */
.cayley-data-table-container::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}
.cayley-data-table-container::-webkit-scrollbar-track {
    background-color: #f1f1f1;
    border-radius: 10px;
}
.cayley-data-table-container::-webkit-scrollbar-thumb {
    background-color: #c1c1c1;
    border-radius: 10px;
    border: 2px solid #f1f1f1;
}
.cayley-data-table-container::-webkit-scrollbar-thumb:hover {
    background-color: #a8a8a8;
}

/* KaTeX 렌더링을 위한 스타일 */
.katex-display {
    margin: 0;
}

/* --- 그래프 패널 --- */
#graph-container {
    display: flex; /* 내부 #cayley-graph가 높이를 100% 차지하도록 flex 설정 */
    flex-direction: column;
    background: var(--panel-bg-color);
}

#cayley-graph {
    width: 100%;
    flex-grow: 1; /* #graph-container의 남은 공간을 모두 차지 */
    position: relative;
}

/* D3.js가 생성하는 SVG에 스타일 적용 */
#cayley-graph svg {
    border-radius: 6px;
    background-color: var(--panel-bg-color);
}

/* 그래프 노드(원) 스타일 */
#cayley-graph svg .node circle {
    fill: var(--panel-bg-light); /* 노드 색상을 어둡게 변경 */
    stroke: var(--border-color);
    stroke-width: 1px;
}

/* 그래프 노드 텍스트 가독성 향상 */
#cayley-graph svg .node text {
    fill: var(--text-color); /* 텍스트 색상을 밝게 변경 */    
}


/* 그래프 컨트롤 버튼 스타일 */
.graph-controls {
    margin-bottom: 15px;
    display: flex;
    gap: 10px;
    justify-content: center; /* 버튼들을 중앙에 배치 */
}

.graph-controls button {
    padding: 8px 12px;
    font-size: 14px;
    background-color: var(--panel-bg-light);
    color: var(--text-secondary-color);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    cursor: pointer;
}

/* 기존 버튼 호버 스타일 재활용 */
.graph-controls button:hover {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
    color: white;
}

/* --- 모바일 최적화 --- */
@media (max-width: 1024px) {
    body {
        padding: 1rem;
    }
    main {
        padding: 15px;
    }
    .content-panel {
        grid-template-columns: 1fr; /* 1열 레이아웃으로 변경 */
    }
    #graph-container {
        grid-row: 1; /* 그래프를 첫 번째 행으로 */
        min-height: 400px; /* 모바일에서 그래프 높이 확보 */
        overflow-x: hidden; /* 혹시 모를 가로 스크롤바 방지 */
    }
    #cayley-graph svg {
        /* SVG가 부모 컨테이너 너비에 맞게 크기 조절되도록 설정 */
        width: 100%;
        height: auto;
        max-width: 100%;
    }
    #table-container {
        grid-row: 2; /* 테이블을 두 번째 행으로 */
    }
    #abbreviations-panel {
        grid-column: 1 / -1; /* 전체 너비 차지 */
    }
}
