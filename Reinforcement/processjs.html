<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS/WebSocket ê¸°ë°˜ AI ê²Œì„ ì œì‘ ê°€ì´ë“œ (ë‹¤ì¤‘ íŒŒì¼)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .step { scroll-margin-top: 80px; }
        .prompt-block, .code-block-provided { position: relative; }
        .copy-button { position: absolute; top: 0.8rem; right: 0.8rem; background-color: #4A5568; color: white; padding: 0.25rem 0.6rem; border-radius: 0.375rem; font-size: 0.8rem; cursor: pointer; transition: background-color 0.2s; }
        .copy-button:hover { background-color: #2D3748; }
        .copy-button.copied { background-color: #2F855A; }
        .user-input { background-color: #FEF3C7; border: 1px dashed #FBBF24; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; }
        .download-section { background-color: #F0F9FF; border: 1px solid #BAE6FD; padding: 1.5rem; border-radius: 0.5rem; margin-top: 1rem; }
        .download-btn { background-color: #0284C7; color: white; font-weight: bold; padding: 0.5rem 1rem; border-radius: 0.375rem; transition: background-color 0.2s; text-decoration: none; display: inline-block; }
        .download-btn:hover { background-color: #0369A1; }
        .modal-card { transition: transform 0.2s, box-shadow 0.2s; }
        .modal-card:hover { transform: translateY(-4px); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }
        .tab-button { padding: 0.5rem 1rem; cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.2s; }
        .tab-button.active { border-color: #F59E0B; color: #1E293B; font-weight: 600; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div id="theme-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col">
            <div class="p-5 border-b flex justify-between items-center sticky top-0 bg-white rounded-t-2xl">
                <h2 class="text-xl font-bold text-slate-800">ì¶”ì²œ ê²Œì„ ì£¼ì œ (í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì—¬ í”„ë¡¬í”„íŠ¸ë¥¼ ë³µì‚¬í•˜ì„¸ìš”)</h2>
                <button id="close-modal-btn" class="text-3xl font-light text-slate-500 hover:text-slate-800">&times;</button>
            </div>
            <div id="theme-grid" class="p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 overflow-y-auto">
                </div>
        </div>
    </div>

    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-4xl">
        <header class="text-center my-8 md:my-12">
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold text-slate-900">JS/WebSocket ê¸°ë°˜ AI ê²Œì„ ì œì‘ ê°€ì´ë“œ</h1>
            <p class="mt-4 text-base sm:text-lg text-slate-600">Matter.js ì›¹ ê²Œì„ì„ WebSocketìœ¼ë¡œ Python(SB3/TorchRL)ì— ì—°ê²°í•˜ì—¬ AIë¥¼ í•™ìŠµì‹œí‚¤ëŠ” í˜„ëŒ€ì ì¸ ë°©ë²•</p>
        </header>
        
        <section class="step bg-white p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200 mb-10">
            <h2 class="text-2xl font-bold mb-4 border-b pb-3 text-slate-900">ì „ì²´ í”„ë¡œì„¸ìŠ¤ ê°œìš”</h2>
            <ol class="list-decimal list-inside space-y-3 text-slate-700">
                <li><strong class="font-semibold text-slate-800">ê²Œì„ ì•„ì´ë””ì–´ êµ¬ì²´í™”:</strong> ë§Œë“¤ê³  ì‹¶ì€ ê²Œì„ì˜ ìƒì„¸ ê¸°íšì•ˆ ì‘ì„±</li>
                <li><strong class="font-semibold text-slate-800">í”„ë¡œì íŠ¸ ì„¤ì • ë° í†µí•© ì›¹ ê²Œì„ ì œì‘:</strong> í•™ìŠµê³¼ í”Œë ˆì´ê°€ ëª¨ë‘ ê°€ëŠ¥í•œ ìµœì¢… JS ê²Œì„ ë¡œì§ ê°œë°œ</li>
                <li><strong class="font-semibold text-slate-800">Python WebSocket í™˜ê²½ ì„¤ì •:</strong> JS ê²Œì„ì„ ì œì–´í•˜ëŠ” Gymnasium í˜¸í™˜ RL í™˜ê²½(ê³µí†µ ì½”ë“œ) ì„¤ì •</li>
                <li><strong class="font-semibold text-slate-800">AI ëª¨ë¸ í•™ìŠµ (SB3 / TorchRL):</strong> WebSocket í™˜ê²½ì„ í†µí•´ JS ê²Œì„ì„ ì œì–´í•˜ë©° AI ëª¨ë¸ í•™ìŠµ</li>
                <li><strong class="font-semibold text-slate-800">ONNX ëª¨ë¸ ë³€í™˜:</strong> í•™ìŠµëœ ëª¨ë¸ì„ ì›¹ í™˜ê²½ì— ì§ì ‘ í†µí•©í•˜ê¸° ìœ„í•œ ONNX í˜•ì‹ìœ¼ë¡œ ë³€í™˜</li>
                <li><strong class="font-semibold text-slate-800">ìµœì¢… AI ê²Œì„ í…ŒìŠ¤íŠ¸:</strong> ë¡œì»¬ ì„œë²„ë¡œ ONNX ëª¨ë¸ì´ íƒ‘ì¬ëœ ìµœì¢… ê²Œì„ì„ í™•ì¸</li>
                <li><strong class="font-semibold text-slate-800">GitHub Pages ë°°í¬:</strong> ì™„ì„±ëœ AI ì›¹ ê²Œì„ì„ ì „ ì„¸ê³„ì— ë¬´ë£Œë¡œ ë°°í¬</li>
            </ol>
        </section>

        <section id="step1" class="step bg-white p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200 mb-10">
            <h2 class="text-2xl font-bold mb-4 border-b pb-3 text-slate-900">ë‹¨ê³„ 1: ê²Œì„ ì•„ì´ë””ì–´ êµ¬ì²´í™”í•˜ê¸°</h2>
            <p class="mb-4 text-slate-700">'ì¶”ì²œ ì£¼ì œ ë³´ê¸°' ë²„íŠ¼ì„ ëˆŒëŸ¬ ì˜ê°ì„ ì–»ê³ , ë§ˆìŒì— ë“œëŠ” ì£¼ì œë¥¼ ì„ íƒí•˜ì—¬ ìƒì„¸ ê¸°íšì•ˆì„ ìš”ì²­í•˜ëŠ” í”„ë¡¬í”„íŠ¸ë¥¼ ë³µì‚¬í•˜ì„¸ìš”.</p>
            <p class="mb-4 text-slate-700">ë‹¤ìŒì˜ AIë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤: VSCode Copliot(Gemini 2.5 Pro, Claude, GPT 5 mini), Gemini Cli, Gemini 2.5 pro, ChatGPT 5,  <a href="https://chat.qwen.ai/" target="_blank" class="text-amber-600 underline">Qwen 3 Coder</a></p>
            <button id="open-modal-btn" class="mb-6 bg-amber-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-amber-600 transition-colors">ğŸ® ì¶”ì²œ ì£¼ì œ ë³´ê¸° & ì˜ê° ì–»ê¸°</button>
            <div class="prompt-block">
                <button class="copy-button">ë³µì‚¬</button>
                <pre class="bg-slate-100 text-slate-800 p-4 rounded-lg overflow-x-auto text-sm"><code id="step1-prompt-code" class="language-text">You are a creative game designer. Based on the theme "[ì—¬ê¸°ì— ì„ íƒí•œ ê²Œì„ ì£¼ì œì™€ ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”. ì˜ˆ: ë¡œì¼“ ì°©ë¥™ì‹œí‚¤ê¸°: ì¢Œìš° ë° ë©”ì¸ ì¶”ë ¥ì„ ì‚¬ìš©í•´, í™”ë©´ ìƒë‹¨ì—ì„œ ë–¨ì–´ì§€ëŠ” ë¡œì¼“ì´ ì •í•´ì§„ ì°©ë¥™ ì§€ì ì— ë¶€ë“œëŸ½ê²Œ ì°©ë¥™í•˜ëŠ” ê²Œì„]", please develop a detailed and engaging game plan.

The plan must be structured with the following four sections:

1.  **Game Concept:** A brief, exciting one-paragraph summary of the game.
2.  **Player Objective:** A clear description of what the player needs to accomplish.
3.  **Controls:** A simple and intuitive control scheme.
4.  **Win/Loss Conditions:** Specific, measurable conditions for success and failure.

Write the plan in Korean.</code></pre>
            </div>
        </section>

        <section id="step2" class="step bg-white p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200 mb-10">
            <h2 class="text-2xl font-bold mb-4 border-b pb-3 text-slate-900">ë‹¨ê³„ 2: í†µí•© AI ì›¹ ê²Œì„ ì œì‘</h2>
            <p class="mb-6 text-slate-700">ì´ì œ ì‹¤ì œ ê²Œì„ ê°œë°œì„ ì‹œì‘í•©ë‹ˆë‹¤. ì•„ë˜ ì•ˆë‚´ì— ë”°ë¼ í”„ë¡œì íŠ¸ë¥¼ ì¤€ë¹„í•˜ê³ , ìƒì„±ëœ ì½”ë“œë¥¼ ë¶™ì—¬ë„£ì„ íŒŒì¼ì„ ë§Œë“œì„¸ìš”.</p>

            <div class="user-input mb-6">
                <h3 class="font-semibold text-lg text-slate-800 mb-2">í”„ë¡œì íŠ¸ í´ë” ë° íŒŒì¼ ìƒì„± (VS Code)</h3>
                <ol class="list-decimal list-inside space-y-2 text-sm text-slate-700">
                    <li>ì»´í“¨í„°ì— <strong>`ai-game`</strong>ê³¼ ê°™ì€ ì´ë¦„ìœ¼ë¡œ ìƒˆ í´ë”ë¥¼ ë§Œë“­ë‹ˆë‹¤.</li>
                    <li>Visual Studio Codeë¥¼ ì—´ê³ , `íŒŒì¼ > í´ë” ì—´ê¸°`ë¥¼ í†µí•´ ë°©ê¸ˆ ë§Œë“  í´ë”ë¥¼ ì—½ë‹ˆë‹¤.</li>
                    <li>VS Codeì˜ íƒìƒ‰ê¸° íŒ¨ë„ì—ì„œ <strong>`index.html`</strong>ì´ë¼ëŠ” ì´ë¦„ì˜ ë¹ˆ íŒŒì¼ì„ í•˜ë‚˜ ìƒì„±í•©ë‹ˆë‹¤.</li>
                    <li>ì•„ë˜ í”„ë¡¬í”„íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ AIë¡œë¶€í„° ì „ì²´ ì½”ë“œë¥¼ ìƒì„±ë°›ì€ ë’¤, ìƒì„±ëœ ì½”ë“œë¥¼ ì´ `index.html` íŒŒì¼ì— ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ìœ¼ë©´ ì™„ì„±ë©ë‹ˆë‹¤.</li>
                </ol>
            </div>
            
            <div class="user-input">
                <h3 class="font-semibold text-lg text-slate-800 mb-2">ê²Œì„ ê¸°íšì•ˆ ì…ë ¥</h3>
                <p class="text-sm text-slate-600 mb-2">1ë‹¨ê³„ì—ì„œ ìƒì„±ëœ ê¸°íšì•ˆì„ ì•„ë˜ ì…ë ¥ë€ì— ë¶™ì—¬ë„£ìœ¼ë©´, AI ì›¹ ê²Œì„ ìƒì„±ì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ê°€ ìë™ìœ¼ë¡œ ì™„ì„±ë©ë‹ˆë‹¤.</p>
                <textarea id="game-logic-textarea" rows="8" class="w-full p-2 border border-amber-300 rounded-md bg-white text-sm" placeholder="ì´ê³³ì— 1ë‹¨ê³„ì—ì„œ ìƒì„±ëœ ê²Œì„ ê¸°íšì•ˆ(ì½˜ì…‰íŠ¸, ëª©í‘œ, ì¡°ì‘ë²•, ì„±ê³µ/ì‹¤íŒ¨ ì¡°ê±´)ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”."></textarea>
            </div>

            <div class="prompt-block mt-6">
                <button class="copy-button">ë³µì‚¬</button>
                <pre class="bg-slate-100 text-slate-800 p-4 rounded-lg overflow-x-auto text-sm"><code id="step2-prompt-code" class="language-text">You are an elite front-end developer and a top-tier visual designer, a master of creating high-quality, physics-based web games.

You are a world-renowned game designer, a hybrid of an elite front-end developer and an award-winning art director specializing in the minimalist hyper-casual genre. You are celebrated for creating games with an incredibly natural and intuitive 'game feel,' whether they use complex physics or clever animation.
Your task is to write the complete code for a single, self-contained index.html file. This file must integrate the HTML structure, all necessary CSS within &lt;style&gt; tags, and the complete game logic in JavaScript within &lt;script&gt; tags. No external CSS or JS files should be required, except for CDN libraries like Matter.js and ONNX Runtime.

Game Logic Plan:

[ì—¬ê¸°ì— 1ë‹¨ê³„ì—ì„œ ìƒì„±ëœ ê²Œì„ ê¸°íšì•ˆì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.]

JavaScript Implementation Details (CRITICAL):

The entire game logic must be contained within the &lt;script&gt; tag. It must be structured to handle three modes (USER, AI, TRAINING) and expose a clear interface for the AI training environment. Specifically, you must implement the following core functions:
setupGame(): This function initializes the game's environment and all necessary objects. If the game concept requires physics, this is where you would set up the Matter.js engine, world, and bodies. Otherwise, it prepares the initial state of all game elements for a non-physics-based implementation.
resetGame(): This function resets the game to its initial state for a new episode. It must reposition all dynamic elements, reset scores, and clear any game-over states. It must return the initial observation array for the AI.
getObservation(): This function gathers the current state of the game (e.g., player position, velocity, target location) into a fixed-size array of numbers. This array is the AI's "eyes." The values should be normalized if possible, and the order of elements must always be consistent.

applyAction(action): This function takes a single integer action from the user or AI and translates it into a game mechanic (e.g., 0 for 'do nothing', 1 for 'move left', 2 for 'move right').

DUAL MODE LOGIC: You must implement the logic to seamlessly switch between:
USER Mode: Reads input from keyboard/mouse and calls applyAction.
AI (ONNX) Mode: In the game loop, calls getObservation(), feeds it to the loaded ONNX model, gets an action, and calls applyAction with it.
TRAINING (WebSocket) Mode: Listens for commands from the WebSocket server (reset or action) and calls the corresponding functions, sending back the observation data.

Visual & Quality Requirements (CRITICAL):

Exceptionally Refined Aesthetics: The design must be on par with award-winning minimalist hyper-casual games. It should feel premium, trendy, and polished. Think of the clean visual identity of top-tier mobile game publishers.
Sophisticated Color Palette: Do not use simple, default colors. Instead, utilize a sophisticated and harmonious color palette.
Base: Start with a soft, off-white or light pastel background.
Palette: Choose a limited set of 2-3 primary colors that work well together (e.g., coral, teal, and navy). Use these for key game elements.
Accents: Use a single, bright accent color for important feedback or highlights.
Technique: Employ flat design. Subtle, soft gradients are highly encouraged for backgrounds or major objects to add depth, but avoid harsh or busy textures.

Modern Typography & UI:

Font: Use a clean, modern, and highly readable sans-serif web font (e.g., Google Fonts' 'Poppins', 'Montserrat', or 'Nunito').
Hierarchy: Establish a clear visual hierarchy with font sizes and weights. The score should be prominent but elegant.
Elements: UI elements like buttons and the AI toggle must be minimalist, geometric, and perfectly aligned. They should feel seamlessly integrated into the game's world, not like generic HTML elements placed on top.

Layout & Composition:

Negative Space: Embrace generous use of negative space. The layout must be uncluttered, focusing the player's attention only on essential information and gameplay.
Balance: Every element on the screen should feel intentionally placed, creating a balanced and visually pleasing composition.
'Juicy' & Polished Interactions: The game must feel incredibly satisfying to play. If physics are used (with Matter.js), they must be engaging and well-tuned. Regardless of the engine, all interactions must be 'juicy'â€”include smooth animations, responsive visual feedback (like scaling, color changes, or particle effects), and satisfying sounds (even if just placeholders) to make every player action feel impactful and rewarding.
The final output must be a single, complete, and robust index.html file, ready to be run directly in a browser.</code></pre>
            </div>
        </section>

        <section id="step3" class="step bg-white p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200 mb-10">
            <h2 class="text-2xl font-bold mb-4 border-b pb-3 text-slate-900">ë‹¨ê³„ 3: Python WebSocket ê°•í™”í•™ìŠµ í™˜ê²½ ì„¤ì •</h2>
            <p class="mb-6 text-slate-700">1. í”„ë¡œì íŠ¸ í´ë”ì— `websocket_env.py` íŒŒì¼ì„ ìƒì„±í•˜ê³  ì•„ë˜ ì½”ë“œë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”. ì´ ì½”ë“œëŠ” JS ê²Œì„ì„ Gymnasium í˜¸í™˜ í™˜ê²½ìœ¼ë¡œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.</p>
            <div class="user-input mb-6">
                <h3 class="font-semibold text-lg text-slate-800 mb-2">2. í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜</h3>
                <p class="text-sm text-slate-600 mb-4">í„°ë¯¸ë„ì„ ì—´ê³  ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ Gymnasium ë“± í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”.</p>
                <div class="prompt-block">
                <button class="copy-button">ë³µì‚¬</button>
                <pre class="bg-slate-100 text-slate-800 p-4 rounded-lg overflow-x-auto text-sm"><code class="language-bash">pip install gymnasium numpy websockets</code></pre>
            </div>
            </div>
            <div class="prompt-block">
                <button class="copy-button">ë³µì‚¬</button>
                <pre class="bg-slate-100 text-slate-800 p-4 rounded-lg overflow-x-auto text-sm"><code class="language-python">import gymnasium as gym
from gymnasium import spaces
import numpy as np
import asyncio
import websockets
import json
import logging

# ê¸°ë³¸ ë¡œê¹… ì„¤ì •
logging.basicConfig(level=logging.INFO)

class WebSocketEnv(gym.Env):
    def __init__(self, observation_shape, action_n):
        super(WebSocketEnv, self).__init__()
        self.websocket = None
        self.loop = asyncio.get_event_loop()
        self.action_space = spaces.Discrete(action_n)
        # --- ì—°ì† í–‰ë™ ê³µê°„(Continuous Action Space) ì‚¬ìš© ì‹œ ---
        # ìœ„ ì¤„ì„ ì£¼ì„ ì²˜ë¦¬í•˜ê³  ì•„ë˜ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
        # ì—¬ê¸°ì„œ shapeì˜ ì²« ë²ˆì§¸ ê°’ì€ ì—°ì†ì ì¸ í–‰ë™ì˜ ê°œìˆ˜(ì°¨ì›)ì…ë‹ˆë‹¤.
        # ì˜ˆë¥¼ ë“¤ì–´, ì¢Œ/ìš° ì¶”ë ¥ê³¼ ë©”ì¸ ì¶”ë ¥ 2ê°œë¥¼ ê°ê° -1ê³¼ 1 ì‚¬ì´ì˜ ê°’ìœ¼ë¡œ ì œì–´í•œë‹¤ë©´ shape=(2,)ê°€ ë©ë‹ˆë‹¤.
        # self.action_space = spaces.Box(low=-1, high=1, shape=(2,), dtype=np.float32)

        self.observation_space = spaces.Box(low=-np.inf, high=np.inf, shape=observation_shape, dtype=np.float32)

        print("ìë°”ìŠ¤í¬ë¦½íŠ¸ í´ë¼ì´ì–¸íŠ¸ì˜ ì—°ê²°ì„ ê¸°ë‹¤ë¦½ë‹ˆë‹¤...")
        self.server = self.loop.run_until_complete(websockets.serve(self._handler, "localhost", 8765))
        self.loop.run_until_complete(self._wait_for_connection())
        print("í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!")

    async def _handler(self, websocket, path):
        self.websocket = websocket
        await self._keep_alive()

    async def _keep_alive(self):
        try:
            while self.websocket.open:
                await asyncio.sleep(1)
        except websockets.exceptions.ConnectionClosed:
            pass

    async def _wait_for_connection(self):
        while self.websocket is None:
            await asyncio.sleep(0.1)

    async def _send_command(self, command):
        await self.websocket.send(json.dumps(command))

    async def _receive_observation(self):
        message = await self.websocket.recv()
        data = json.loads(message)
        if data.get("type") == "observation":
            obs = np.array(data["observation"], dtype=np.float32)
            reward = data["reward"]
            done = data["done"]
            return obs, reward, done
        return None, None, None

    def reset(self, seed=None, options=None):
        super().reset(seed=seed)
        command = {"command": "reset"}
        self.loop.run_until_complete(self._send_command(command))
        obs, _, _ = self.loop.run_until_complete(self._receive_observation())
        return obs, {}

    def step(self, action):
        command = {"command": "action", "action": int(action)}
        self.loop.run_until_complete(self._send_command(command))
        obs, reward, done = self.loop.run_until_complete(self._receive_observation())
        return obs, reward, done, False, {}

    def render(self, mode='human'):
        pass

    def close(self):
        if self.server:
            self.server.close()
            self.loop.run_until_complete(self.server.wait_closed())
        print("ì›¹ì†Œì¼“ ì„œë²„ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
</code></pre>
            </div>
        </section>

        <section id="step4" class="step bg-white p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200 mb-10">
            <h2 class="text-2xl font-bold mb-4 border-b pb-3 text-slate-900">ë‹¨ê³„ 4: AI ëª¨ë¸ í•™ìŠµ (SB3 / TorchRL)</h2>
            <div class="user-input mb-6">
                <h3 class="font-semibold text-lg text-slate-800 mb-2">1. í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜</h3>
                <p class="text-sm text-slate-600 mb-4">í•™ìŠµì„ ì§„í–‰í•  í”„ë ˆì„ì›Œí¬ì— ë§ì¶° ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í„°ë¯¸ë„ì— ì‹¤í–‰í•˜ì„¸ìš”.</p>
                
                <div class="mb-4">
                    <h4 class="font-semibold text-md text-slate-700">Stable-Baselines3 ì‚¬ìš©ì:</h4>
                    <div class="prompt-block mt-2">
                    <button class="copy-button">ë³µì‚¬</button>
                    <pre class="bg-slate-100 text-slate-800 p-4 rounded-lg overflow-x-auto text-sm"><code class="language-bash">pip install stable-baselines3 torch tensorboard</code></pre>
                </div>
                </div>

                <div>
                    <h4 class="font-semibold text-md text-slate-700">TorchRL ì‚¬ìš©ì:</h4>
                    <div class="prompt-block mt-2">
                    <button class="copy-button">ë³µì‚¬</button>
                    <pre class="bg-slate-100 text-slate-800 p-4 rounded-lg overflow-x-auto text-sm"><code class="language-bash">pip install torch torchrl tensorboard</code></pre>
                </div>
                </div>
            </div>
            <p class="mb-4 text-slate-700">ì„ í˜¸í•˜ëŠ” ê°•í™”í•™ìŠµ í”„ë ˆì„ì›Œí¬ë¥¼ ì„ íƒí•˜ì—¬ AI ì—ì´ì „íŠ¸ë¥¼ í•™ìŠµì‹œí‚µë‹ˆë‹¤. í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ **ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ ì—´ë¦½ë‹ˆë‹¤.**</p>
            <div class="border-b border-slate-200"><nav class="flex -mb-px" aria-label="Tabs"><button class="tab-button active" data-tab="sb3">Stable-Baselines3</button><button class="tab-button" data-tab="torchrl">TorchRL</button></nav></div>
            <div id="tab-sb3" class="tab-content active mt-6">
                <p class="mb-4 text-slate-700">ì•„ë˜ ì½”ë“œë¥¼ ë³µì‚¬í•˜ì—¬ `train_sb3.py` íŒŒì¼ë¡œ ì €ì¥í•˜ê³  ì‹¤í–‰í•˜ì„¸ìš”.</p>
                <div class="prompt-block">
                    <button class="copy-button">ë³µì‚¬</button>
                    <pre class="bg-slate-100 text-slate-800 p-4 rounded-lg overflow-x-auto text-sm"><code class="language-python"># train_sb3.py
import os, time, webbrowser
from stable_baselines3 import PPO
from stable_baselines3.common.callbacks import CheckpointCallback
from stable_baselines3.common.logger import configure
from websocket_env import WebSocketEnv

# --- ì„¤ì • ---
# ì¤‘ìš”: ì´ ê°’ì„ JS ê²Œì„ì˜ ê´€ì¸¡(observation)ì— ë§ì¶°ì•¼ í•©ë‹ˆë‹¤.
OBSERVATION_SHAPE = (8,) 
# ì˜ˆì‹œ:
# 1. ë²¡í„° ê´€ì¸¡ (Vector Observation, MlpPolicy ì‚¬ìš©):
#    - í”Œë ˆì´ì–´ x, y ì¢Œí‘œ, ì†ë„ vx, vy, ëª©í‘œë¬¼ x, y ì¢Œí‘œ ë“± 6ê°œ ìˆ«ì -> (6,)
#    - í˜„ì¬ ì½”ë“œì²˜ëŸ¼ 8ê°œì˜ ìˆ«ì ë°°ì—´ -> (8,)
# 2. ì´ë¯¸ì§€ ê´€ì¸¡ (Image Observation, CnnPolicy ì‚¬ìš©):
#    - í‘ë°± ì´ë¯¸ì§€ (ì±„ë„ 1ê°œ), 84x84 í”½ì…€ -> (1, 84, 84)
#    - ì»¬ëŸ¬ ì´ë¯¸ì§€ (ì±„ë„ 3ê°œ, RGB), 84x84 í”½ì…€ -> (3, 84, 84)
#    - (ì£¼ì˜: SB3ëŠ” (ì±„ë„, ë†’ì´, ë„ˆë¹„) ìˆœì„œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤)

# ì¤‘ìš”: ì´ ê°’ì„ JS ê²Œì„ì˜ í–‰ë™(action) ê°œìˆ˜ì— ë§ì¶°ì•¼ í•©ë‹ˆë‹¤.
# --- ì—°ì† í–‰ë™ ê³µê°„(Continuous Action Space) ì‚¬ìš© ì‹œ ---
# 1. ìœ„ì˜ ACTION_Nì€ í–‰ë™ì˜ ì°¨ì› ìˆ˜ë¥¼ ì˜ë¯¸í•˜ê²Œ ë©ë‹ˆë‹¤. (ì˜ˆ: 2ì°¨ì›ì´ë©´ 2ë¡œ ì„¤ì •)
# 2. websocket_env.py íŒŒì¼ì—ì„œ self.action_spaceë¥¼ spaces.Discreteê°€ ì•„ë‹Œ spaces.Boxë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.
# 3. JS ê²Œì„ì˜ applyAction(action) í•¨ìˆ˜ëŠ” ì´ì œ ì •ìˆ˜(0, 1, 2...)ê°€ ì•„ë‹Œ [-0.5, 0.8] ê³¼ ê°™ì€ ìˆ«ì ë°°ì—´ì„ ë°›ê²Œ ë©ë‹ˆë‹¤.
#    ë”°ë¼ì„œ JS ì½”ë“œì—ì„œ ì´ ë°°ì—´ ê°’ì„ ì‹¤ì œ ê²Œì„ ì¡°ì‘(ì˜ˆ: í˜ì˜ í¬ê¸°, ê°ë„)ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë¡œì§ì„ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤.
ACTION_N = 4             

LOG_DIR = "training_logs"
TENSORBOARD_LOG_NAME = f"PPO_{int(time.time())}"
TOTAL_TIMESTEPS = 1_000_000
CHECKPOINT_FREQ = 10_000
# ---------------------

def find_latest_run_and_checkpoint():
    if not os.path.isdir(LOG_DIR):
        return None, None
    runs = sorted([d for d in os.listdir(LOG_DIR) if os.path.isdir(os.path.join(LOG_DIR, d))], reverse=True)
    for run in runs:
        run_path = os.path.join(LOG_DIR, run)
        checkpoints_path = os.path.join(run_path, "checkpoints")
        if not os.path.isdir(checkpoints_path):
            continue
        checkpoints = [f for f in os.listdir(checkpoints_path) if f.startswith("rl_model_") and f.endswith(".zip")]
        if checkpoints:
            latest_checkpoint = max(checkpoints, key=lambda f: int(f.split("_")[2].replace(".zip", "")))
            return run, os.path.join(checkpoints_path, latest_checkpoint)
    return None, None

def main():
    latest_run, latest_checkpoint = find_latest_run_and_checkpoint()

    if latest_run:
        run_path = os.path.join(LOG_DIR, latest_run)
        print(f"ê¸°ì¡´ í•™ìŠµì„ ì°¾ì•˜ìŠµë‹ˆë‹¤: {latest_run}")
    else:
        run_path = os.path.join(LOG_DIR, TENSORBOARD_LOG_NAME)
        print(f"ê¸°ì¡´ í•™ìŠµì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ í•™ìŠµì„ ì‹œì‘í•©ë‹ˆë‹¤: {TENSORBOARD_LOG_NAME}")
    
    checkpoint_path = os.path.join(run_path, "checkpoints")
    os.makedirs(checkpoint_path, exist_ok=True)
    
    print(f"ë¡œê·¸ ê²½ë¡œ: {run_path}")

    webbrowser.open(f'file://{os.path.realpath("index.html")}')

    env = WebSocketEnv(observation_shape=OBSERVATION_SHAPE, action_n=ACTION_N)
    
    custom_logger = configure(run_path, ["stdout", "tensorboard"])
    checkpoint_callback = CheckpointCallback(save_freq=CHECKPOINT_FREQ, save_path=checkpoint_path, name_prefix="rl_model")

    if latest_checkpoint:
        print(f"ì²´í¬í¬ì¸íŠ¸ì—ì„œ í•™ìŠµì„ ì¬ê°œí•©ë‹ˆë‹¤: {latest_checkpoint}")
        model = PPO.load(latest_checkpoint, env=env)
        model.set_logger(custom_logger)
    else:
        print("ìƒˆë¡œìš´ í•™ìŠµ ì„¸ì…˜ì„ ì‹œì‘í•©ë‹ˆë‹¤.")
        # ê´€ì¸¡ í˜•íƒœì— ë”°ë¼ ìë™ìœ¼ë¡œ ì •ì±…ì„ ì„ íƒí•©ë‹ˆë‹¤.
        policy = "MlpPolicy" if len(OBSERVATION_SHAPE) == 1 else "CnnPolicy"
        model = PPO(policy, env, verbose=1)
        model.set_logger(custom_logger)

    try:
        model.learn(total_timesteps=TOTAL_TIMESTEPS, callback=checkpoint_callback, reset_num_timesteps=False)
        model.save(os.path.join(run_path, "final_model.zip"))
        print(f"í•™ìŠµ ì™„ë£Œ. ëª¨ë¸ì´ {os.path.join(run_path, 'final_model.zip')}ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")
    finally:
        env.close()

if __name__ == '__main__':
    main()
</code></pre>
                </div>
            </div>
            <div id="tab-torchrl" class="tab-content mt-6">
                <p class="mb-4 text-slate-700">ì•„ë˜ ì½”ë“œë¥¼ ë³µì‚¬í•˜ì—¬ `train_torchrl.py` íŒŒì¼ë¡œ ì €ì¥í•˜ê³  ì‹¤í–‰í•˜ì„¸ìš”.</p>
                 <div class="prompt-block">
                    <button class="copy-button">ë³µì‚¬</button>
                    <pre class="bg-slate-100 text-slate-800 p-4 rounded-lg overflow-x-auto text-sm"><code class="language-python">import torch
import webbrowser
import os
import time
from torchrl.envs.libs.gym import GymWrapper
from torchrl.collectors import SyncDataCollector
from torchrl.data import TensorDictReplayBuffer, LazyMemmapStorage
from torchrl.modules import ProbabilisticActor, TanhNormal, ValueOperator, MLP
from torchrl.objectives import ClipPPOLoss
from torchrl.objectives.value import GAE
from torchrl.record import TensorBoardLogger
from websocket_env import WebSocketEnv

# --- ì„¤ì • ---
# ì¤‘ìš”: ì´ ê°’ì„ JS ê²Œì„ì˜ ê´€ì¸¡(observation)ì— ë§ì¶°ì•¼ í•©ë‹ˆë‹¤.
OBSERVATION_SHAPE = (8,) 
# ì˜ˆì‹œ:
# 1. ë²¡í„° ê´€ì¸¡ (Vector Observation, MlpPolicy ì‚¬ìš©):
#    - í”Œë ˆì´ì–´ x, y ì¢Œí‘œ, ì†ë„ vx, vy, ëª©í‘œë¬¼ x, y ì¢Œí‘œ ë“± 6ê°œ ìˆ«ì -> (6,)
#    - í˜„ì¬ ì½”ë“œì²˜ëŸ¼ 8ê°œì˜ ìˆ«ì ë°°ì—´ -> (8,)
# 2. ì´ë¯¸ì§€ ê´€ì¸¡ (Image Observation, CnnPolicy ì‚¬ìš©):
#    - í‘ë°± ì´ë¯¸ì§€ (ì±„ë„ 1ê°œ), 84x84 í”½ì…€ -> (1, 84, 84)
#    - ì»¬ëŸ¬ ì´ë¯¸ì§€ (ì±„ë„ 3ê°œ, RGB), 84x84 í”½ì…€ -> (3, 84, 84)
#    - (ì£¼ì˜: PyTorchëŠ” (ì±„ë„, ë†’ì´, ë„ˆë¹„) ìˆœì„œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤)

# ì¤‘ìš”: ì´ ê°’ì„ JS ê²Œì„ì˜ í–‰ë™(action) ê°œìˆ˜ì— ë§ì¶°ì•¼ í•©ë‹ˆë‹¤.
# --- ì—°ì† í–‰ë™ ê³µê°„(Continuous Action Space) ì‚¬ìš© ì‹œ ---
# 1. ìœ„ì˜ ACTION_Nì€ í–‰ë™ì˜ ì°¨ì› ìˆ˜ë¥¼ ì˜ë¯¸í•˜ê²Œ ë©ë‹ˆë‹¤. (ì˜ˆ: 2ì°¨ì›ì´ë©´ 2ë¡œ ì„¤ì •)
# 2. websocket_env.py íŒŒì¼ì—ì„œ self.action_spaceë¥¼ spaces.Discreteê°€ ì•„ë‹Œ spaces.Boxë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.
# 3. JS ê²Œì„ì˜ applyAction(action) í•¨ìˆ˜ëŠ” ì´ì œ ì •ìˆ˜(0, 1, 2...)ê°€ ì•„ë‹Œ [-0.5, 0.8] ê³¼ ê°™ì€ ìˆ«ì ë°°ì—´ì„ ë°›ê²Œ ë©ë‹ˆë‹¤.
#    ë”°ë¼ì„œ JS ì½”ë“œì—ì„œ ì´ ë°°ì—´ ê°’ì„ ì‹¤ì œ ê²Œì„ ì¡°ì‘(ì˜ˆ: í˜ì˜ í¬ê¸°, ê°ë„)ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë¡œì§ì„ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤.
ACTION_N = 4
DEVICE = "cuda" if torch.cuda.is_available() else "cpu"

FRAMES_PER_BATCH = 1024
TOTAL_FRAMES = 1_000_000
PPO_EPOCHS = 10
MINI_BATCH_SIZE = 64
# ---------------------

def main():
    webbrowser.open(f'file://{os.path.realpath("index.html")}')
    env = GymWrapper(WebSocketEnv(observation_shape=OBSERVATION_SHAPE, action_n=ACTION_N), device=DEVICE)

    # ì•¡í„°ì™€ í¬ë¦¬í‹± ë„¤íŠ¸ì›Œí¬ ì •ì˜
    actor_net = MLP(in_features=OBSERVATION_SHAPE[0], out_features=2 * ACTION_N, num_cells=[64, 64], activation_class=torch.nn.Tanh)
    policy_module = ProbabilisticActor(module=actor_net, in_keys=["observation"], out_keys=["loc", "scale"], distribution_class=TanhNormal)
    value_net = MLP(in_features=OBSERVATION_SHAPE[0], out_features=1, num_cells=[64, 64], activation_class=torch.nn.Tanh)
    value_module = ValueOperator(module=value_net, in_keys=["observation"])

    # ë°ì´í„° ìˆ˜ì§‘ê¸° ì„¤ì •
    collector = SyncDataCollector(
        env,
        policy_module,
        frames_per_batch=FRAMES_PER_BATCH,
        total_frames=TOTAL_FRAMES,
        device=DEVICE,
    )

    # ë¦¬í”Œë ˆì´ ë²„í¼, ì–´ë“œë°´í‹°ì§€ ë° ì†ì‹¤ í•¨ìˆ˜ ì„¤ì •
    replay_buffer = TensorDictReplayBuffer(storage=LazyMemmapStorage(FRAMES_PER_BATCH))
    advantage_module = GAE(gamma=0.99, lmbda=0.95, value_network=value_module, average_gae=True)
    loss_module = ClipPPOLoss(actor=policy_module, critic=value_module, clip_epsilon=0.2, entropy_coef=0.01)
    optimizer = torch.optim.Adam(loss_module.parameters(), lr=3e-4)
    
    # ë¡œê±° ì„¤ì •
    logger = TensorBoardLogger(log_dir="training_logs", exp_name=f"TorchRL_PPO_{int(time.time())}")
    
    total_frames_collected = 0
    print("í•™ìŠµì„ ì‹œì‘í•©ë‹ˆë‹¤...")
    for i, tensordict_data in enumerate(collector):
        total_frames_collected += tensordict_data.numel()
        
        with torch.no_grad():
            advantage_module(tensordict_data)
        
        data_view = tensordict_data.reshape(-1)
        replay_buffer.extend(data_view)
        
        for _ in range(PPO_EPOCHS):
            for subdata in replay_buffer.sample(MINI_BATCH_SIZE):
                loss_vals = loss_module(subdata)
                loss_value = sum(loss for key, loss in loss_vals.items() if key.startswith("loss_"))

                optimizer.zero_grad()
                loss_value.backward()
                optimizer.step()

        if i % 10 == 0: # 10 ë°°ì¹˜ë§ˆë‹¤ ë¡œê·¸ ê¸°ë¡
            print(f"ìŠ¤í… {total_frames_collected}: ì†ì‹¤={loss_value.item()}")
            for key, value in loss_vals.items():
                logger.log_scalar(key.replace("loss_", ""), value.item(), step=total_frames_collected)
        
        if i % 50 == 0: # 50 ë°°ì¹˜ë§ˆë‹¤ ëª¨ë¸ ì €ì¥
            torch.save(policy_module.state_dict(), "model_torchrl.pth")

    print("í•™ìŠµ ì™„ë£Œ.")
    collector.shutdown()
    torch.save(policy_module.state_dict(), "model_torchrl.pth")

if __name__ == "__main__":
    main()
</code></pre>
                </div>
            </div>
             <div class="user-input mt-6">
                <h3 class="font-semibold text-lg text-slate-800 mb-2">ë‹¤ìŒ ë‹¨ê³„: ONNX ë³€í™˜</h3>
                <p class="text-sm text-slate-600">í•™ìŠµì´ ì™„ë£Œë˜ë©´ `final_model.zip`(SB3) ë˜ëŠ” `model_torchrl.pth` íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤. ë‹¤ìŒ ë‹¨ê³„ì—ì„œëŠ” ì´ ëª¨ë¸ì„ ì›¹ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ONNX í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>
            </div>
        </section>
        
        <section id="step5" class="step bg-white p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200 mb-10">
            <h2 class="text-2xl font-bold mb-4 border-b pb-3 text-slate-900">ë‹¨ê³„ 5: ONNX ëª¨ë¸ ë³€í™˜</h2>
            <p class="mb-4 text-slate-700">í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤:</p>
            <pre class="bg-slate-100 text-slate-800 p-2 rounded-md text-sm"><code>pip install stable-baselines3 onnx onnxruntime torch</code></pre>
            <p class="mt-4 mb-4 text-slate-700">ì•„ë˜ ì½”ë“œë¥¼ `convert_onnx.py`ë¡œ ì €ì¥í•˜ê³  ì‹¤í–‰í•˜ì—¬ SB3 ëª¨ë¸ì„ ONNX í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ì„¸ìš”.</p>
            <div class="prompt-block">
                    <button class="copy-button">ë³µì‚¬</button>
                    <pre class="bg-slate-100 text-slate-800 p-4 rounded-lg overflow-x-auto text-sm"><code class="language-python">import torch
import numpy as np
import onnxruntime as ort
from stable_baselines3 import PPO
import os

# --- ì„¤ì • ---
# ì¤‘ìš”: ì´ ê°’ì€ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ì˜ ê°’ê³¼ ì •í™•íˆ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.
OBSERVATION_SHAPE = (8,) 
# ì˜ˆì‹œ:
# 1. ë²¡í„° ê´€ì¸¡ (Vector Observation, MlpPolicy ì‚¬ìš©):
#    - (8,)
# 2. ì´ë¯¸ì§€ ê´€ì¸¡ (Image Observation, CnnPolicy ì‚¬ìš©):
#    - (1, 84, 84)  (í‘ë°±)
#    - (3, 84, 84)  (ì»¬ëŸ¬)

# ë³€í™˜í•  ìµœì‹  ëª¨ë¸ íŒŒì¼ì„ ìë™ìœ¼ë¡œ ì°¾ìŠµë‹ˆë‹¤.
try:
    latest_run = max([d for d in os.listdir("training_logs") if os.path.isdir(os.path.join("training_logs", d))], key=lambda d: os.path.getmtime(os.path.join("training_logs", d)))
    MODEL_PATH = os.path.join("training_logs", latest_run, "final_model.zip")
except (FileNotFoundError, ValueError):
    MODEL_PATH = "final_model.zip" # training_logs í´ë”ê°€ ì—†ì„ ê²½ìš°ì˜ ëŒ€ì²´ ê²½ë¡œ
    
ONNX_PATH = "model.onnx"
# ---------------------

class OnnxablePolicy(torch.nn.Module):
    def __init__(self, policy):
        super().__init__()
        self.policy = policy

    def forward(self, observation):
        # ê²°ì •ë¡ ì (deterministic) í–‰ë™ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤.
        action, _ = self.policy.predict(observation, deterministic=True)
        return torch.from_numpy(action)

if not os.path.exists(MODEL_PATH):
    print(f"ì˜¤ë¥˜: {MODEL_PATH}ì—ì„œ ëª¨ë¸ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    exit()

print(f"{MODEL_PATH}ì—ì„œ ëª¨ë¸ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤...")
model = PPO.load(MODEL_PATH, device='cpu')
onnxable_model = OnnxablePolicy(model.policy)

# ONNX ë³€í™˜ì„ ìœ„í•œ ë”ë¯¸ ì…ë ¥ ìƒì„±
dummy_input = torch.randn(1, *OBSERVATION_SHAPE)

print(f"{ONNX_PATH}ë¡œ ë‚´ë³´ë‚´ëŠ” ì¤‘...")
torch.onnx.export(
    onnxable_model,
    dummy_input,
    ONNX_PATH,
    opset_version=12,
    input_names=["observation"],
    output_names=["action"],
)
print("ë‚´ë³´ë‚´ê¸° ì™„ë£Œ.")

print("\n--- ê²€ì¦ ë‹¨ê³„ ---")
dummy_observation_np = dummy_input.numpy().astype(np.float32)
ort_session = ort.InferenceSession(ONNX_PATH)
input_name = ort_session.get_inputs()[0].name
output_name = ort_session.get_outputs()[0].name

print(f"ë”ë¯¸ ì…ë ¥ìœ¼ë¡œ ì¶”ë¡ ì„ ì‹¤í–‰í•©ë‹ˆë‹¤...")
result = ort_session.run([output_name], {input_name: dummy_observation_np})
print("ì¶”ë¡  ì„±ê³µ!")
print(f"ì¶œë ¥: {result[0]}")
print("\nONNX ëª¨ë¸ ë³€í™˜ ë° ê²€ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
</code></pre>
            </div>
        </section>
        
        <section id="step6" class="step bg-white p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200 mb-10">
            <h2 class="text-2xl font-bold mb-4 border-b pb-3 text-slate-900">ë‹¨ê³„ 6: ìµœì¢… AI ê²Œì„ í…ŒìŠ¤íŠ¸</h2>
            <p class="mb-6 text-slate-700">ì´ì œ ê±°ì˜ ë‹¤ì™”ìŠµë‹ˆë‹¤. `model.onnx` íŒŒì¼ì´ `index.html`ê³¼ ê°™ì€ í´ë”ì— ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ì•„ë˜ ëª…ë ¹ì–´ë¡œ ë¡œì»¬ ì„œë²„ë¥¼ ì‹¤í–‰í•˜ì—¬ ë¸Œë¼ìš°ì €ì—ì„œ ìµœì¢… ê²°ê³¼ë¬¼ì„ í™•ì¸í•˜ì„¸ìš”.</p>
             <div class="space-y-4 text-slate-700">
                <div>
                    <h3 class="font-semibold text-lg text-slate-800">1. ë¡œì»¬ ì„œë²„ ì‹¤í–‰</h3>
                    <p class="mt-1 ml-2">í”„ë¡œì íŠ¸ í´ë”ì—ì„œ í„°ë¯¸ë„ì„ ì—´ê³  ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>
                    <pre class="bg-slate-100 text-slate-800 p-2 mt-1 rounded-md text-sm"><code>python -m http.server</code></pre>
                </div>
                <div>
                    <h3 class="font-semibold text-lg text-slate-800">2. ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸</h3>
                    <p class="mt-1 ml-2">ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ <a href="http://localhost:8000" target="_blank" class="text-amber-600 underline">http://localhost:8000</a> ìœ¼ë¡œ ì ‘ì†í•©ë‹ˆë‹¤. ê²Œì„ì´ ë¡œë“œë˜ë©´, í™œì„±í™”ëœ AI/USER í† ê¸€ì„ 'AI'ë¡œ ë³€ê²½í•˜ì—¬ í•™ìŠµëœ ëª¨ë¸ì˜ í”Œë ˆì´ë¥¼ ê°ìƒí•˜ì„¸ìš”!</p>
                </div>
            </div>
        </section>

        <section id="step7" class="step bg-white p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200 mb-10">
            <h2 class="text-2xl font-bold mb-4 border-b pb-3 text-slate-900">ë‹¨ê³„ 7: VS Codeì™€ Gitìœ¼ë¡œ GitHub Pagesì— ë°°í¬í•˜ê¸°</h2>
            <p class="mb-6 text-slate-700">ìµœì¢… ë‹¨ê³„ì…ë‹ˆë‹¤. ì™„ì„±ëœ í”„ë¡œì íŠ¸ë¥¼ VS Codeì—ì„œ ë°”ë¡œ GitHubì— ì˜¬ë¦¬ê³ , GitHub Pagesë¥¼ í†µí•´ ì „ ì„¸ê³„ì— ë°°í¬í•©ë‹ˆë‹¤.</p>
            
            <div class="space-y-6 text-slate-700">
                <div>
                    <h3 class="font-semibold text-lg text-slate-800">1. ì‚¬ì „ ì¤€ë¹„: Git ì„¤ì¹˜ ë° ì„¤ì •</h3>
                    <p class="mt-1 ml-2">Gitì´ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ <a href="https://git-scm.com/" target="_blank" class="text-amber-600 underline">git-scm.com</a>ì—ì„œ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì„¤ì¹˜í•©ë‹ˆë‹¤. ì„¤ì¹˜ í›„, Git Bashë‚˜ VS Code í„°ë¯¸ë„ì„ ì—´ì–´ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ ì‚¬ìš©ì ì •ë³´ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤ (ìµœì´ˆ í•œ ë²ˆë§Œ í•„ìš”).</p>
                    <pre class="bg-slate-100 text-slate-800 p-2 mt-1 rounded-md text-sm"><code>git config --global user.name "Your Name"
git config --global user.email "you@example.com"</code></pre>
                </div>

                <div>
                    <h3 class="font-semibold text-lg text-slate-800">2. VS Codeì—ì„œ GitHub ê³„ì • ì—°ë™</h3>
                    <p class="mt-1 ml-2">VS Code ì™¼ìª½ í•˜ë‹¨ì˜ ì‚¬ëŒ ëª¨ì–‘ ì•„ì´ì½˜(ê³„ì •)ì„ í´ë¦­í•˜ê³ , 'GitHubìœ¼ë¡œ ë¡œê·¸ì¸(Sign in with GitHub)'ì„ ì„ íƒí•˜ì—¬ ë¸Œë¼ìš°ì €ì˜ ì•ˆë‚´ì— ë”°ë¼ ê³„ì •ì„ ì—°ë™í•©ë‹ˆë‹¤.</p>
                </div>

                <div>
                    <h3 class="font-semibold text-lg text-slate-800">3. Git ì €ì¥ì†Œ ì´ˆê¸°í™” ë° ì²« ì»¤ë°‹</h3>
                    <p class="mt-1 ml-2">VS Code ì™¼ìª½ì˜ 'ì†ŒìŠ¤ ì œì–´' íƒ­(ê°€ì§€ ëª¨ì–‘ ì•„ì´ì½˜)ìœ¼ë¡œ ì´ë™í•˜ì—¬ 'ë¦¬í¬ì§€í† ë¦¬ ì´ˆê¸°í™”(Initialize Repository)' ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤. ê·¸ í›„, ìƒë‹¨ì˜ ë©”ì‹œì§€ ì…ë ¥ë€ì— "Initial commit"ê³¼ ê°™ì€ ì²« ì»¤ë°‹ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•œ í›„ âœ“ ì»¤ë°‹ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì»¤ë°‹í•©ë‹ˆë‹¤.</p>
                </div>

                <div>
                    <h3 class="font-semibold text-lg text-slate-800">4. GitHubì— ê²Œì‹œí•˜ê¸°</h3>
                    <p class="mt-1 ml-2">'ì†ŒìŠ¤ ì œì–´' íƒ­ì— ë‚˜íƒ€ë‚˜ëŠ” 'ê²Œì‹œ(Publish)' ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤. VS Codeê°€ GitHubì— ì €ì¥ì†Œë¥¼ ë§Œë“œëŠ” ê³¼ì •ì„ ì•ˆë‚´í•©ë‹ˆë‹¤. ì €ì¥ì†Œ ì´ë¦„ì„ ì •í•˜ê³ , <strong>ë°˜ë“œì‹œ 'ê³µê°œ(Public)' ì €ì¥ì†Œë¡œ ì„¤ì •</strong>í•´ì•¼ GitHub Pagesë¥¼ ë¬´ë£Œë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>

                <div>
                    <h3 class="font-semibold text-lg text-slate-800">5. GitHub Pages í™œì„±í™”</h3>
                    <p class="mt-1 ml-2">ê²Œì‹œê°€ ì™„ë£Œë˜ë©´ GitHub ì‚¬ì´íŠ¸ì—ì„œ ë°©ê¸ˆ ìƒì„±í•œ ì €ì¥ì†Œë¡œ ì´ë™í•©ë‹ˆë‹¤. 'Settings' &rarr; 'Pages' íƒ­ìœ¼ë¡œ ì´ë™í•˜ì—¬ 'Source'ë¥¼ 'Deploy from a branch'ë¡œ, ë¸Œëœì¹˜ë¥¼ 'main' (ë˜ëŠ” 'master')ìœ¼ë¡œ ì„ íƒí•˜ê³  'Save'ë¥¼ í´ë¦­í•©ë‹ˆë‹¤.</p>
                </div>

                <div>
                    <h3 class="font-semibold text-lg text-slate-800">6. ë°°í¬ í™•ì¸ ë° ê³µìœ </h3>
                    <p class="mt-1 ml-2">ì ì‹œ í›„ í˜ì´ì§€ ìƒë‹¨ì— ë…¹ìƒ‰ìœ¼ë¡œ ê²Œì‹œ ì£¼ì†Œ(<code class="text-sm">https://&lt;ì‚¬ìš©ìëª…&gt;.github.io/&lt;ì €ì¥ì†Œëª…&gt;/</code>)ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. ì´ ì£¼ì†Œë¡œ ì ‘ì†í•˜ì—¬ ê²Œì„ì„ í™•ì¸í•˜ê³  ì „ ì„¸ê³„ì™€ ê³µìœ í•˜ì„¸ìš”!</p>
                </div>
            </div>
        </section>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- ê³µí†µ UI ë¡œì§ (ë³µì‚¬ ë²„íŠ¼, íƒ­ ë²„íŠ¼ ë“±) ---
            const copyButtons = document.querySelectorAll('.copy-button');
            copyButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const codeBlock = button.nextElementSibling.querySelector('code');
                    const codeText = codeBlock.innerText;
                    navigator.clipboard.writeText(codeText).then(() => {
                        button.textContent = 'ë³µì‚¬ ì™„ë£Œ!';
                        button.classList.add('copied');
                        setTimeout(() => {
                            button.textContent = 'ë³µì‚¬';
                            button.classList.remove('copied');
                        }, 2000);
                    }).catch(err => console.error('ë³µì‚¬ ì‹¤íŒ¨', err));
                });
            });

            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    const tabId = button.getAttribute('data-tab');
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === `tab-${tabId}`) {
                            content.classList.add('active');
                        }
                    });
                });
            });

            // --- í…Œë§ˆ ëª¨ë‹¬ ê´€ë ¨ ë¡œì§ ---
            const modal = document.getElementById('theme-modal');
            const openModalBtn = document.getElementById('open-modal-btn');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const themeGrid = document.getElementById('theme-grid');
            const step1PromptCodeElement = document.getElementById('step1-prompt-code');

            // 1. ì™¸ë¶€ JSON íŒŒì¼ì„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
            async function loadThemes() {
                try {
                    const response = await fetch('themes.json'); // themes.json íŒŒì¼ ìš”ì²­
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const themesData = await response.json(); // ì‘ë‹µì„ JSONìœ¼ë¡œ íŒŒì‹±

                    // 2. ê°€ì ¸ì˜¨ ë°ì´í„°ë¡œ ë™ì ìœ¼ë¡œ í…Œë§ˆ ì¹´ë“œ ìƒì„±
                    themeGrid.innerHTML = ''; // ê¸°ì¡´ ì½˜í…ì¸  ì´ˆê¸°í™”
                    themesData.sort((a, b) => a.title.localeCompare(b.title, 'ko')).forEach(theme => {
                        const card = document.createElement('div');
                        card.className = 'modal-card bg-slate-50 p-4 rounded-lg cursor-pointer border hover:border-amber-500 hover:bg-amber-50';
                        card.innerHTML = `
                            <div class="text-3xl mb-2">${theme.emoji}</div>
                            <h3 class="font-bold text-slate-800">${theme.title}</h3>
                            <p class="text-sm text-slate-600 mt-1">${theme.description}</p>
                        `;
                        card.addEventListener('click', () => {
                            const basePrompt = `You are a creative game designer. Based on the theme "[THEME_PLACEHOLDER]", please develop a detailed and engaging game plan.\n\nThe plan must be structured with the following four sections:\n\n1.  **Game Concept:** A brief, exciting one-paragraph summary of the game.\n2.  **Player Objective:** A clear description of what the player needs to accomplish.\n3.  **Controls:** A simple and intuitive control scheme.\n4.  **Win/Loss Conditions:** Specific, measurable conditions for success and failure.\n\nWrite the plan in Korean.`;
                            const promptToCopy = basePrompt.replace('[THEME_PLACEHOLDER]', `"${theme.rl_concept}"`);
                            
                            if (step1PromptCodeElement) {
                                step1PromptCodeElement.textContent = basePrompt.replace(
                                    `[ì—¬ê¸°ì— ì„ íƒí•œ ê²Œì„ ì£¼ì œì™€ ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”. ì˜ˆ: ë¡œì¼“ ì°©ë¥™ì‹œí‚¤ê¸°: ì¢Œìš° ë° ë©”ì¸ ì¶”ë ¥ì„ ì‚¬ìš©í•´, í™”ë©´ ìƒë‹¨ì—ì„œ ë–¨ì–´ì§€ëŠ” ë¡œì¼“ì´ ì •í•´ì§„ ì°©ë¥™ ì§€ì ì— ë¶€ë“œëŸ½ê²Œ ì°©ë¥™í•˜ëŠ” ê²Œì„]`,
                                    `[${theme.rl_concept}]`
                                );
                            }

                            navigator.clipboard.writeText(promptToCopy).then(() => {
                                 alert(`'${theme.title}' ì£¼ì œì˜ ìƒì„¸ í”„ë¡¬í”„íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. Geminiì—ê²Œ ë°”ë¡œ ë¶™ì—¬ë„£ì–´ ì‚¬ìš©í•˜ì„¸ìš”!`);
                            });

                            if (modal) modal.classList.add('hidden');
                        });
                        if (themeGrid) themeGrid.appendChild(card);
                    });

                } catch (error) {
                    console.error("í…Œë§ˆë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:", error);
                    if (themeGrid) themeGrid.innerHTML = '<p class="text-red-500">í…Œë§ˆë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. themes.json íŒŒì¼ì´ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì— ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</p>';
                }
            }

            // 3. ëª¨ë‹¬ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            if (openModalBtn) openModalBtn.addEventListener('click', () => modal.classList.remove('hidden'));
            if (closeModalBtn) closeModalBtn.addEventListener('click', () => modal.classList.add('hidden'));
            if (modal) modal.addEventListener('click', (e) => {
                if (e.target.id === 'theme-modal') {
                    modal.classList.add('hidden');
                }
            });

            // --- í”„ë¡¬í”„íŠ¸ ìë™ ì—…ë°ì´íŠ¸ ë¡œì§ ---
            const gameLogicTextarea = document.getElementById('game-logic-textarea');
            const step2PromptCodeElement = document.getElementById('step2-prompt-code');
            if (gameLogicTextarea && step2PromptCodeElement) {
                const baseStep2Prompt = step2PromptCodeElement.innerText;
                gameLogicTextarea.addEventListener('input', () => {
                    const userInput = gameLogicTextarea.value;
                    if (userInput.trim() !== '') {
                        step2PromptCodeElement.innerText = baseStep2Prompt.replace("[ì—¬ê¸°ì— 1ë‹¨ê³„ì—ì„œ ìƒì„±ëœ ê²Œì„ ê¸°íšì•ˆì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.]", userInput);
                    } else {
                        step2PromptCodeElement.innerText = baseStep2Prompt;
                    }
                });
            }

            // í˜ì´ì§€ ë¡œë“œ ì‹œ í…Œë§ˆ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤í–‰
            loadThemes();
        });
    </script>
</body>
</html>