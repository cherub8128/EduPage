:root {
    --bg-primary: #111827; --bg-secondary: #1F2937; --bg-tertiary: #374151;
    --text-primary: #F9FAFB; --text-secondary: #9CA3AF; --text-muted: #6B7280;
    --border-primary: #4B5563; --border-secondary: #374151;
}
body.light-mode {
    --bg-primary: #F3F4F6; --bg-secondary: #FFFFFF; --bg-tertiary: #E5E7EB;
    --text-primary: #1F2937; --text-secondary: #4B5563; --text-muted: #9CA3AF;
    --border-primary: #D1D5DB; --border-secondary: #E5E7EB;
}
html {
        height: 100%;
}
body {
    -webkit-user-select: none; /* Safari */
    -ms-user-select: none; /* IE 10+ */
    user-select: none; /* Standard syntax */ 
    min-height: 100%;
    font-family: 'Pretendard', sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    display: flex;
    flex-direction: column;
}
main {
    flex-grow: 1;
}
.font-orbitron { font-family: 'Orbitron', sans-serif; }
.bg-main { background-color: var(--bg-secondary); }
.bg-sub { background-color: var(--bg-tertiary); }
.border-main { border-color: var(--border-primary); }
.border-sub { border-color: var(--border-secondary); }
.text-main { color: var(--text-primary); }
.text-sub { color: var(--text-secondary); }
.text-muted { color: var(--text-muted); }

.game-grid {
    display: grid;
    grid-template-columns: repeat(var(--grid-size), 1fr);
    grid-template-rows: repeat(var(--grid-size), 1fr);
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-primary);
}
.grid-cell { 
    aspect-ratio: 1 / 1; 
    border: 1px solid var(--border-secondary);
    position: relative;
    background-color: var(--bg-tertiary);
}
.grid-cell::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 70%;
    height: 1.5px;
    background-color: var(--border-primary);
    transform: translate(-50%, -50%) rotate(45deg);
}
.grid-cell::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 70%;
    height: 1.5px;
    background-color: var(--border-primary);
    transform: translate(-50%, -50%) rotate(-45deg);
}
.grid-cell.passable {
    background-color: var(--bg-tertiary);
}
.grid-cell.passable::before,
.grid-cell.passable::after {
    display: none;
}


#player, .map-item {
    position: absolute; top: 0; left: 0;
    width: var(--cell-size); height: var(--cell-size);
    transition: transform 0.5s ease-in-out; will-change: transform;
    display: flex; align-items: center; justify-content: center;
}
#player {
    background: #3B82F6; border-radius: 50%;
    border: 2px solid #93C5FD; box-shadow: 0 0 15px #3B82F6;
    z-index: 10;
}
#target {
    position: absolute; top: 0; left: 0;
    width: var(--cell-size); height: var(--cell-size);
    transition: transform 0.5s ease-in-out; will-change: transform;
    display: flex; align-items: center; justify-content: center;
    transform: var(--tw-translate, translate(0,0));
}

.slot {
    background-color: var(--bg-tertiary);
    border: 2px dashed var(--border-primary);
    aspect-ratio: 1 / 1; border-radius: 0.5rem;
    display:flex; align-items:center; justify-content:center; position: relative;
}
.slot.over { background-color: #4B5563; border-color: #6B7280; }
body.light-mode .slot.over { background-color: #D1D5DB; border-color: #9CA3AF; }
.item {
    width: 100%; height: 100%; cursor: grab; user-select: none;
    transition: transform 0.2s, box-shadow 0.2s;
    display: flex; align-items: center; justify-content: center;
    flex-direction: column; gap: 1px; padding: 2px;
    border-radius: 0.375rem; position: relative;
    touch-action: none; /* Prevents scrolling when dragging item on mobile */
}
.item.dragging-source {
    opacity: 0.3;
}
.ghost-item {
    position: fixed;
    pointer-events: none;
    z-index: 1000;
    transform: translate(-50%, -50%) scale(1.1);
    opacity: 0.8;
}
.item:active { cursor: grabbing; }
.pouch { animation: pulse-pouch 2.5s infinite; }
@keyframes pulse-pouch {
    0% { box-shadow: 0 0 8px #a78bfa; }
    50% { box-shadow: 0 0 20px #a78bfa; }
    100% { box-shadow: 0 0 8px #a78bfa; }
}
.message-box {
    position: fixed; bottom: -100px; left: 50%;
    transform: translateX(-50%); transition: bottom 0.5s ease-in-out;
    z-index: 100;
}
.message-box.show { bottom: 20px; }
#ending-popup, #gameover-popup, #help-modal, #confirm-reset-popup { transition: opacity 0.5s, visibility 0.5s; }
.gem-silhouette { filter: brightness(0.4) grayscale(1); }
.map-coord { font-size: 0.65rem; color: var(--text-muted); font-family: 'Orbitron', sans-serif; text-align: center; }
.tab-btn {
    background-color: var(--bg-tertiary);
    color: var(--text-secondary);
}
.tab-btn.active {
    background-color: #4f46e5;
    color: white;
}
body.light-mode .tab-btn.active {
    background-color: #6366f1;
}
